{"version":3,"file":"pictures-wall-a2f2e9e2.js","sources":["../../../src/views/module/product/component/pictures-wall.tsx"],"sourcesContent":["import { Modal, Upload, message } from 'antd'\r\nimport type { GetProp, UploadFile, UploadProps } from 'antd'\r\nimport React, { useEffect, useState } from 'react'\r\nconst serverUrl = 'http://localhost:5000/upload/'\r\n\r\nexport default function PicturesWall({ images }: any) {\r\n\tconst [previewVisible, setpreviewVisible] = useState(false) // 图片弹窗\r\n\tconst [previewImage, setpreviewImage] = useState('') // 大图的url\r\n\tconst [fileList, setFileList] = useState([])\r\n\r\n\tuseEffect(() => {\r\n\t\tconst imgs = images\r\n\t\tconsole.log(imgs)\r\n\t\tif (imgs && imgs.length > 0) {\r\n\t\t\tlet fileList = []\r\n\t\t\tfileList = imgs.map((img: any, index: number) => ({\r\n\t\t\t\tuid: -index,\r\n\t\t\t\tname: img,\r\n\t\t\t\tstatus: 'done',\r\n\t\t\t\t// url: serverUrl + img\r\n\t\t\t\turl: img,\r\n\t\t\t}))\r\n\t\t\tsetFileList(fileList)\r\n\t\t}\r\n\t}, [])\r\n\r\n\t/**\r\n\t * 父组件获取此值\r\n\t * @returns\r\n\t */\r\n\tconst getImgs = () => fileList.map((file: any) => file.name)\r\n\r\n\tconst handlePreview = (file: any) => {\r\n\t\tsetpreviewImage(file.url || file.thumbUrl)\r\n\t\tsetpreviewVisible(true)\r\n\t}\r\n\r\n\tconst handleChange: UploadProps['onChange'] = ({ file, fileList }: any) => {\r\n\t\tconsole.log('上传事件：', file, file.status, fileList.length, file === fileList[fileList.length - 1])\r\n\t\tsetFileList(fileList)\r\n\r\n\t\t// 一旦上传成功, 将当前上传的file的信息修正(name, url)\r\n\t\t// if (file.status === \"done\") {\r\n\t\t//   const result = file.response; // {status: 0, data: {name: 'xxx.jpg', url: '图片地址'}}\r\n\t\t//   if (result.status === 0) {\r\n\t\t//     message.success(\"上传图片成功!\");\r\n\t\t//     const { name, url } = result.data;\r\n\t\t//     file = fileList[fileList.length - 1];\r\n\t\t//     file.name = name;\r\n\t\t//     file.url = url;\r\n\t\t//   } else {\r\n\t\t//     message.error(\"上传图片失败\");\r\n\t\t//   }\r\n\t\t// } else if (file.status === \"removed\") {\r\n\t\t// 删除图片\r\n\t\t//   const result = await reqDeleteImg(file.name);\r\n\t\t//   if (result.status === 0) {\r\n\t\t//     message.success(\"删除图片成功!\");\r\n\t\t//   } else {\r\n\t\t//     message.error(\"删除图片失败!\");\r\n\t\t//   }\r\n\t\t// }\r\n\t\t// 在操作(上传/删除)过程中更新fileList状态\r\n\t\t//setFileList(fileList);\r\n\t}\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Upload\r\n\t\t\t\taction=\"https://run.mocky.io/v3/435e224c-44fb-4773-9faf-380c5e6a2188\" /*上传图片的接口地址*/\r\n\t\t\t\taccept=\"image/*\" /*只接收图片格式*/\r\n\t\t\t\tname=\"image\" /*请求参数名*/\r\n\t\t\t\tlistType=\"picture-card\" /*卡片样式*/\r\n\t\t\t\tfileList={fileList} /*所有已上传图片文件对象的数组*/\r\n\t\t\t\tonPreview={handlePreview}\r\n\t\t\t\tonChange={handleChange}>\r\n\t\t\t\t{fileList.length >= 4 ? null : (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div>+</div>\r\n\t\t\t\t\t\t<div>Upload</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Upload>\r\n\t\t\t<Modal\r\n\t\t\t\topen={previewVisible}\r\n\t\t\t\tfooter={null}\r\n\t\t\t\tonCancel={() => {\r\n\t\t\t\t\tsetpreviewVisible(false)\r\n\t\t\t\t}}>\r\n\t\t\t\t<img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\r\n\t\t\t</Modal>\r\n\t\t</>\r\n\t)\r\n\t// return (\r\n\t//   <>\r\n\t//     <Upload\r\n\t//       name=\"file\"\r\n\t//       listType=\"picture-card\"\r\n\t//       className=\"avatar-uploader\"\r\n\t//       showUploadList={true}\r\n\t//       action={serverUrl + \"/api/v1/common/file_upload\"}\r\n\t//       onChange={handleChange}\r\n\t// \t\t\tfileList={fileList}\r\n\t//     >\r\n\t//       {imageUrl ? (\r\n\t// <img src={serverUrl + imageUrl} alt=\"avatar\" style={{ width: \"100%\" }} />\r\n\t//         <img src={imageUrl} alt=\"avatar\" style={{ width: 100, height: 100 }} />\r\n\t//       ) : (\r\n\t// <div>\r\n\t//   <Icon type={loading ? \"loading\" : \"plus\"} />\r\n\t//   <div className=\"ant-upload-text\">Upload</div>\r\n\t// </div>\r\n\t// <img src={defaultImg} alt=\"avatar\" style={{ width: \"100%\" }} />\r\n\t//         <span>+</span>\r\n\t//       )}\r\n\t//     </Upload>\r\n\t//   </>\r\n\t// );\r\n}\r\n"],"names":["PicturesWall","images","previewVisible","setpreviewVisible","useState","previewImage","setpreviewImage","fileList","setFileList","useEffect","imgs","img","index","handlePreview","file","handleChange","jsxs","Fragment","jsx","Upload","Modal"],"mappings":"8DAKwB,SAAAA,EAAa,CAAE,OAAAC,GAAe,CACrD,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,WAAS,EAAK,EACpD,CAACC,EAAcC,CAAe,EAAIF,WAAS,EAAE,EAC7C,CAACG,EAAUC,CAAW,EAAIJ,EAAA,SAAS,CAAE,CAAA,EAE3CK,EAAAA,UAAU,IAAM,CACf,MAAMC,EAAOT,EAET,GAAAS,GAAQA,EAAK,OAAS,EAAG,CAC5B,IAAIH,EAAW,CAAA,EACfA,EAAWG,EAAK,IAAI,CAACC,EAAUC,KAAmB,CACjD,IAAK,CAACA,EACN,KAAMD,EACN,OAAQ,OAER,IAAKA,CACJ,EAAA,EACFH,EAAYD,CAAQ,CACrB,CACD,EAAG,CAAE,CAAA,EAQC,MAAAM,EAAiBC,GAAc,CACpBR,EAAAQ,EAAK,KAAOA,EAAK,QAAQ,EACzCX,EAAkB,EAAI,CAAA,EAGjBY,EAAwC,CAAC,CAAE,KAAAD,EAAM,SAAAP,KAAoB,CAC/CO,EAAK,OAAQP,EAAS,OAAiBA,EAASA,EAAS,OAAS,CAAC,EAC9FC,EAAYD,CAAQ,CAAA,EA0BrB,OAEES,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAC,EAAA,IAACC,EAAA,CACA,OAAO,+DACP,OAAO,UACP,KAAK,QACL,SAAS,eACT,SAAAZ,EACA,UAAWM,EACX,SAAUE,EACT,SAASR,EAAA,QAAU,EAAI,YACtB,MACA,CAAA,SAAA,CAAAW,EAAAA,IAAC,OAAI,SAAC,GAAA,CAAA,EACNA,EAAAA,IAAC,OAAI,SAAM,QAAA,CAAA,CAAA,EACZ,CAAA,CAEF,EACAA,EAAA,IAACE,EAAA,CACA,KAAMlB,EACN,OAAQ,KACR,SAAU,IAAM,CACfC,EAAkB,EAAK,CACxB,EACA,SAAAe,EAAA,IAAC,MAAI,CAAA,IAAI,UAAU,MAAO,CAAE,MAAO,MAAA,EAAU,IAAKb,CAAc,CAAA,CAAA,CACjE,CACD,CAAA,CAAA,CA2BF"}