import{d3 as V,d4 as _,r as p,d5 as W,j as s,d6 as A,d7 as z,Z as a,d8 as H,d9 as $,da as J,db as Y,S as j,d as R,dc as F,dd as G,X as U,ch as X,V as Z,W as q,cY as Q,by as ee,bz as N,c as re}from"./index-423f46ac.js";import{P as ae}from"./Table-e1df74be.js";import{_ as te}from"./Tree-2442eb40.js";import{u as I}from"./BaseForm-1ece3359.js";import{a as oe}from"./index-20957c5f.js";import"./index-c55d4eec.js";import"./index-5391c8b7.js";import"./index-71ae1401.js";import"./Select-a5967449.js";import"./List-5d9af893.js";import"./useShowArrow-e563b79d.js";import"./useIcons-8fe63cb4.js";import"./index-83f8b0a2.js";import"./Cascader-f676e781.js";import"./conductUtil-2d30a3cb.js";import"./index-96bf6f43.js";import"./index-ec6622af.js";import"./index-bdd45e2a.js";import"./useBubbleLock-632dc841.js";import"./_baseAssignValue-9ebb67f1.js";import"./_baseClone-9e0ad9b7.js";import"./ColorPicker-c2941bd0.js";import"./ColorPicker-d4bfeea8.js";import"./index-b1d133aa.js";import"./index-c24892bd.js";import"./customParseFormat-a74dbfaf.js";import"./SinglePicker-b19ccf79.js";import"./index-c1d0ae59.js";import"./index-73f41df7.js";import"./Image-7a0ca409.js";import"./addEventListener-3f056b0e.js";import"./index-67f1df35.js";import"./index-c3c494e6.js";import"./Rate-3f22a12f.js";import"./index-9eba9b09.js";import"./index-9d604222.js";import"./TreeSelect-f84f97a4.js";import"./createForOfIteratorHelper-adf5964d.js";import"./iconUtil-7e848ce5.js";import"./isoWeek-6d4e8cb4.js";import"./index-33cea770.js";import"./index-6e658917.js";import"./index-f84480cc.js";import"./styleChecker-6489d3a7.js";import"./index-353b5bfa.js";import"./useLazyKVMap-db19c4cc.js";import"./index-4725bd0a.js";import"./isEmpty-b123e901.js";import"./merge-0ec43793.js";import"./_baseIsEqual-896f0a67.js";import"./Table-d1b6e833.js";import"./index-4c11bcb6.js";import"./useMultipleSelect-8797fd3d.js";import"./Pagination-e2ff303d.js";import"./zh_CN-f51ae7db.js";import"./index-df848413.js";import"./index-144a4c61.js";import"./index-8a0f6792.js";import"./index-15033f39.js";import"./index-b1c803e3.js";import"./index-f1525d4e.js";import"./Steps-27eff5e3.js";const ne=r=>{let{transform:e}=r;return{...e,x:0}};var ie=["DragHandle","dragSortKey"],de=["dragSortKey"],E=p.createContext({handle:null}),se=function(e){var o=J({id:e.id}),l=o.attributes,g=o.listeners,y=o.setNodeRef,f=o.transform,D=o.transition,b=a({transform:Y.Transform.toString(f),transition:D},e==null?void 0:e.style),x=e.DragHandle,v=e.dragSortKey,c=j(e,ie);if(v){var m=[];return R.Children.forEach(c.children,function(t,u){if(t.key===v){var n,d;m.push(s.jsx(E.Provider,{value:{handle:s.jsx(x,a(a({rowData:t==null||(n=t.props)===null||n===void 0?void 0:n.record,index:t==null||(d=t.props)===null||d===void 0?void 0:d.index},g),l))},children:t},t.key||u));return}m.push(t)}),s.jsx("tr",a(a({},c),{},{ref:y,style:b,children:m}))}return s.jsx("tr",a(a(a({},c),{},{ref:y,style:b},l),g))},le=R.memo(function(r){r.dragSortKey;var e=j(r,de),o=p.useContext(E),l=o.handle;return l?s.jsx("td",a(a({},e),{},{children:s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l," ",e.children]})})):s.jsx("td",a({},e))}),ue=function(e){return s.jsx("tbody",a({},e))};function ce(r){var e=r.dataSource,o=e===void 0?[]:e,l=r.onDragSortEnd,g=r.DragHandle,y=r.dragSortKey,f=V(_(G),_(F)),D=p.useCallback(function(t){var u,n=t.active,d=t.over;if(d!=null&&(u=d.id)!==null&&u!==void 0&&u.toString()&&n.id!==(d==null?void 0:d.id)){var h=W(o||[],parseInt(n.id),parseInt(d.id));l==null||l(parseInt(n.id),parseInt(d.id),h||[])}},[o,l]),b=I(function(t){return s.jsx(A,{items:o.map(function(u,n){return n==null?void 0:n.toString()}),strategy:z,children:s.jsx(ue,a({},t))})}),x=I(function(t){var u,n=Object.assign({},(te(t),t)),d=(u=o.findIndex(function(h){var C;return h[(C=r.rowKey)!==null&&C!==void 0?C:"index"]===n["data-row-key"]}))===null||u===void 0?void 0:u.toString();return s.jsx(se,a({id:d,dragSortKey:y,DragHandle:g},n),d)}),v=r.components||{};if(y){var c;v.body=a({wrapper:b,row:x,cell:le},((c=r.components)===null||c===void 0?void 0:c.body)||{})}var m=p.useMemo(function(){return function(t){return s.jsx(H,{modifiers:[ne],sensors:f,collisionDetection:$,onDragEnd:D,children:t.children})}},[D,f]);return{DndContext:m,components:v}}var me=function(e){return U({},e.componentCls,{"&-icon":{marginInlineEnd:8,color:e.colorTextSecondary,cursor:"grab !important",padding:4,fontSize:12,borderRadius:e.borderRadius,"&:hover":{color:e.colorText,backgroundColor:e.colorInfoBg}}})};function ve(r){return oe("DragSortTable",function(e){var o=a(a({},e),{},{componentCls:".".concat(r)});return[me(o)]})}var Se=["rowKey","dragSortKey","dragSortHandlerRender","onDragSortEnd","onDataSourceChange","defaultData","dataSource","onLoad"],ge=["rowData","index","className"];function ye(r){var e,o=r.rowKey,l=r.dragSortKey,g=r.dragSortHandlerRender,y=r.onDragSortEnd,f=r.onDataSourceChange,D=r.defaultData,b=r.dataSource,x=r.onLoad,v=j(r,Se),c=p.useContext(X.ConfigContext),m=c.getPrefixCls,t=Z(function(){return D||[]},{value:b,onChange:f}),u=q(t,2),n=u[0],d=u[1],h=ve(m("pro-table-drag")),C=h.wrapSSR,P=h.hashId,T=p.useMemo(function(){return function(i){i.rowData,i.index;var w=i.className,S=j(i,ge),K=s.jsx(Q,a(a({},S),{},{className:"".concat(m("pro-table-drag-icon")," ").concat(w||""," ").concat(P||"").trim()})),k=g?g(i==null?void 0:i.rowData,i==null?void 0:i.index):K;return s.jsx("div",a(a({},S),{},{children:k}))}},[m]),L=ce({dataSource:n==null?void 0:n.slice(),dragSortKey:l,onDragSortEnd:y,components:r.components,rowKey:o,DragHandle:T}),M=L.components,B=L.DndContext,O=function(){var i=ee(N().mark(function w(S){return N().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return d(S),k.abrupt("return",x==null?void 0:x(S));case 2:case"end":return k.stop()}},w)}));return function(S){return i.apply(this,arguments)}}();return C(s.jsx(ae,a(a({},v),{},{columns:(e=v.columns)===null||e===void 0?void 0:e.map(function(i){return(i.dataIndex==l||i.key===l)&&(i.render||(i.render=function(){return null})),i}),onLoad:O,rowKey:o,tableViewRender:function(w,S){return s.jsx(B,{children:S})},dataSource:n,components:M,onDataSourceChange:f})))}const fe=[{title:"排序",dataIndex:"sort",width:60,className:"drag-visible",hideInSearch:!0},{title:"姓名",dataIndex:"name",className:"drag-visible"},{title:"年龄",dataIndex:"age"},{title:"地址",dataIndex:"address"}],xe=[{key:"1",name:"James Brown",age:32,address:"New York No. 1 Lake Park",index:0},{key:"2",name:"Ava Davis",age:42,address:"London No. 1 Lake Park",index:1},{key:"3",name:"Matthew Smith",age:32,address:"Sidney No. 1 Lake Park",index:2},{key:"4",name:"Daniel White",age:32,address:"London No. 2 Lake Park",index:3},{key:"5",name:"Emily White",age:28,address:"Paris No. 1 Lake Park",index:4},{key:"6",name:"Linda Johnson",age:37,address:"Los Angeles No. 1 Lake Park",index:5},{key:"7",name:"Michael Smith",age:45,address:"Chicago No. 1 Lake Park",index:6},{key:"8",name:"Sophia Martinez",age:29,address:"Berlin No. 1 Lake Park",index:7},{key:"9",name:"William Davis",age:36,address:"Tokyo No. 1 Lake Park",index:8},{key:"10",name:"Olivia Taylor",age:28,address:"Sydney No. 2 Lake Park",index:9}],Lr=()=>{const[r,e]=p.useState(xe),o=l=>{e(l),re.success("修改列表排序成功")};return s.jsx(ye,{className:"ant-pro-table-scroll",headerTitle:"使用 DragTable",columns:fe,bordered:!0,cardBordered:!0,scroll:{y:"100%"},rowKey:"key",dataSource:r,dragSortKey:"sort",onDragSortEnd:o})};export{Lr as default};
//# sourceMappingURL=index-5a3d0615.js.map
