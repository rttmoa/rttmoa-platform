import{r as o,j as t,F as O,ax as V,B as D,X as _}from"./index-ef9b1d0c.js";import{r as z,u as K}from"./xlsx-964ea548.js";import{S as N}from"./index-42755bc3.js";import{T as X}from"./Table-79f9a118.js";import"./Select-ec92186a.js";import"./List-74e22bc3.js";import"./useIcons-14f31057.js";import"./index-03dc7f0f.js";import"./zh_CN-1d35522c.js";import"./styleChecker-35fe84b4.js";import"./Tree-56aef61c.js";import"./conductUtil-b9168fdb.js";import"./index-3040eca6.js";import"./index-591b5b4f.js";import"./index-d87eec0f.js";import"./index-bb8b818d.js";import"./index-991f2255.js";import"./iconUtil-2340ebaf.js";const ie=()=>{const[T,p]=o.useState([]),[E,S]=o.useState([]),[k,g]=o.useState(!1),[b,v]=o.useState(),[C,F]=o.useState([]),[U,A]=o.useState(""),[d,y]=o.useState(""),j=(e,a)=>{S([]),p([]),a||y(""),g(!0);const l=new FileReader;l.onload=u=>{const n=new Uint8Array(u.target.result),i=z(n,{type:"array"}),L=a?i.Sheets[a]:i.Sheets[i.SheetNames[0]],c=K.sheet_to_json(L,{header:1}),w=i.SheetNames.map(r=>({label:r,value:r}));if(F(w),y(a||w[0].value),c.length>0){const r=[];c.slice(1).forEach((s,x)=>{if(s.length===0)return!1;const h={key:x};c[0].forEach((m,f)=>{h[m]=s[f]}),r.push(h)});const J=c[0].map(s=>({title:s,dataIndex:s,key:s,align:"center",render:(x,h,m)=>t.jsx(_,{style:{color:"#000",height:"100%",textAlign:"center"},bordered:!1,defaultValue:x,onBlur:f=>{B(f.target.value,m,s,r)}},m)}));S(J),p(r)}g(!1)},l.readAsArrayBuffer(e)},B=(e,a,l,u)=>{const n=JSON.parse(JSON.stringify(u));n[a][l]=e,p(n)},I=()=>{},R=e=>{b&&j(b,e)};return t.jsxs("div",{className:"TableDataImport",children:[t.jsxs("div",{className:"fileUpDiv",style:{marginTop:10},children:[t.jsx("span",{style:{marginRight:42},children:"文件名称"}),t.jsx("span",{className:"fileName",children:U}),t.jsx(O,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(A(e.name),v(e),j(e),!1):(V.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:t.jsx(D,{children:"上传Excel文件"})}),t.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!d&&t.jsx(N,{disabled:!0,style:{width:120},options:[]}),d&&t.jsx(N,{defaultValue:d,style:{width:120},onChange:R,options:C}),t.jsx(D,{type:"primary",onClick:I,children:"导入"})]}),t.jsx(X,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:k,size:"small",dataSource:T,columns:E})]})};export{ie as default};
