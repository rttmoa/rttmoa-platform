import{r as h,co as Z,j as s,ae as ie,aR as ee,$ as v,Y as T,V as ue,W as ne,X as re,cK as de,G as J,d as R,C as Y,R as ce,ax as me}from"./index-113fc74b.js";import{u as ae,b as le,a as ve}from"./index-a6a1d57f.js";import{i as fe}from"./index-8a0f6792.js";import{B as pe}from"./BaseForm-d64f7000.js";var he=function(e){if(e&&e!==!0)return e},Ce=function(e,c,n,i){return e?s.jsxs(s.Fragment,{children:[n.getMessage("tableForm.collapsed","展开"),i&&"(".concat(i,")"),s.jsx(ee,{style:{marginInlineStart:"0.5em",transition:"0.3s all",transform:"rotate(".concat(e?0:.5,"turn)")}})]}):s.jsxs(s.Fragment,{children:[n.getMessage("tableForm.expand","收起"),s.jsx(ee,{style:{marginInlineStart:"0.5em",transition:"0.3s all",transform:"rotate(".concat(e?0:.5,"turn)")}})]})},xe=function(e){var c=e.setCollapsed,n=e.collapsed,i=n===void 0?!1:n,a=e.submitter,u=e.style,j=e.hiddenNum,C=h.useContext(Z.ConfigContext),N=C.getPrefixCls,w=ae(),E=h.useContext(le),z=E.hashId,b=he(e.collapseRender)||Ce;return s.jsxs(ie,{style:u,size:16,children:[a,e.collapseRender!==!1&&s.jsx("a",{className:"".concat(N("pro-query-filter-collapse-button")," ").concat(z).trim(),onClick:function(){return c(!i)},children:b==null?void 0:b(i,e,w,j)})]})};const ge=xe;var be=function(e){return T({},e.componentCls,T(T(T(T({"&&":{padding:24}},"".concat(e.antCls,"-form-item"),{marginBlock:0}),"".concat(e.proComponentsCls,"-form-group-title"),{marginBlock:0}),"&-row",{rowGap:24,"&-split":T(T({},"".concat(e.proComponentsCls,"-form-group"),{display:"flex",alignItems:"center",gap:e.marginXS}),"&:last-child",{marginBlockEnd:12}),"&-split-line":{"&:after":{position:"absolute",width:"100%",content:'""',height:1,insetBlockEnd:-12,borderBlockEnd:"1px dashed ".concat(e.colorSplit)}}}),"&-collapse-button",{display:"flex",alignItems:"center",color:e.colorPrimary}))};function ye(t){return ve("QueryFilter",function(e){var c=v(v({},e),{},{componentCls:".".concat(t)});return[be(c)]})}var Se=["collapsed","layout","defaultCollapsed","defaultColsNumber","defaultFormItemsNumber","span","searchGutter","searchText","resetText","optionRender","collapseRender","onReset","onCollapse","labelWidth","style","split","preserve","ignoreRules","showHiddenNum","submitterColSpanProps"],F,Re={xs:513,sm:513,md:785,lg:992,xl:1057,xxl:1/0},te={vertical:[[513,1,"vertical"],[785,2,"vertical"],[1057,3,"vertical"],[1/0,4,"vertical"]],default:[[513,1,"vertical"],[701,2,"vertical"],[1062,3,"horizontal"],[1352,3,"horizontal"],[1/0,4,"horizontal"]]},Ne=function(e,c,n){if(n&&typeof n=="number")return{span:n,layout:e};var i=n?["xs","sm","md","lg","xl","xxl"].map(function(u){return[Re[u],24/n[u],"horizontal"]}):te[e||"default"],a=(i||te.default).find(function(u){return c<u[0]+16});return a?{span:24/a[1],layout:a==null?void 0:a[2]}:{span:8,layout:"horizontal"}},we=function(e,c){return e==null?void 0:e.flatMap(function(n){var i,a;if((n==null||(i=n.type)===null||i===void 0?void 0:i.displayName)==="ProForm-Group"&&!((a=n.props)!==null&&a!==void 0&&a.title))return n.props.children;if(c&&R.isValidElement(n)){var u;return R.cloneElement(n,v(v({},n.props),{},{formItemProps:v(v({},(u=n.props)===null||u===void 0?void 0:u.formItemProps),{},{rules:[]})}))}return n})},Pe=function(e){var c,n,i,a,u=ae(),j=h.useContext(le),C=j.hashId,N=e.resetText||u.getMessage("tableForm.reset","重置"),w=e.searchText||u.getMessage("tableForm.search","搜索"),E=ne(function(){return e.defaultCollapsed&&!!e.submitter},{value:e.collapsed,onChange:e.onCollapse}),z=re(E,2),b=z[0],$=z[1],f=e.optionRender,x=e.collapseRender,O=e.split,A=e.items,y=e.spanSize,B=e.showLength,D=e.searchGutter,Q=e.showHiddenNum,H=h.useMemo(function(){return!e.submitter||f===!1?null:R.cloneElement(e.submitter,v({searchConfig:{resetText:N,submitText:w},render:f&&function(r,o){return f(v(v({},e),{},{resetText:N,searchText:w}),e,o)}},e.submitter.props))},[e,N,w,f]),P=0,k=0,_=!1,I=0,p=0,G=we(A,e.ignoreRules).map(function(r,o){var d,m,l,S,V=R.isValidElement(r)&&(d=r==null||(m=r.props)===null||m===void 0?void 0:m.colSize)!==null&&d!==void 0?d:1,M=Math.min(y.span*(V||1),24);if(P+=M,I+=V,o===0){var U;_=M===24&&!(r!=null&&(U=r.props)!==null&&U!==void 0&&U.hidden)}var oe=(r==null||(l=r.props)===null||l===void 0?void 0:l.hidden)||b&&(_||I>B)&&!!o;k+=1;var se=R.isValidElement(r)&&(r.key||"".concat((S=r.props)===null||S===void 0?void 0:S.name))||o;return R.isValidElement(r)&&oe?e.preserve?{itemDom:R.cloneElement(r,{hidden:!0,key:se||o}),hidden:!0,colSpan:M}:{itemDom:null,colSpan:0,hidden:!0}:{itemDom:r,colSpan:M,hidden:!1}}),q=G.map(function(r,o){var d,m,l=r.itemDom,S=r.colSpan,V=l==null||(d=l.props)===null||d===void 0?void 0:d.hidden;if(V)return l;var M=R.isValidElement(l)&&(l.key||"".concat((m=l.props)===null||m===void 0?void 0:m.name))||o;return 24-p%24<S&&(P+=24-p%24,p+=24-p%24),p+=S,O&&p%24===0&&o<k-1?s.jsx(Y,{span:S,className:"".concat(e.baseClassName,"-row-split-line ").concat(e.baseClassName,"-row-split ").concat(C).trim(),children:l},M):s.jsx(Y,{className:"".concat(e.baseClassName,"-row-split ").concat(C).trim(),span:S,children:l},M)}),K=Q&&G.filter(function(r){return r.hidden}).length,W=h.useMemo(function(){return!(P<24||I<=B)},[I,B,P]),X=h.useMemo(function(){var r,o,d=p%24+((r=(o=e.submitterColSpanProps)===null||o===void 0?void 0:o.span)!==null&&r!==void 0?r:y.span);if(d>24){var m,l;return 24-((m=(l=e.submitterColSpanProps)===null||l===void 0?void 0:l.span)!==null&&m!==void 0?m:y.span)}return 24-d},[p,p%24+((c=(n=e.submitterColSpanProps)===null||n===void 0?void 0:n.span)!==null&&c!==void 0?c:y.span),(i=e.submitterColSpanProps)===null||i===void 0?void 0:i.span]),g=h.useContext(Z.ConfigContext),L=g.getPrefixCls("pro-query-filter");return s.jsxs(ce,{gutter:D,justify:"start",className:J("".concat(L,"-row"),C),children:[q,H&&s.jsx(Y,v(v({span:y.span,offset:X,className:J((a=e.submitterColSpanProps)===null||a===void 0?void 0:a.className)},e.submitterColSpanProps),{},{style:{textAlign:"end"},children:s.jsx(me.Item,{label:" ",colon:!1,shouldUpdate:!1,className:"".concat(L,"-actions ").concat(C).trim(),children:s.jsx(ge,{hiddenNum:K,collapsed:b,collapseRender:W?x:!1,submitter:H,setCollapsed:$},"pro-form-query-filter-actions")})}),"submitter")]},"resize-observer-row")},_e=fe()?(F=document)===null||F===void 0||(F=F.body)===null||F===void 0?void 0:F.clientWidth:1024;function ze(t){var e=t.collapsed,c=t.layout,n=t.defaultCollapsed,i=n===void 0?!0:n,a=t.defaultColsNumber,u=t.defaultFormItemsNumber,j=t.span,C=t.searchGutter,N=C===void 0?24:C;t.searchText,t.resetText;var w=t.optionRender,E=t.collapseRender,z=t.onReset,b=t.onCollapse,$=t.labelWidth,f=$===void 0?"80":$,x=t.style,O=t.split,A=t.preserve,y=A===void 0?!0:A,B=t.ignoreRules,D=t.showHiddenNum,Q=D===void 0?!1:D,H=t.submitterColSpanProps,P=ue(t,Se),k=h.useContext(Z.ConfigContext),_=k.getPrefixCls("pro-query-filter"),I=ye(_),p=I.wrapSSR,G=I.hashId,q=ne(function(){return typeof(x==null?void 0:x.width)=="number"?x==null?void 0:x.width:_e}),K=re(q,2),W=K[0],X=K[1],g=h.useMemo(function(){return Ne(c,W+16,j)},[c,W,j]),L=h.useMemo(function(){if(u!==void 0)return u;if(a!==void 0){var o=24/g.span-1;return a>o?o:a}return Math.max(1,24/g.span-1)},[a,u,g.span]),r=h.useMemo(function(){if(f&&g.layout!=="vertical"&&f!=="auto")return{labelCol:{flex:"0 0 ".concat(f,"px")},wrapperCol:{style:{maxWidth:"calc(100% - ".concat(f,"px)")}},style:{flexWrap:"nowrap"}}},[g.layout,f]);return p(s.jsx(de,{onResize:function(d){W!==d.width&&d.width>17&&X(d.width)},children:s.jsx("div",{className:"".concat(_,"-container ").concat(G),children:s.jsx(pe,v(v({isKeyPressSubmit:!0,preserve:y},P),{},{className:J(_,G,P.className),onReset:z,style:x,layout:g.layout,fieldProps:{style:{width:"100%"}},formItemProps:r,groupProps:{titleStyle:{display:"inline-block",marginInlineEnd:16}},contentRender:function(d,m,l){return s.jsx(Pe,{spanSize:g,collapsed:e,form:l,submitterColSpanProps:H,collapseRender:E,defaultCollapsed:i,onCollapse:b,optionRender:w,submitter:m,items:d,split:O,baseClassName:_,resetText:t.resetText,searchText:t.searchText,searchGutter:N,preserve:y,ignoreRules:B,showLength:L,showHiddenNum:Q})}}))})},"resize-observer"))}export{ze as Q,he as o};
//# sourceMappingURL=index-5559f1a5.js.map
