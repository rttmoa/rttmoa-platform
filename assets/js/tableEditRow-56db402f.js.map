{"version":3,"file":"tableEditRow-56db402f.js","sources":["../../../src/views/list/basicTable/components/tableEditRow.tsx"],"sourcesContent":["import React, { useState } from 'react'\r\nimport { Form, Input, InputNumber, Popconfirm, Table, Typography } from 'antd'\r\n\r\ninterface Item {\r\n\tkey: string\r\n\tname: string\r\n\tage: number\r\n\taddress: string\r\n}\r\n\r\nconst originData: Item[] = []\r\nfor (let i = 0; i < 100; i++) {\r\n\toriginData.push({\r\n\t\tkey: i.toString(),\r\n\t\tname: `Edward ${i}`,\r\n\t\tage: 32,\r\n\t\taddress: `London Park no. ${i}`,\r\n\t})\r\n}\r\ninterface EditableCellProps extends React.HTMLAttributes<HTMLElement> {\r\n\tediting: boolean\r\n\tdataIndex: string\r\n\ttitle: any\r\n\tinputType: 'number' | 'text'\r\n\trecord: Item\r\n\tindex: number\r\n\tchildren: React.ReactNode\r\n}\r\n\r\nconst EditableCell: React.FC<EditableCellProps> = ({ editing, dataIndex, title, inputType, record, index, children, ...restProps }) => {\r\n\tconst inputNode = inputType === 'number' ? <InputNumber /> : <Input />\r\n\r\n\treturn (\r\n\t\t<td {...restProps}>\r\n\t\t\t{editing ? (\r\n\t\t\t\t<Form.Item\r\n\t\t\t\t\tname={dataIndex}\r\n\t\t\t\t\tstyle={{ margin: 0 }}\r\n\t\t\t\t\trules={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\tmessage: `Please Input ${title}!`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t]}>\r\n\t\t\t\t\t{inputNode}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t) : (\r\n\t\t\t\tchildren\r\n\t\t\t)}\r\n\t\t</td>\r\n\t)\r\n}\r\n\r\nconst App: any = ({ isShow }: any) => {\r\n\tconst [form] = Form.useForm()\r\n\tconst [data, setData] = useState(originData)\r\n\tconst [editingKey, setEditingKey] = useState('')\r\n\r\n\tconst isEditing = (record: Item) => record.key === editingKey\r\n\r\n\tconst edit = (record: Partial<Item> & { key: React.Key }) => {\r\n\t\tform.setFieldsValue({ name: '', age: '', address: '', ...record })\r\n\t\tsetEditingKey(record.key)\r\n\t}\r\n\r\n\tconst cancel = () => {\r\n\t\tsetEditingKey('')\r\n\t}\r\n\r\n\tconst save = async (key: React.Key) => {\r\n\t\ttry {\r\n\t\t\tconst row = (await form.validateFields()) as Item\r\n\r\n\t\t\tconst newData = [...data]\r\n\t\t\tconst index = newData.findIndex(item => key === item.key)\r\n\t\t\tif (index > -1) {\r\n\t\t\t\tconst item = newData[index]\r\n\t\t\t\tnewData.splice(index, 1, {\r\n\t\t\t\t\t...item,\r\n\t\t\t\t\t...row,\r\n\t\t\t\t})\r\n\t\t\t\tsetData(newData)\r\n\t\t\t\tsetEditingKey('')\r\n\t\t\t} else {\r\n\t\t\t\tnewData.push(row)\r\n\t\t\t\tsetData(newData)\r\n\t\t\t\tsetEditingKey('')\r\n\t\t\t}\r\n\t\t} catch (errInfo) {\r\n\t\t\tconsole.log('Validate Failed:', errInfo)\r\n\t\t}\r\n\t}\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\ttitle: 'name',\r\n\t\t\tdataIndex: 'name',\r\n\t\t\twidth: '25%',\r\n\t\t\teditable: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'age',\r\n\t\t\tdataIndex: 'age',\r\n\t\t\twidth: '15%',\r\n\t\t\teditable: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'address',\r\n\t\t\tdataIndex: 'address',\r\n\t\t\twidth: '40%',\r\n\t\t\teditable: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: 'operation',\r\n\t\t\tdataIndex: 'operation',\r\n\t\t\trender: (_: any, record: Item) => {\r\n\t\t\t\tconst editable = isEditing(record)\r\n\t\t\t\treturn editable ? (\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t<Typography.Link onClick={() => save(record.key)} style={{ marginRight: 8 }}>\r\n\t\t\t\t\t\t\tSave\r\n\t\t\t\t\t\t</Typography.Link>\r\n\t\t\t\t\t\t<Popconfirm title=\"Sure to cancel?\" onConfirm={cancel}>\r\n\t\t\t\t\t\t\t<a>Cancel</a>\r\n\t\t\t\t\t\t</Popconfirm>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<Typography.Link disabled={editingKey !== ''} onClick={() => edit(record)}>\r\n\t\t\t\t\t\tEdit\r\n\t\t\t\t\t</Typography.Link>\r\n\t\t\t\t)\r\n\t\t\t},\r\n\t\t},\r\n\t]\r\n\r\n\tconst mergedColumns = columns.map(col => {\r\n\t\tif (!col.editable) {\r\n\t\t\treturn col\r\n\t\t}\r\n\t\treturn {\r\n\t\t\t...col,\r\n\t\t\tonCell: (record: Item) => ({\r\n\t\t\t\trecord,\r\n\t\t\t\tinputType: col.dataIndex === 'age' ? 'number' : 'text',\r\n\t\t\t\tdataIndex: col.dataIndex,\r\n\t\t\t\ttitle: col.title,\r\n\t\t\t\tediting: isEditing(record),\r\n\t\t\t}),\r\n\t\t}\r\n\t})\r\n\r\n\treturn (\r\n\t\tisShow && (\r\n\t\t\t<Form form={form} component={false}>\r\n\t\t\t\t<Table\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tbody: {\r\n\t\t\t\t\t\t\tcell: EditableCell,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tbordered\r\n\t\t\t\t\tdataSource={data}\r\n\t\t\t\t\tcolumns={mergedColumns}\r\n\t\t\t\t\trowClassName=\"editable-row\"\r\n\t\t\t\t\tpagination={{\r\n\t\t\t\t\t\tonChange: cancel,\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</Form>\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport default App\r\n"],"names":["originData","i","EditableCell","editing","dataIndex","title","inputType","record","index","children","restProps","inputNode","InputNumber","Input","jsx","Form","App","isShow","form","data","setData","useState","editingKey","setEditingKey","isEditing","edit","cancel","save","key","row","newData","item","mergedColumns","_","Typography","Popconfirm","col","Table"],"mappings":"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"}