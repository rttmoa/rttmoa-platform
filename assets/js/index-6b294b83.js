import{bv as A,bw as K,r as D,bx as V,w as a,j as s,by as W,bz as z,R,_ as p,bA as H,bB as $,bC as F,bD as G,bE as J,bF as U,t as Y,bG as q,o as Q,p as X,br as Z,aO as ee,aP as N,m as re}from"./index-f77a2189.js";import{b as I,d as ae,P as te}from"./Table-e4039df3.js";import{_ as ne}from"./iconUtil-d73dc3f5.js";import"./Table-d908ce94.js";import"./styleChecker-a4bf52b3.js";import"./List-7060b1db.js";import"./conductUtil-626b5303.js";import"./index-e1c30737.js";import"./index-d4bff64c.js";import"./index-3511637a.js";import"./index-a13146b5.js";import"./index-78cce5ed.js";import"./useIcons-a0a55a5d.js";import"./index-ab20f1a6.js";import"./index-edf5fcc5.js";import"./index-a9c54509.js";import"./index-85f839d7.js";import"./map-58966ac2.js";import"./_baseAssignValue-af93accd.js";import"./_baseClone-18a7a918.js";import"./_copyArray-255e57c5.js";import"./ColorPicker-a8281399.js";import"./customParseFormat-d55b509c.js";import"./index-b3936a7c.js";import"./index-045f6f9f.js";import"./index-0d28ffa6.js";import"./index-a688f734.js";import"./index-27a2e3b4.js";import"./index-ab672b9f.js";import"./isoWeek-0ced5ef0.js";import"./index-589b89cf.js";import"./transButton-d766c0a1.js";const oe=r=>{let{transform:e}=r;return{...e,x:0}};var ie=["DragHandle","dragSortKey"],de=["dragSortKey"],E=D.createContext({handle:null}),se=function(e){var n=J({id:e.id}),l=n.attributes,g=n.listeners,y=n.setNodeRef,x=n.transform,b=n.transition,h=a({transform:U.Transform.toString(x),transition:b},e==null?void 0:e.style),f=e.DragHandle,v=e.dragSortKey,c=p(e,ie);if(v){var m=[];return R.Children.forEach(c.children,function(t,u){if(t.key===v){var o,d;m.push(s.jsx(E.Provider,{value:{handle:s.jsx(f,a(a({rowData:t==null||(o=t.props)===null||o===void 0?void 0:o.record,index:t==null||(d=t.props)===null||d===void 0?void 0:d.index},g),l))},children:t},t.key||u));return}m.push(t)}),s.jsx("tr",a(a({},c),{},{ref:y,style:h,children:m}))}return s.jsx("tr",a(a(a({},c),{},{ref:y,style:h},l),g))},le=R.memo(function(r){r.dragSortKey;var e=p(r,de),n=D.useContext(E),l=n.handle;return l?s.jsx("td",a(a({},e),{},{children:s.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l," ",e.children]})})):s.jsx("td",a({},e))}),ue=function(e){return s.jsx("tbody",a({},e))};function ce(r){var e=r.dataSource,n=e===void 0?[]:e,l=r.onDragSortEnd,g=r.DragHandle,y=r.dragSortKey,x=A(K($),K(H)),b=D.useCallback(function(t){var u,o=t.active,d=t.over;if(d!=null&&(u=d.id)!==null&&u!==void 0&&u.toString()&&o.id!==(d==null?void 0:d.id)){var k=V(n||[],parseInt(o.id),parseInt(d.id));l==null||l(parseInt(o.id),parseInt(d.id),k||[])}},[n,l]),h=I(function(t){return s.jsx(F,{items:n.map(function(u,o){return o==null?void 0:o.toString()}),strategy:G,children:s.jsx(ue,a({},t))})}),f=I(function(t){var u,o=Object.assign({},(ne(t),t)),d=(u=n.findIndex(function(k){var w;return k[(w=r.rowKey)!==null&&w!==void 0?w:"index"]===o["data-row-key"]}))===null||u===void 0?void 0:u.toString();return s.jsx(se,a({id:d,dragSortKey:y,DragHandle:g},o),d)}),v=r.components||{};if(y){var c;v.body=a(a({},((c=r.components)===null||c===void 0?void 0:c.body)||{}),{},{wrapper:h,row:f,cell:le})}var m=D.useMemo(function(){return function(t){return s.jsx(W,{modifiers:[oe],sensors:x,collisionDetection:z,onDragEnd:b,children:t.children})}},[b,x]);return{DndContext:m,components:v}}var me=function(e){return Y({},e.componentCls,{"&-icon":{marginInlineEnd:8,color:e.colorTextSecondary,cursor:"grab !important",padding:4,fontSize:12,borderRadius:e.borderRadius,"&:hover":{color:e.colorText,backgroundColor:e.colorInfoBg}}})};function ve(r){return ae("DragSortTable",function(e){var n=a(a({},e),{},{componentCls:".".concat(r)});return[me(n)]})}var Se=["rowKey","dragSortKey","dragSortHandlerRender","onDragSortEnd","onDataSourceChange","defaultData","dataSource","onLoad"],ge=["rowData","index","className"];function ye(r){var e,n=r.rowKey,l=r.dragSortKey,g=r.dragSortHandlerRender,y=r.onDragSortEnd,x=r.onDataSourceChange,b=r.defaultData,h=r.dataSource,f=r.onLoad,v=p(r,Se),c=D.useContext(q.ConfigContext),m=c.getPrefixCls,t=Q(function(){return b||[]},{value:h,onChange:x}),u=X(t,2),o=u[0],d=u[1],k=ve(m("pro-table-drag")),w=k.wrapSSR,P=k.hashId,T=D.useMemo(function(){return function(i){i.rowData,i.index;var j=i.className,S=p(i,ge),_=s.jsx(Z,a(a({},S),{},{className:"".concat(m("pro-table-drag-icon")," ").concat(j||""," ").concat(P||"").trim()})),C=g?g(i==null?void 0:i.rowData,i==null?void 0:i.index):_;return s.jsx("div",a(a({},S),{},{children:C}))}},[m]),L=ce({dataSource:o==null?void 0:o.slice(),dragSortKey:l,onDragSortEnd:y,components:r.components,rowKey:n,DragHandle:T}),M=L.components,B=L.DndContext,O=function(){var i=ee(N().mark(function j(S){return N().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return d(S),C.abrupt("return",f==null?void 0:f(S));case 2:case"end":return C.stop()}},j)}));return function(S){return i.apply(this,arguments)}}();return w(s.jsx(te,a(a({},v),{},{columns:(e=v.columns)===null||e===void 0?void 0:e.map(function(i){return(i.dataIndex==l||i.key===l)&&(i.render||(i.render=function(){return null})),i}),onLoad:O,rowKey:n,tableViewRender:function(j,S){return s.jsx(B,{children:S})},dataSource:o,components:M,onDataSourceChange:x})))}const xe=[{title:"排序",dataIndex:"sort",width:60,className:"drag-visible",hideInSearch:!0},{title:"姓名",dataIndex:"name",className:"drag-visible"},{title:"年龄",dataIndex:"age"},{title:"地址",dataIndex:"address"}],fe=[{key:"1",name:"James Brown",age:32,address:"New York No. 1 Lake Park",index:0},{key:"2",name:"Ava Davis",age:42,address:"London No. 1 Lake Park",index:1},{key:"3",name:"Matthew Smith",age:32,address:"Sidney No. 1 Lake Park",index:2},{key:"4",name:"Daniel White",age:32,address:"London No. 2 Lake Park",index:3},{key:"5",name:"Emily White",age:28,address:"Paris No. 1 Lake Park",index:4},{key:"6",name:"Linda Johnson",age:37,address:"Los Angeles No. 1 Lake Park",index:5},{key:"7",name:"Michael Smith",age:45,address:"Chicago No. 1 Lake Park",index:6},{key:"8",name:"Sophia Martinez",age:29,address:"Berlin No. 1 Lake Park",index:7},{key:"9",name:"William Davis",age:36,address:"Tokyo No. 1 Lake Park",index:8},{key:"10",name:"Olivia Taylor",age:28,address:"Sydney No. 2 Lake Park",index:9}],Qe=()=>{const[r,e]=D.useState(fe),n=l=>{e(l),re.success("修改列表排序成功")};return s.jsx(ye,{className:"ant-pro-table-scroll",headerTitle:"使用 DragTable",columns:xe,bordered:!0,cardBordered:!0,scroll:{y:"100%"},rowKey:"key",dataSource:r,dragSortKey:"sort",onDragSortEnd:n})};export{Qe as default};
//# sourceMappingURL=index-6b294b83.js.map
