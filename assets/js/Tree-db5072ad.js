import{r as b,G as Y,Y as u,V as Be,d as w,X as ne,c4 as nt,Z as se,$ as H,bp as at,c1 as Se,c3 as Ue,bm as Me,bn as lt,dh as st,di as ct,d3 as ut,dj as D,bu as me,d2 as ft}from"./index-3957a516.js";import{L as vt}from"./List-0e1ae3e6.js";import{g as j,b as W,d as Pe,e as rt,f as qe,h as Ie,i as $e,a as gt,c as yt}from"./conductUtil-f43807c6.js";var Fe=b.createContext(null),ht=b.createContext({}),pt=function(r){for(var g=r.prefixCls,e=r.level,d=r.isStart,c=r.isEnd,C="".concat(g,"-indent-unit"),t=[],o=0;o<e;o+=1)t.push(b.createElement("span",{key:o,className:Y(C,u(u({},"".concat(C,"-start"),d[o]),"".concat(C,"-end"),c[o]))}));return b.createElement("span",{"aria-hidden":"true",className:"".concat(g,"-indent")},t)};const Kt=b.memo(pt);var mt=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],Ge="open",Ve="close",Nt="---",we=function(r){var g,e,d,c=r.eventKey,C=r.className,t=r.style,o=r.dragOver,n=r.dragOverGapTop,l=r.dragOverGapBottom,f=r.isLeaf,m=r.isStart,h=r.isEnd,p=r.expanded,x=r.selected,s=r.checked,v=r.halfChecked,k=r.loading,y=r.domRef,N=r.active,E=r.data,P=r.onMouseMove,S=r.selectable,O=Be(r,mt),a=w.useContext(Fe),T=w.useContext(ht),L=w.useRef(null),I=w.useState(!1),A=ne(I,2),_=A[0],U=A[1],$=!!(a.disabled||r.disabled||(g=T.nodeDisabled)!==null&&g!==void 0&&g.call(T,E)),B=w.useMemo(function(){return!a.checkable||r.checkable===!1?!1:a.checkable},[a.checkable,r.checkable]),ue=function(K){$||a.onNodeSelect(K,W(r))},fe=function(K){$||!B||r.disableCheckbox||a.onNodeCheck(K,W(r),!s)},Ne=w.useMemo(function(){return typeof S=="boolean"?S:a.selectable},[S,a.selectable]),ve=function(K){a.onNodeClick(K,W(r)),Ne?ue(K):fe(K)},ae=function(K){a.onNodeDoubleClick(K,W(r))},q=function(K){a.onNodeMouseEnter(K,W(r))},re=function(K){a.onNodeMouseLeave(K,W(r))},ge=function(K){a.onNodeContextMenu(K,W(r))},F=w.useMemo(function(){return!!(a.draggable&&(!a.draggable.nodeDraggable||a.draggable.nodeDraggable(E)))},[a.draggable,E]),ke=function(K){K.stopPropagation(),U(!0),a.onNodeDragStart(K,r);try{K.dataTransfer.setData("text/plain","")}catch{}},Z=function(K){K.preventDefault(),K.stopPropagation(),a.onNodeDragEnter(K,r)},Ce=function(K){K.preventDefault(),K.stopPropagation(),a.onNodeDragOver(K,r)},ye=function(K){K.stopPropagation(),a.onNodeDragLeave(K,r)},J=function(K){K.stopPropagation(),U(!1),a.onNodeDragEnd(K,r)},oe=function(K){K.preventDefault(),K.stopPropagation(),U(!1),a.onNodeDrop(K,r)},Le=function(K){k||a.onNodeExpand(K,W(r))},he=w.useMemo(function(){var M=j(a.keyEntities,c)||{},K=M.children;return!!(K||[]).length},[a.keyEntities,c]),Q=w.useMemo(function(){return f===!1?!1:f||!a.loadData&&!he||a.loadData&&r.loaded&&!he},[f,a.loadData,he,r.loaded]);w.useEffect(function(){k||typeof a.loadData=="function"&&p&&!Q&&!r.loaded&&a.onNodeLoad(W(r))},[k,a.loadData,a.onNodeLoad,p,Q,r]);var xe=w.useMemo(function(){var M;return(M=a.draggable)!==null&&M!==void 0&&M.icon?w.createElement("span",{className:"".concat(a.prefixCls,"-draggable-icon")},a.draggable.icon):null},[a.draggable]),Ee=function(K){var V=r.switcherIcon||a.switcherIcon;return typeof V=="function"?V(H(H({},r),{},{isLeaf:K})):V},be=function(){if(Q){var K=Ee(!0);return K!==!1?w.createElement("span",{className:Y("".concat(a.prefixCls,"-switcher"),"".concat(a.prefixCls,"-switcher-noop"))},K):null}var V=Ee(!1);return V!==!1?w.createElement("span",{onClick:Le,className:Y("".concat(a.prefixCls,"-switcher"),"".concat(a.prefixCls,"-switcher_").concat(p?Ge:Ve))},V):null},Re=w.useMemo(function(){if(!B)return null;var M=typeof B!="boolean"?B:null;return w.createElement("span",{className:Y("".concat(a.prefixCls,"-checkbox"),u(u(u({},"".concat(a.prefixCls,"-checkbox-checked"),s),"".concat(a.prefixCls,"-checkbox-indeterminate"),!s&&v),"".concat(a.prefixCls,"-checkbox-disabled"),$||r.disableCheckbox)),onClick:fe,role:"checkbox","aria-checked":v?"mixed":s,"aria-disabled":$||r.disableCheckbox,"aria-label":"Select ".concat(typeof r.title=="string"?r.title:"tree node")},M)},[B,s,v,$,r.disableCheckbox,r.title]),ie=w.useMemo(function(){return Q?null:p?Ge:Ve},[Q,p]),R=w.useMemo(function(){return w.createElement("span",{className:Y("".concat(a.prefixCls,"-iconEle"),"".concat(a.prefixCls,"-icon__").concat(ie||"docu"),u({},"".concat(a.prefixCls,"-icon_loading"),k))})},[a.prefixCls,ie,k]),G=w.useMemo(function(){var M=!!a.draggable,K=!r.disabled&&M&&a.dragOverNodeKey===c;return K?a.dropIndicatorRender({dropPosition:a.dropPosition,dropLevelOffset:a.dropLevelOffset,indent:a.indent,prefixCls:a.prefixCls,direction:a.direction}):null},[a.dropPosition,a.dropLevelOffset,a.indent,a.prefixCls,a.direction,a.draggable,a.dragOverNodeKey,a.dropIndicatorRender]),X=w.useMemo(function(){var M=r.title,K=M===void 0?Nt:M,V="".concat(a.prefixCls,"-node-content-wrapper"),_e;if(a.showIcon){var Oe=r.icon||a.icon;_e=Oe?w.createElement("span",{className:Y("".concat(a.prefixCls,"-iconEle"),"".concat(a.prefixCls,"-icon__customize"))},typeof Oe=="function"?Oe(r):Oe):R}else a.loadData&&k&&(_e=R);var Te;return typeof K=="function"?Te=K(E):a.titleRender?Te=a.titleRender(E):Te=K,w.createElement("span",{ref:L,title:typeof K=="string"?K:"",className:Y(V,"".concat(V,"-").concat(ie||"normal"),u({},"".concat(a.prefixCls,"-node-selected"),!$&&(x||_))),onMouseEnter:q,onMouseLeave:re,onContextMenu:ge,onClick:ve,onDoubleClick:ae},_e,w.createElement("span",{className:"".concat(a.prefixCls,"-title")},Te),G)},[a.prefixCls,a.showIcon,r,a.icon,R,a.titleRender,E,ie,q,re,ge,ve,ae]),pe=nt(O,{aria:!0,data:!0}),de=j(a.keyEntities,c)||{},De=de.level,Ke=h[h.length-1],ee=!$&&F,le=a.draggingNodeKey===c,je=S!==void 0?{"aria-selected":!!S}:void 0;return w.createElement("div",se({ref:y,role:"treeitem","aria-expanded":f?void 0:p,className:Y(C,"".concat(a.prefixCls,"-treenode"),(d={},u(u(u(u(u(u(u(u(u(u(d,"".concat(a.prefixCls,"-treenode-disabled"),$),"".concat(a.prefixCls,"-treenode-switcher-").concat(p?"open":"close"),!f),"".concat(a.prefixCls,"-treenode-checkbox-checked"),s),"".concat(a.prefixCls,"-treenode-checkbox-indeterminate"),v),"".concat(a.prefixCls,"-treenode-selected"),x),"".concat(a.prefixCls,"-treenode-loading"),k),"".concat(a.prefixCls,"-treenode-active"),N),"".concat(a.prefixCls,"-treenode-leaf-last"),Ke),"".concat(a.prefixCls,"-treenode-draggable"),F),"dragging",le),u(u(u(u(u(u(u(d,"drop-target",a.dropTargetKey===c),"drop-container",a.dropContainerKey===c),"drag-over",!$&&o),"drag-over-gap-top",!$&&n),"drag-over-gap-bottom",!$&&l),"filter-node",(e=a.filterTreeNode)===null||e===void 0?void 0:e.call(a,W(r))),"".concat(a.prefixCls,"-treenode-leaf"),Q))),style:t,draggable:ee,onDragStart:ee?ke:void 0,onDragEnter:F?Z:void 0,onDragOver:F?Ce:void 0,onDragLeave:F?ye:void 0,onDrop:F?oe:void 0,onDragEnd:F?J:void 0,onMouseMove:P},je,pe),w.createElement(Kt,{prefixCls:a.prefixCls,level:De,isStart:m,isEnd:h}),xe,be(),Re,X)};we.isTreeNode=1;function z(i,r){if(!i)return[];var g=i.slice(),e=g.indexOf(r);return e>=0&&g.splice(e,1),g}function te(i,r){var g=(i||[]).slice();return g.indexOf(r)===-1&&g.push(r),g}function He(i){return i.split("-")}function kt(i,r){var g=[],e=j(r,i);function d(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];c.forEach(function(C){var t=C.key,o=C.children;g.push(t),d(o)})}return d(e.children),g}function Ct(i){if(i.parent){var r=He(i.pos);return Number(r[r.length-1])===i.parent.children.length-1}return!1}function xt(i){var r=He(i.pos);return Number(r[r.length-1])===0}function Ye(i,r,g,e,d,c,C,t,o,n){var l,f=i.clientX,m=i.clientY,h=i.target.getBoundingClientRect(),p=h.top,x=h.height,s=(n==="rtl"?-1:1)*(((d==null?void 0:d.x)||0)-f),v=(s-12)/e,k=o.filter(function($){var B;return(B=t[$])===null||B===void 0||(B=B.children)===null||B===void 0?void 0:B.length}),y=j(t,g.eventKey);if(m<p+x/2){var N=C.findIndex(function($){return $.key===y.key}),E=N<=0?0:N-1,P=C[E].key;y=j(t,P)}var S=y.key,O=y,a=y.key,T=0,L=0;if(!k.includes(S))for(var I=0;I<v&&Ct(y);I+=1)y=y.parent,L+=1;var A=r.data,_=y.node,U=!0;return xt(y)&&y.level===0&&m<p+x/2&&c({dragNode:A,dropNode:_,dropPosition:-1})&&y.key===g.eventKey?T=-1:(O.children||[]).length&&k.includes(a)?c({dragNode:A,dropNode:_,dropPosition:0})?T=0:U=!1:L===0?v>-1.5?c({dragNode:A,dropNode:_,dropPosition:1})?T=1:U=!1:c({dragNode:A,dropNode:_,dropPosition:0})?T=0:c({dragNode:A,dropNode:_,dropPosition:1})?T=1:U=!1:c({dragNode:A,dropNode:_,dropPosition:1})?T=1:U=!1,{dropPosition:T,dropLevelOffset:L,dropTargetKey:y.key,dropTargetPos:y.pos,dragOverNodeKey:a,dropContainerKey:T===0?null:((l=y.parent)===null||l===void 0?void 0:l.key)||null,dropAllowed:U}}function Xe(i,r){if(i){var g=r.multiple;return g?i.slice():i.length?[i[0]]:i}}function Ae(i){if(!i)return null;var r;if(Array.isArray(i))r={checkedKeys:i,halfCheckedKeys:void 0};else if(at(i)==="object")r={checkedKeys:i.checked||void 0,halfCheckedKeys:i.halfChecked||void 0};else return Se(!1,"`checkedKeys` is not an array or an object"),null;return r}function ze(i,r){var g=new Set;function e(d){if(!g.has(d)){var c=j(r,d);if(c){g.add(d);var C=c.parent,t=c.node;t.disabled||C&&e(C.key)}}}return(i||[]).forEach(function(d){e(d)}),Ue(g)}var Et=function(r){var g=r.dropPosition,e=r.dropLevelOffset,d=r.indent,c={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(g){case-1:c.top=0,c.left=-e*d;break;case 1:c.bottom=0,c.left=-e*d;break;case 0:c.bottom=0,c.left=d;break}return w.createElement("div",{style:c})};function ot(i){if(i==null)throw new TypeError("Cannot destructure "+i)}function bt(i,r){var g=b.useState(!1),e=ne(g,2),d=e[0],c=e[1];Me(function(){if(d)return i(),function(){r()}},[d]),Me(function(){return c(!0),function(){c(!1)}},[])}var Dt=["className","style","motion","motionNodes","motionType","onMotionStart","onMotionEnd","active","treeNodeRequiredProps"],St=b.forwardRef(function(i,r){var g=i.className,e=i.style,d=i.motion,c=i.motionNodes,C=i.motionType,t=i.onMotionStart,o=i.onMotionEnd,n=i.active,l=i.treeNodeRequiredProps,f=Be(i,Dt),m=b.useState(!0),h=ne(m,2),p=h[0],x=h[1],s=b.useContext(Fe),v=s.prefixCls,k=c&&C!=="hide";Me(function(){c&&k!==p&&x(k)},[c]);var y=function(){c&&t()},N=b.useRef(!1),E=function(){c&&!N.current&&(N.current=!0,o())};bt(y,E);var P=function(O){k===O&&E()};return c?b.createElement(lt,se({ref:r,visible:p},d,{motionAppear:C==="show",onVisibleChanged:P}),function(S,O){var a=S.className,T=S.style;return b.createElement("div",{ref:O,className:Y("".concat(v,"-treenode-motion"),a),style:T},c.map(function(L){var I=Object.assign({},(ot(L.data),L.data)),A=L.title,_=L.key,U=L.isStart,$=L.isEnd;delete I.children;var B=Pe(_,l);return b.createElement(we,se({},I,B,{title:A,active:n,data:L.data,key:_,isStart:U,isEnd:$}))}))}):b.createElement(we,se({domRef:r,className:g,style:e},f,{active:n}))});function Pt(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=i.length,e=r.length;if(Math.abs(g-e)!==1)return{add:!1,key:null};function d(c,C){var t=new Map;c.forEach(function(n){t.set(n,!0)});var o=C.filter(function(n){return!t.has(n)});return o.length===1?o[0]:null}return g<e?{add:!0,key:d(i,r)}:{add:!1,key:d(r,i)}}function Ze(i,r,g){var e=i.findIndex(function(t){return t.key===g}),d=i[e+1],c=r.findIndex(function(t){return t.key===g});if(d){var C=r.findIndex(function(t){return t.key===d.key});return r.slice(c+1,C)}return r.slice(c+1)}var Ot=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","scrollWidth","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],Je={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Tt=function(){},ce="RC_TREE_MOTION_".concat(Math.random()),We={key:ce},it={key:ce,level:0,index:0,pos:"0",node:We,nodes:[We]},Qe={parent:null,children:[],pos:it.pos,data:We,title:null,key:ce,isStart:[],isEnd:[]};function et(i,r,g,e){return r===!1||!g?i:i.slice(0,Math.ceil(g/e)+1)}function tt(i){var r=i.key,g=i.pos;return rt(r,g)}function Mt(i){for(var r=String(i.data.key),g=i;g.parent;)g=g.parent,r="".concat(g.data.key," > ").concat(r);return r}var wt=b.forwardRef(function(i,r){var g=i.prefixCls,e=i.data;i.selectable,i.checkable;var d=i.expandedKeys,c=i.selectedKeys,C=i.checkedKeys,t=i.loadedKeys,o=i.loadingKeys,n=i.halfCheckedKeys,l=i.keyEntities,f=i.disabled,m=i.dragging,h=i.dragOverNodeKey,p=i.dropPosition,x=i.motion,s=i.height,v=i.itemHeight,k=i.virtual,y=i.scrollWidth,N=i.focusable,E=i.activeItem,P=i.focused,S=i.tabIndex,O=i.onKeyDown,a=i.onFocus,T=i.onBlur,L=i.onActiveChange,I=i.onListChangeStart,A=i.onListChangeEnd,_=Be(i,Ot),U=b.useRef(null),$=b.useRef(null);b.useImperativeHandle(r,function(){return{scrollTo:function(G){U.current.scrollTo(G)},getIndentWidth:function(){return $.current.offsetWidth}}});var B=b.useState(d),ue=ne(B,2),fe=ue[0],Ne=ue[1],ve=b.useState(e),ae=ne(ve,2),q=ae[0],re=ae[1],ge=b.useState(e),F=ne(ge,2),ke=F[0],Z=F[1],Ce=b.useState([]),ye=ne(Ce,2),J=ye[0],oe=ye[1],Le=b.useState(null),he=ne(Le,2),Q=he[0],xe=he[1],Ee=b.useRef(e);Ee.current=e;function be(){var R=Ee.current;re(R),Z(R),oe([]),xe(null),A()}Me(function(){Ne(d);var R=Pt(fe,d);if(R.key!==null)if(R.add){var G=q.findIndex(function(ee){var le=ee.key;return le===R.key}),X=et(Ze(q,e,R.key),k,s,v),pe=q.slice();pe.splice(G+1,0,Qe),Z(pe),oe(X),xe("show")}else{var de=e.findIndex(function(ee){var le=ee.key;return le===R.key}),De=et(Ze(e,q,R.key),k,s,v),Ke=e.slice();Ke.splice(de+1,0,Qe),Z(Ke),oe(De),xe("hide")}else q!==e&&(re(e),Z(e))},[d,e]),b.useEffect(function(){m||be()},[m]);var Re=x?ke:e,ie={expandedKeys:d,selectedKeys:c,loadedKeys:t,loadingKeys:o,checkedKeys:C,halfCheckedKeys:n,dragOverNodeKey:h,dropPosition:p,keyEntities:l};return b.createElement(b.Fragment,null,P&&E&&b.createElement("span",{style:Je,"aria-live":"assertive"},Mt(E)),b.createElement("div",null,b.createElement("input",{style:Je,disabled:N===!1||f,tabIndex:N!==!1?S:null,onKeyDown:O,onFocus:a,onBlur:T,value:"",onChange:Tt,"aria-label":"for screen reader"})),b.createElement("div",{className:"".concat(g,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},b.createElement("div",{className:"".concat(g,"-indent")},b.createElement("div",{ref:$,className:"".concat(g,"-indent-unit")}))),b.createElement(vt,se({},_,{data:Re,itemKey:tt,height:s,fullHeight:!1,virtual:k,itemHeight:v,scrollWidth:y,prefixCls:"".concat(g,"-list"),ref:U,role:"tree",onVisibleChange:function(G){G.every(function(X){return tt(X)!==ce})&&be()}}),function(R){var G=R.pos,X=Object.assign({},(ot(R.data),R.data)),pe=R.title,de=R.key,De=R.isStart,Ke=R.isEnd,ee=rt(de,G);delete X.key,delete X.children;var le=Pe(ee,ie);return b.createElement(St,se({},X,le,{title:pe,active:!!E&&de===E.key,pos:G,data:R.data,isStart:De,isEnd:Ke,motion:x,motionNodes:de===ce?J:null,motionType:Q,onMotionStart:I,onMotionEnd:be,treeNodeRequiredProps:ie,onMouseMove:function(){L(null)}}))}))}),Lt=10,dt=function(i){st(g,i);var r=ct(g);function g(){var e;ut(this,g);for(var d=arguments.length,c=new Array(d),C=0;C<d;C++)c[C]=arguments[C];return e=r.call.apply(r,[this].concat(c)),u(D(e),"destroyed",!1),u(D(e),"delayedDragEnterLogic",void 0),u(D(e),"loadingRetryTimes",{}),u(D(e),"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:qe()}),u(D(e),"dragStartMousePosition",null),u(D(e),"dragNodeProps",null),u(D(e),"currentMouseOverDroppableNodeKey",null),u(D(e),"listRef",b.createRef()),u(D(e),"onNodeDragStart",function(t,o){var n=e.state,l=n.expandedKeys,f=n.keyEntities,m=e.props.onDragStart,h=o.eventKey;e.dragNodeProps=o,e.dragStartMousePosition={x:t.clientX,y:t.clientY};var p=z(l,h);e.setState({draggingNodeKey:h,dragChildrenKeys:kt(h,f),indent:e.listRef.current.getIndentWidth()}),e.setExpandedKeys(p),window.addEventListener("dragend",e.onWindowDragEnd),m==null||m({event:t,node:W(o)})}),u(D(e),"onNodeDragEnter",function(t,o){var n=e.state,l=n.expandedKeys,f=n.keyEntities,m=n.dragChildrenKeys,h=n.flattenNodes,p=n.indent,x=e.props,s=x.onDragEnter,v=x.onExpand,k=x.allowDrop,y=x.direction,N=o.pos,E=o.eventKey;if(e.currentMouseOverDroppableNodeKey!==E&&(e.currentMouseOverDroppableNodeKey=E),!e.dragNodeProps){e.resetDragState();return}var P=Ye(t,e.dragNodeProps,o,p,e.dragStartMousePosition,k,h,f,l,y),S=P.dropPosition,O=P.dropLevelOffset,a=P.dropTargetKey,T=P.dropContainerKey,L=P.dropTargetPos,I=P.dropAllowed,A=P.dragOverNodeKey;if(m.includes(a)||!I){e.resetDragState();return}if(e.delayedDragEnterLogic||(e.delayedDragEnterLogic={}),Object.keys(e.delayedDragEnterLogic).forEach(function(_){clearTimeout(e.delayedDragEnterLogic[_])}),e.dragNodeProps.eventKey!==o.eventKey&&(t.persist(),e.delayedDragEnterLogic[N]=window.setTimeout(function(){if(e.state.draggingNodeKey!==null){var _=Ue(l),U=j(f,o.eventKey);U&&(U.children||[]).length&&(_=te(l,o.eventKey)),e.props.hasOwnProperty("expandedKeys")||e.setExpandedKeys(_),v==null||v(_,{node:W(o),expanded:!0,nativeEvent:t.nativeEvent})}},800)),e.dragNodeProps.eventKey===a&&O===0){e.resetDragState();return}e.setState({dragOverNodeKey:A,dropPosition:S,dropLevelOffset:O,dropTargetKey:a,dropContainerKey:T,dropTargetPos:L,dropAllowed:I}),s==null||s({event:t,node:W(o),expandedKeys:l})}),u(D(e),"onNodeDragOver",function(t,o){var n=e.state,l=n.dragChildrenKeys,f=n.flattenNodes,m=n.keyEntities,h=n.expandedKeys,p=n.indent,x=e.props,s=x.onDragOver,v=x.allowDrop,k=x.direction;if(e.dragNodeProps){var y=Ye(t,e.dragNodeProps,o,p,e.dragStartMousePosition,v,f,m,h,k),N=y.dropPosition,E=y.dropLevelOffset,P=y.dropTargetKey,S=y.dropContainerKey,O=y.dropTargetPos,a=y.dropAllowed,T=y.dragOverNodeKey;l.includes(P)||!a||(e.dragNodeProps.eventKey===P&&E===0?e.state.dropPosition===null&&e.state.dropLevelOffset===null&&e.state.dropTargetKey===null&&e.state.dropContainerKey===null&&e.state.dropTargetPos===null&&e.state.dropAllowed===!1&&e.state.dragOverNodeKey===null||e.resetDragState():N===e.state.dropPosition&&E===e.state.dropLevelOffset&&P===e.state.dropTargetKey&&S===e.state.dropContainerKey&&O===e.state.dropTargetPos&&a===e.state.dropAllowed&&T===e.state.dragOverNodeKey||e.setState({dropPosition:N,dropLevelOffset:E,dropTargetKey:P,dropContainerKey:S,dropTargetPos:O,dropAllowed:a,dragOverNodeKey:T}),s==null||s({event:t,node:W(o)}))}}),u(D(e),"onNodeDragLeave",function(t,o){e.currentMouseOverDroppableNodeKey===o.eventKey&&!t.currentTarget.contains(t.relatedTarget)&&(e.resetDragState(),e.currentMouseOverDroppableNodeKey=null);var n=e.props.onDragLeave;n==null||n({event:t,node:W(o)})}),u(D(e),"onWindowDragEnd",function(t){e.onNodeDragEnd(t,null,!0),window.removeEventListener("dragend",e.onWindowDragEnd)}),u(D(e),"onNodeDragEnd",function(t,o){var n=e.props.onDragEnd;e.setState({dragOverNodeKey:null}),e.cleanDragState(),n==null||n({event:t,node:W(o)}),e.dragNodeProps=null,window.removeEventListener("dragend",e.onWindowDragEnd)}),u(D(e),"onNodeDrop",function(t,o){var n,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=e.state,m=f.dragChildrenKeys,h=f.dropPosition,p=f.dropTargetKey,x=f.dropTargetPos,s=f.dropAllowed;if(s){var v=e.props.onDrop;if(e.setState({dragOverNodeKey:null}),e.cleanDragState(),p!==null){var k=H(H({},Pe(p,e.getTreeNodeRequiredProps())),{},{active:((n=e.getActiveItem())===null||n===void 0?void 0:n.key)===p,data:j(e.state.keyEntities,p).node}),y=m.includes(p);Se(!y,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");var N=He(x),E={event:t,node:W(k),dragNode:e.dragNodeProps?W(e.dragNodeProps):null,dragNodesKeys:[e.dragNodeProps.eventKey].concat(m),dropToGap:h!==0,dropPosition:h+Number(N[N.length-1])};l||v==null||v(E),e.dragNodeProps=null}}}),u(D(e),"cleanDragState",function(){var t=e.state.draggingNodeKey;t!==null&&e.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),e.dragStartMousePosition=null,e.currentMouseOverDroppableNodeKey=null}),u(D(e),"triggerExpandActionExpand",function(t,o){var n=e.state,l=n.expandedKeys,f=n.flattenNodes,m=o.expanded,h=o.key,p=o.isLeaf;if(!(p||t.shiftKey||t.metaKey||t.ctrlKey)){var x=f.filter(function(v){return v.key===h})[0],s=W(H(H({},Pe(h,e.getTreeNodeRequiredProps())),{},{data:x.data}));e.setExpandedKeys(m?z(l,h):te(l,h)),e.onNodeExpand(t,s)}}),u(D(e),"onNodeClick",function(t,o){var n=e.props,l=n.onClick,f=n.expandAction;f==="click"&&e.triggerExpandActionExpand(t,o),l==null||l(t,o)}),u(D(e),"onNodeDoubleClick",function(t,o){var n=e.props,l=n.onDoubleClick,f=n.expandAction;f==="doubleClick"&&e.triggerExpandActionExpand(t,o),l==null||l(t,o)}),u(D(e),"onNodeSelect",function(t,o){var n=e.state.selectedKeys,l=e.state,f=l.keyEntities,m=l.fieldNames,h=e.props,p=h.onSelect,x=h.multiple,s=o.selected,v=o[m.key],k=!s;k?x?n=te(n,v):n=[v]:n=z(n,v);var y=n.map(function(N){var E=j(f,N);return E?E.node:null}).filter(Boolean);e.setUncontrolledState({selectedKeys:n}),p==null||p(n,{event:"select",selected:k,node:o,selectedNodes:y,nativeEvent:t.nativeEvent})}),u(D(e),"onNodeCheck",function(t,o,n){var l=e.state,f=l.keyEntities,m=l.checkedKeys,h=l.halfCheckedKeys,p=e.props,x=p.checkStrictly,s=p.onCheck,v=o.key,k,y={event:"check",node:o,checked:n,nativeEvent:t.nativeEvent};if(x){var N=n?te(m,v):z(m,v),E=z(h,v);k={checked:N,halfChecked:E},y.checkedNodes=N.map(function(L){return j(f,L)}).filter(Boolean).map(function(L){return L.node}),e.setUncontrolledState({checkedKeys:N})}else{var P=Ie([].concat(Ue(m),[v]),!0,f),S=P.checkedKeys,O=P.halfCheckedKeys;if(!n){var a=new Set(S);a.delete(v);var T=Ie(Array.from(a),{checked:!1,halfCheckedKeys:O},f);S=T.checkedKeys,O=T.halfCheckedKeys}k=S,y.checkedNodes=[],y.checkedNodesPositions=[],y.halfCheckedKeys=O,S.forEach(function(L){var I=j(f,L);if(I){var A=I.node,_=I.pos;y.checkedNodes.push(A),y.checkedNodesPositions.push({node:A,pos:_})}}),e.setUncontrolledState({checkedKeys:S},!1,{halfCheckedKeys:O})}s==null||s(k,y)}),u(D(e),"onNodeLoad",function(t){var o,n=t.key,l=e.state.keyEntities,f=j(l,n);if(!(f!=null&&(o=f.children)!==null&&o!==void 0&&o.length)){var m=new Promise(function(h,p){e.setState(function(x){var s=x.loadedKeys,v=s===void 0?[]:s,k=x.loadingKeys,y=k===void 0?[]:k,N=e.props,E=N.loadData,P=N.onLoad;if(!E||v.includes(n)||y.includes(n))return null;var S=E(t);return S.then(function(){var O=e.state.loadedKeys,a=te(O,n);P==null||P(a,{event:"load",node:t}),e.setUncontrolledState({loadedKeys:a}),e.setState(function(T){return{loadingKeys:z(T.loadingKeys,n)}}),h()}).catch(function(O){if(e.setState(function(T){return{loadingKeys:z(T.loadingKeys,n)}}),e.loadingRetryTimes[n]=(e.loadingRetryTimes[n]||0)+1,e.loadingRetryTimes[n]>=Lt){var a=e.state.loadedKeys;Se(!1,"Retry for `loadData` many times but still failed. No more retry."),e.setUncontrolledState({loadedKeys:te(a,n)}),h()}p(O)}),{loadingKeys:te(y,n)}})});return m.catch(function(){}),m}}),u(D(e),"onNodeMouseEnter",function(t,o){var n=e.props.onMouseEnter;n==null||n({event:t,node:o})}),u(D(e),"onNodeMouseLeave",function(t,o){var n=e.props.onMouseLeave;n==null||n({event:t,node:o})}),u(D(e),"onNodeContextMenu",function(t,o){var n=e.props.onRightClick;n&&(t.preventDefault(),n({event:t,node:o}))}),u(D(e),"onFocus",function(){var t=e.props.onFocus;e.setState({focused:!0});for(var o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];t==null||t.apply(void 0,n)}),u(D(e),"onBlur",function(){var t=e.props.onBlur;e.setState({focused:!1}),e.onActiveChange(null);for(var o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];t==null||t.apply(void 0,n)}),u(D(e),"getTreeNodeRequiredProps",function(){var t=e.state,o=t.expandedKeys,n=t.selectedKeys,l=t.loadedKeys,f=t.loadingKeys,m=t.checkedKeys,h=t.halfCheckedKeys,p=t.dragOverNodeKey,x=t.dropPosition,s=t.keyEntities;return{expandedKeys:o||[],selectedKeys:n||[],loadedKeys:l||[],loadingKeys:f||[],checkedKeys:m||[],halfCheckedKeys:h||[],dragOverNodeKey:p,dropPosition:x,keyEntities:s}}),u(D(e),"setExpandedKeys",function(t){var o=e.state,n=o.treeData,l=o.fieldNames,f=$e(n,t,l);e.setUncontrolledState({expandedKeys:t,flattenNodes:f},!0)}),u(D(e),"onNodeExpand",function(t,o){var n=e.state.expandedKeys,l=e.state,f=l.listChanging,m=l.fieldNames,h=e.props,p=h.onExpand,x=h.loadData,s=o.expanded,v=o[m.key];if(!f){var k=n.includes(v),y=!s;if(Se(s&&k||!s&&!k,"Expand state not sync with index check"),n=y?te(n,v):z(n,v),e.setExpandedKeys(n),p==null||p(n,{node:o,expanded:y,nativeEvent:t.nativeEvent}),y&&x){var N=e.onNodeLoad(o);N&&N.then(function(){var E=$e(e.state.treeData,n,m);e.setUncontrolledState({flattenNodes:E})}).catch(function(){var E=e.state.expandedKeys,P=z(E,v);e.setExpandedKeys(P)})}}}),u(D(e),"onListChangeStart",function(){e.setUncontrolledState({listChanging:!0})}),u(D(e),"onListChangeEnd",function(){setTimeout(function(){e.setUncontrolledState({listChanging:!1})})}),u(D(e),"onActiveChange",function(t){var o=e.state.activeKey,n=e.props,l=n.onActiveChange,f=n.itemScrollOffset,m=f===void 0?0:f;o!==t&&(e.setState({activeKey:t}),t!==null&&e.scrollTo({key:t,offset:m}),l==null||l(t))}),u(D(e),"getActiveItem",function(){var t=e.state,o=t.activeKey,n=t.flattenNodes;return o===null?null:n.find(function(l){var f=l.key;return f===o})||null}),u(D(e),"offsetActiveKey",function(t){var o=e.state,n=o.flattenNodes,l=o.activeKey,f=n.findIndex(function(p){var x=p.key;return x===l});f===-1&&t<0&&(f=n.length),f=(f+t+n.length)%n.length;var m=n[f];if(m){var h=m.key;e.onActiveChange(h)}else e.onActiveChange(null)}),u(D(e),"onKeyDown",function(t){var o=e.state,n=o.activeKey,l=o.expandedKeys,f=o.checkedKeys,m=o.fieldNames,h=e.props,p=h.onKeyDown,x=h.checkable,s=h.selectable;switch(t.which){case me.UP:{e.offsetActiveKey(-1),t.preventDefault();break}case me.DOWN:{e.offsetActiveKey(1),t.preventDefault();break}}var v=e.getActiveItem();if(v&&v.data){var k=e.getTreeNodeRequiredProps(),y=v.data.isLeaf===!1||!!(v.data[m.children]||[]).length,N=W(H(H({},Pe(n,k)),{},{data:v.data,active:!0}));switch(t.which){case me.LEFT:{y&&l.includes(n)?e.onNodeExpand({},N):v.parent&&e.onActiveChange(v.parent.key),t.preventDefault();break}case me.RIGHT:{y&&!l.includes(n)?e.onNodeExpand({},N):v.children&&v.children.length&&e.onActiveChange(v.children[0].key),t.preventDefault();break}case me.ENTER:case me.SPACE:{x&&!N.disabled&&N.checkable!==!1&&!N.disableCheckbox?e.onNodeCheck({},N,!f.includes(n)):!x&&s&&!N.disabled&&N.selectable!==!1&&e.onNodeSelect({},N);break}}}p==null||p(t)}),u(D(e),"setUncontrolledState",function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!e.destroyed){var l=!1,f=!0,m={};Object.keys(t).forEach(function(h){if(e.props.hasOwnProperty(h)){f=!1;return}l=!0,m[h]=t[h]}),l&&(!o||f)&&e.setState(H(H({},m),n))}}),u(D(e),"scrollTo",function(t){e.listRef.current.scrollTo(t)}),e}return ft(g,[{key:"componentDidMount",value:function(){this.destroyed=!1,this.onUpdated()}},{key:"componentDidUpdate",value:function(){this.onUpdated()}},{key:"onUpdated",value:function(){var d=this.props,c=d.activeKey,C=d.itemScrollOffset,t=C===void 0?0:C;c!==void 0&&c!==this.state.activeKey&&(this.setState({activeKey:c}),c!==null&&this.scrollTo({key:c,offset:t}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}},{key:"resetDragState",value:function(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}},{key:"render",value:function(){var d=this.state,c=d.focused,C=d.flattenNodes,t=d.keyEntities,o=d.draggingNodeKey,n=d.activeKey,l=d.dropLevelOffset,f=d.dropContainerKey,m=d.dropTargetKey,h=d.dropPosition,p=d.dragOverNodeKey,x=d.indent,s=this.props,v=s.prefixCls,k=s.className,y=s.style,N=s.showLine,E=s.focusable,P=s.tabIndex,S=P===void 0?0:P,O=s.selectable,a=s.showIcon,T=s.icon,L=s.switcherIcon,I=s.draggable,A=s.checkable,_=s.checkStrictly,U=s.disabled,$=s.motion,B=s.loadData,ue=s.filterTreeNode,fe=s.height,Ne=s.itemHeight,ve=s.scrollWidth,ae=s.virtual,q=s.titleRender,re=s.dropIndicatorRender,ge=s.onContextMenu,F=s.onScroll,ke=s.direction,Z=s.rootClassName,Ce=s.rootStyle,ye=nt(this.props,{aria:!0,data:!0}),J;I&&(at(I)==="object"?J=I:typeof I=="function"?J={nodeDraggable:I}:J={});var oe={prefixCls:v,selectable:O,showIcon:a,icon:T,switcherIcon:L,draggable:J,draggingNodeKey:o,checkable:A,checkStrictly:_,disabled:U,keyEntities:t,dropLevelOffset:l,dropContainerKey:f,dropTargetKey:m,dropPosition:h,dragOverNodeKey:p,indent:x,direction:ke,dropIndicatorRender:re,loadData:B,filterTreeNode:ue,titleRender:q,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop};return b.createElement(Fe.Provider,{value:oe},b.createElement("div",{className:Y(v,k,Z,u(u(u({},"".concat(v,"-show-line"),N),"".concat(v,"-focused"),c),"".concat(v,"-active-focused"),n!==null)),style:Ce},b.createElement(wt,se({ref:this.listRef,prefixCls:v,style:y,data:C,disabled:U,selectable:O,checkable:!!A,motion:$,dragging:o!==null,height:fe,itemHeight:Ne,virtual:ae,focusable:E,focused:c,tabIndex:S,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:ge,onScroll:F,scrollWidth:ve},this.getTreeNodeRequiredProps(),ye))))}}],[{key:"getDerivedStateFromProps",value:function(d,c){var C=c.prevProps,t={prevProps:d};function o(S){return!C&&d.hasOwnProperty(S)||C&&C[S]!==d[S]}var n,l=c.fieldNames;if(o("fieldNames")&&(l=qe(d.fieldNames),t.fieldNames=l),o("treeData")?n=d.treeData:o("children")&&(Se(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),n=gt(d.children)),n){t.treeData=n;var f=yt(n,{fieldNames:l});t.keyEntities=H(u({},ce,it),f.keyEntities)}var m=t.keyEntities||c.keyEntities;if(o("expandedKeys")||C&&o("autoExpandParent"))t.expandedKeys=d.autoExpandParent||!C&&d.defaultExpandParent?ze(d.expandedKeys,m):d.expandedKeys;else if(!C&&d.defaultExpandAll){var h=H({},m);delete h[ce];var p=[];Object.keys(h).forEach(function(S){var O=h[S];O.children&&O.children.length&&p.push(O.key)}),t.expandedKeys=p}else!C&&d.defaultExpandedKeys&&(t.expandedKeys=d.autoExpandParent||d.defaultExpandParent?ze(d.defaultExpandedKeys,m):d.defaultExpandedKeys);if(t.expandedKeys||delete t.expandedKeys,n||t.expandedKeys){var x=$e(n||c.treeData,t.expandedKeys||c.expandedKeys,l);t.flattenNodes=x}if(d.selectable&&(o("selectedKeys")?t.selectedKeys=Xe(d.selectedKeys,d):!C&&d.defaultSelectedKeys&&(t.selectedKeys=Xe(d.defaultSelectedKeys,d))),d.checkable){var s;if(o("checkedKeys")?s=Ae(d.checkedKeys)||{}:!C&&d.defaultCheckedKeys?s=Ae(d.defaultCheckedKeys)||{}:n&&(s=Ae(d.checkedKeys)||{checkedKeys:c.checkedKeys,halfCheckedKeys:c.halfCheckedKeys}),s){var v=s,k=v.checkedKeys,y=k===void 0?[]:k,N=v.halfCheckedKeys,E=N===void 0?[]:N;if(!d.checkStrictly){var P=Ie(y,!0,m);y=P.checkedKeys,E=P.halfCheckedKeys}t.checkedKeys=y,t.halfCheckedKeys=E}}return o("loadedKeys")&&(t.loadedKeys=d.loadedKeys),t}}]),g}(b.Component);u(dt,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:Et,allowDrop:function(){return!0},expandAction:!1});u(dt,"TreeNode",we);export{dt as T,ht as U,ot as _,we as a,z as b,ze as c,te as d};
//# sourceMappingURL=Tree-db5072ad.js.map
