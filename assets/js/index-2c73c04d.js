import{r as c,j as e}from"./react-12b51ca5.js";import{h as O,P as U,I as ie}from"./index-f498645e.js";import{F as x,d as le,e as re,B as v,j as se,g as N,I as R,D as $,Y as z,f as ae,S as V,c as oe,H as ne,b as Y,m as K,_ as M}from"./antd-e2492052.js";import{T as de}from"./index-4f14ea2b.js";import{r as me}from"./roleManage-7c666564.js";import ce from"./UserFormModal-48231c75.js";import{a1 as pe}from"./@ant-design-63539318.js";import"./react-redux-814b67d1.js";import"./react-dom-e71a48dd.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./use-sync-external-store-ad55a9d4.js";import"./@reduxjs-1e85e38e.js";import"./immer-41fd5235.js";import"./redux-9b50431e.js";import"./@babel-c46ce09a.js";import"./redux-thunk-5e43a849.js";import"./redux-persist-0e7c8dbe.js";import"./react-router-dom-6ebba419.js";import"./react-router-0b469a74.js";import"./@remix-run-26f48157.js";import"./@react-three-892cc760.js";import"./three-61b4c2af.js";import"./react-use-measure-3cc199c6.js";import"./debounce-3dd95b19.js";import"./its-fine-c588097f.js";import"./react-reconciler-70247064.js";import"./scheduler-765c72db.js";import"./react-merge-refs-239dbb3c.js";import"./zustand-942b6941.js";import"./react-i18next-172d1bb0.js";import"./axios-a342f982.js";import"./nprogress-ac7b4ba8.js";import"./antd-img-crop-c6426bab.js";import"./tslib-9305e412.js";import"./react-easy-crop-57e783c5.js";import"./normalize-wheel-e63deb77.js";import"./compare-versions-d85a82c7.js";import"./ahooks-2e5c1fd5.js";import"./lodash-40f09dbd.js";import"./dayjs-6d610299.js";import"./screenfull-d32598f8.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./@dnd-kit-908a095e.js";import"./react-transition-group-7a2d7ec0.js";import"./dom-helpers-9a525042.js";import"./react-colorful-c5c19197.js";import"./qs-7f9cc4dd.js";import"./side-channel-fd57f060.js";import"./get-intrinsic-369a924f.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-ebb1c907.js";import"./set-function-length-e011fe34.js";import"./define-data-property-10275fa5.js";import"./es-define-property-d670c2ca.js";import"./gopd-7cdb7e9d.js";import"./has-property-descriptors-3e3c0959.js";import"./object-inspect-17338ea2.js";import"./crypto-js-31e0a020.js";import"./md5-1d85d820.js";import"./crypt-5ea4a8e1.js";import"./charenc-bfd911d6.js";import"./is-buffer-793dba8c.js";import"./i18next-5484cd5c.js";import"./rc-util-8976b5fa.js";import"./classnames-3ded05b8.js";import"./rc-resize-observer-5c9960e4.js";import"./rc-motion-25d44171.js";import"./rc-notification-3ca02e51.js";import"./rc-overflow-7fc9dc70.js";import"./rc-picker-d202c760.js";import"./@rc-component-60bdd203.js";import"./@ctrl-bad846bd.js";import"./rc-tabs-f080ce12.js";import"./rc-dropdown-1fd4539e.js";import"./rc-menu-c99c3faa.js";import"./rc-cascader-238c5b8d.js";import"./rc-select-8e380119.js";import"./rc-virtual-list-5b0902fa.js";import"./rc-tree-898f7873.js";import"./rc-input-number-f64f90f1.js";import"./rc-input-3682369a.js";import"./rc-collapse-3e02f0e2.js";import"./rc-drawer-9ef263c4.js";import"./rc-field-form-e46b50c8.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-582d6ca4.js";import"./compute-scroll-into-view-e3f0ecc2.js";import"./rc-image-3cfe7923.js";import"./rc-dialog-8eb1683d.js";import"./rc-mentions-9823f19c.js";import"./rc-textarea-b098f88a.js";import"./rc-tooltip-01b6b839.js";import"./qrcode.react-e22f0a27.js";import"./rc-rate-2d3465a8.js";import"./rc-segmented-6536d122.js";import"./rc-slider-e91f05e6.js";import"./rc-steps-f39c48c2.js";import"./rc-switch-8d316ace.js";import"./rc-table-a211065a.js";import"./rc-checkbox-ae7b2d99.js";import"./throttle-debounce-87e7e444.js";import"./rc-pagination-334fefa5.js";import"./rc-tree-select-5a273e06.js";import"./copy-to-clipboard-47a2b094.js";import"./toggle-selection-93f4ad84.js";import"./rc-upload-71d17dfe.js";import"./rc-progress-a416f280.js";import"./mathjs-5ee3c32f.js";import"./typed-function-de33f2d8.js";import"./tiny-emitter-8a086d5b.js";import"./decimal.js-d133ee8e.js";import"./complex.js-357570ec.js";import"./fraction.js-56a7d603.js";import"./seedrandom-8945c5a8.js";import"./javascript-natural-sort-a3c448fd.js";import"./escape-latex-29d85c0d.js";import"./@umijs-02c6bdf5.js";import"./swr-1237c4b3.js";import"./omit.js-929edb61.js";import"./lodash.merge-9922d51b.js";import"./safe-stable-stringify-023075f7.js";import"./@chenshuai2144-5a33ccd2.js";import"./reactcss-f166c0a9.js";import"./tinycolor2-ea5bcbb6.js";import"./lodash.tonumber-b59040d8.js";import"./@emotion-70f0a3ab.js";import"./stylis-d04dd720.js";const ue=r=>O.get(U+"/user/manage/list",r),he=r=>O.post(U+"/user/manage/create",r),xe=r=>O.post(U+"/user/manage/edit",r);function _(r=[]){if(!r)return[];let n=[];return r.forEach(p=>{n.push(e.jsx(N.Option,{value:p.id,children:p.name},p.id))}),n}function A(r){if(!r)return"";const n=new Date(r),p=n.getMonth()<9?`0${n.getMonth()+1}`:n.getMonth()+1,s=n.getDate()<10?`0${n.getDate()}`:n.getDate();return`${n.getFullYear()}-${p}-${s}`}function fe(r){const{filterSubmit:n,multiForm:p}=r,[s,f]=c.useState(!1),w=()=>{let l=p.getFieldsValue();l.startTime&&(l.startTime=A(l.startTime)),l.endTime&&(l.endTime=A(l.endTime)),n&&n(l)},i=()=>{p.resetFields()},m=()=>{const{formList:l,extendFormList:a}=r;let d=[];return l&&l.length>0&&l.forEach((j,k)=>{const{label:u,field:y,tree:b,type:C,initialValue:S,placeholder:g,width:I,name:E}=j;switch(C){case"TIME":d.push(e.jsx(x.Item,{name:"startTime",label:"开始时间",children:e.jsx($,{style:I,showTime:!0,placeholder:g,format:"YYYY-MM-DD hh:mm:ss"})},"startTime"),e.jsx(x.Item,{label:"结束时间",name:"endTime",children:e.jsx($,{style:I,showTime:!0,placeholder:g,format:"YYYY-MM-DD hh:mm:ss"})},"endTime"));break;case"INPUT":d.push(e.jsx(x.Item,{name:y,label:u,children:e.jsx(R,{type:"text",style:{width:I},placeholder:g})},y));break;case"SELECT":d.push(e.jsx(x.Item,{name:y,label:u,children:e.jsx(N,{style:{width:I},placeholder:g,children:_(j.list)})},y));break;case"CHECKBOX":d.push(e.jsx(x.Item,{name:y,label:u,children:e.jsx(se,{children:u})},y));break}}),a&&a.length>0&&a.forEach(j=>{const{label:k,field:u,tree:y,type:b,initialValue:C,placeholder:S,width:g,name:I,style:E}=j;if(b==="INPUT"){const F=e.jsx(x.Item,{name:u,label:k,style:E,children:e.jsx(R,{type:"text",placeholder:S,style:{width:g}})},u);s===!0?d.push(F):d.push([])}else if(b==="SELECT"){const F=e.jsx(x.Item,{name:u,label:k,style:E,children:e.jsx(N,{style:{width:g},placeholder:S,children:_(j.list)})},u);s===!0?d.push(F):d.push([])}}),d};return e.jsx("div",{children:e.jsx(x,{layout:"inline",form:p,children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx(le,{style:{width:"calc(100% - 300px)"},gutter:[32,24],children:m().map((l,a)=>e.jsx(re,{span:8,children:l}))}),e.jsx("div",{style:{width:300,position:"fixed",right:0},children:e.jsxs(x.Item,{children:[e.jsx(v,{type:"primary",onClick:w,children:"查询"}),e.jsx(v,{className:"mx-3",onClick:i,children:"重置"}),e.jsx("a",{href:"javascript:;",onClick:()=>{f(!s)},children:r&&r.extendFormList&&r.extendFormList.length>0?s===!1?"展开":"收起":""})]})})]})})})}const je=[{type:"INPUT",label:"用户名",field:"user_name",placeholder:"请输入用户名",initialValue:"",width:200},{type:"INPUT",label:"联系地址",field:"address",placeholder:"请输入联系地址",initialValue:"",width:200},{type:"SELECT",label:"婚姻状态",field:"isMarried",placeholder:"全部",initialValue:"0",width:200,list:[{id:"0",name:"全部"},{id:"1",name:"未婚"},{id:"2",name:"已婚"}]},{type:"SELECT",label:"性别",field:"sex",placeholder:"全部",initialValue:3,width:200,list:[{id:3,name:"全部"},{id:0,name:"女"},{id:1,name:"男"}]}],ye=[{type:"TIME",width:200},{type:"INPUT",placeholder:"请输入电影名",width:200,label:"电影",field:"movies"},{type:"SELECT",placeholder:"请选择电影",width:200,label:"选择种类",field:"kinds1",name:"key",list:[{id:1,key:"泰坦尼克号"},{id:2,key:"阿凡达"},{id:3,key:"蜘蛛侠"}]}],ge=[{title:"物流状态(单)",key:"state",options:[{label:"全部",value:""},{label:"已下单",value:"1",icon:"ShoppingCartOutlined"},{label:"已发货",value:"2",icon:"CarOutlined"},{label:"已签收",value:"3",icon:"FormOutlined"},{label:"已退回",value:"4",icon:"CloseCircleOutlined"},{label:"已完成",value:"5",icon:"CheckSquareOutlined"}]},{title:"商品类型(多)",key:"type",multiple:!0,options:[{label:"全部",value:""},{label:"食品类",value:"1"},{label:"服装类",value:"2"},{label:"家具类",value:"3"},{label:"日用品类",value:"4"}]}];function Ie({data:r,defaultValue:n,selectChange:p}){const[s,f]=c.useState({});c.useEffect(()=>{r.forEach(i=>{i.multiple?f(m=>({...m,[i.key]:n[i.key]||[""]})):f(m=>({...m,[i.key]:n[i.key]||""}))})},[]);const w=(i,m)=>{if(!i.multiple)s[i.key]!==m.value&&f(l=>({...l,[i.key]:m.value}));else if(i.options[0].value===m.value&&f(l=>({...l,[i.key]:[m.value]})),s[i.key].includes(m.value)){let l=s[i.key].findIndex(a=>a===m.value);f(a=>({...a,[i.key]:s[i.key].filter(d=>d!==s[i.key].splice(l,1))}))}else f(l=>({...l,[i.key]:[...l[i.key],m.value]})),s[i.key].includes(i.options[0].value);p&&p(s)};return e.jsx("div",{className:"select-filter",children:r.map((i,m)=>{var l;return e.jsxs("div",{className:"select-filter-item",children:[e.jsx("div",{className:"select-filter-item-title",children:e.jsxs("span",{children:[i.title,"："]})}),e.jsx("div",{children:(l=i.options)!=null&&l.length?e.jsx("ul",{className:"select-filter-list",children:i.options.map((a,d)=>{const j=a.value===s[i.key],k=Array.isArray(s[i.key])&&s[i.key].includes(a.value);return e.jsxs("li",{className:`${j&&"active"||k&&"active"}`,onClick:()=>{w(i,a)},children:[a.icon&&e.jsx(ie,{name:a.icon}),e.jsx("span",{children:a.label})]},a.value)})}):e.jsx("span",{className:"select-filter-noData",children:"暂无数据"})})]},i.key)})})}const Bi=()=>{const[r,n]=c.useState({}),[p,s]=c.useState([]),[f,w]=c.useState(!1),[i,m]=c.useState([]),[l,a]=c.useState({page:1,pageSize:10,totalCount:0}),[d,j]=c.useState({selectedRowKeys:[],selectedIds:[],selectedItem:{}}),[k,u]=c.useState(!1),[y,b]=c.useState(""),[C,S]=c.useState(""),[g,I]=c.useState({}),[E,F]=c.useState({}),[B,H]=c.useState({state:"1",type:["1","3"]}),[P]=x.useForm(),[q]=x.useForm(),J=()=>{w(!0),setTimeout(()=>{const{page:t,pageSize:o}=l;let h={page:t,pageSize:o,...E};ue(h).then(T=>{w(!1);const D=T.data.list.map((ee,te)=>({...ee,key:te}));m(D.splice(0,o)),a({page:T.data.page,pageSize:T.data.page_size,totalCount:T.data.total_count})})},500)},X=()=>{me().then(t=>{let o=t.data.list;const h=o.reduce((T,D)=>(T[D.id]=D.role_name,T),{});n(h||[]),s(o)})};c.useEffect(()=>{J(),X()},[l.page,l.pageSize]);const G=[{title:"id",dataIndex:"id",width:80,fixed:"left"},{title:"用户名",dataIndex:"username",width:80,fixed:"left"},{title:"性别",dataIndex:"sex",render:t=>t===1?"男":"女"},{title:"状态",dataIndex:"state",render:t=>({1:e.jsx(M,{color:"green",children:"痛苦"}),2:e.jsx(M,{color:"blue",children:"委屈"}),3:e.jsx(M,{color:"orange",children:"迷茫"}),4:e.jsx(M,{color:"red",children:"平淡"}),5:e.jsx(M,{color:"purple",children:"开心"})})[t]},{title:"爱好",dataIndex:"interest",render:t=>({1:"游泳",2:"打篮球",3:"踢足球",4:"跑步",5:"爬山",6:"骑行",7:"桌球",8:"麦霸"})[t]},{title:"婚姻状态",dataIndex:"isMarried",render(t){return t?e.jsx(Y,{status:"success",text:"已婚"}):e.jsx(Y,{status:"error",text:"未婚"})}},{title:"所属角色",dataIndex:"role_id",render:t=>r[t]},{title:"手机号",render(){let h=(15303663375+"").replace(/(\d{3})\d*(\d{4})/g,"$1***$2");return e.jsx("span",{children:h})}},{title:"身份证号",render(){let h=(231085199811011415n+"").replace(/(\d{3})\d*(\d{4})/g,"$1***********$2");return e.jsx("span",{children:h})}},{title:"联系地址",dataIndex:"address"},{title:"邮箱",dataIndex:"email"},{title:"生日",dataIndex:"birthday"},{title:"早起时间",dataIndex:"time"},{title:"操作",fixed:"right",width:200,render(t){return e.jsxs(V,{children:[e.jsx(v,{size:"small",onClick:()=>{L("detail",t)},children:"详情"}),e.jsx(v,{size:"small",onClick:()=>{L("edit",t)},children:"编辑"}),e.jsx(v,{size:"small",onClick:()=>{L("delete",t)},children:"删除"})]})}}],L=(t,o)=>{t==="create"?(u(!0),b("新建用户"),S(t)):["edit","detail"].includes(t)?(b(t==="edit"?"编辑用户":"查看详情"),S(t),I(o),u(!0)):t==="delete"?K.success(`删除用户成功！ id：${o.id}`):t==="moreDelete"&&K.success(`删除更多用户成功！ id：${JSON.stringify(d.selectedIds)}`)},Q=()=>{let t=C,o=P.getFieldsValue();t==="create"?he(o):xe(o)},W=t=>{H(t)},Z=e.jsxs("div",{children:[e.jsx(z,{className:"mb20",style:{},children:e.jsx(ae,{defaultActiveKey:"1",centered:!0,items:[{label:"输入框查询",key:"1",children:e.jsx(fe,{multiForm:q,formList:je,extendFormList:ye,filterSubmit:(t={})=>{F(t)}})},{label:"选择框查询",key:"2",children:e.jsx(Ie,{data:ge,defaultValue:B,selectChange:W})}]})}),e.jsx(z,{className:"mb30",title:"用户列表",extra:e.jsxs(V,{size:"large",children:[e.jsx(v,{size:"middle",onClick:()=>{L("create",null)},children:"新建"}),e.jsx(oe,{title:"批量删除",description:"你确定要删除吗？",okText:"确定",cancelText:"取消",onConfirm:()=>{L("moreDelete",null)},children:e.jsx(v,{size:"middle",disabled:d.selectedRowKeys.length<=1,icon:e.jsx(pe,{}),children:"批量删除"})})]}),style:{width:"100%"},children:e.jsx(de,{rowSelection:"checkbox",columns:G,dataSource:i,pagination:l,selectedRowKeys:d.selectedRowKeys,selectedIds:d.selectedIds,selectedItem:d.selectedItem,updateSelectedItem:(t,o,h)=>{j({selectedRowKeys:t,selectedIds:h&&h.length>0?h:[],selectedRows:o})},updatePage:(t,o)=>{a(h=>({...h,page:t,pageSize:o}))},loading:f,id:"cart-scrollTable",xScroll:!0})}),e.jsx(ne,{width:800,title:y,open:k,onOk:Q,onCancel:()=>{b(""),u(!1),S(""),I({})},children:e.jsx(ce,{roles:p,userInfo:g,type:C,form:P})})]});return e.jsx(e.Fragment,{children:Z})};export{Bi as default};
