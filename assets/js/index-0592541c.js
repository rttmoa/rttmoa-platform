import{T as W,c as ee,a as te}from"./Tree-0072d5c0.js";import{d as g,q as Y,cX as ne,t as se,cY as oe,z as Z,c0 as F,r as f,c5 as re,cZ as ce,c_ as le}from"./index-f751f953.js";import{f as G,c as ae,a as ie}from"./conductUtil-242f4494.js";import{u as de,S as fe}from"./iconUtil-d0cad765.js";const z=4;function ue(n){const{dropPosition:c,dropLevelOffset:r,prefixCls:t,indent:s,direction:e="ltr"}=n,o=e==="ltr"?"left":"right",l=e==="ltr"?"right":"left",a={[o]:-r*s+z,[l]:0};switch(c){case-1:a.top=-3;break;case 1:a.bottom=-3;break;default:a.bottom=-3,a[o]=s+z;break}return g.createElement("div",{style:a,className:`${t}-drop-indicator`})}const pe=g.forwardRef((n,c)=>{var r;const{getPrefixCls:t,direction:s,virtual:e,tree:o}=g.useContext(Y),{prefixCls:l,className:a,showIcon:d=!1,showLine:v,switcherIcon:T,switcherLoadingIcon:S,blockNode:P=!1,children:k,checkable:O=!1,selectable:C=!0,draggable:b,motion:w,style:I}=n,y=t("tree",l),R=t(),N=w??Object.assign(Object.assign({},ne(R)),{motionAppear:!1}),$=Object.assign(Object.assign({},n),{checkable:O,selectable:C,showIcon:d,motion:N,blockNode:P,showLine:!!v,dropIndicatorRender:ue}),[x,u,h]=de(y),[,K]=se(),E=K.paddingXS/2+(((r=K.Tree)===null||r===void 0?void 0:r.titleHeight)||K.controlHeightSM),_=g.useMemo(()=>{if(!b)return!1;let i={};switch(typeof b){case"function":i.nodeDraggable=b;break;case"object":i=Object.assign({},b);break}return i.icon!==!1&&(i.icon=i.icon||g.createElement(oe,null)),i},[b]),p=i=>g.createElement(fe,{prefixCls:y,switcherIcon:T,switcherLoadingIcon:S,treeNodeProps:i,showLine:v});return x(g.createElement(W,Object.assign({itemHeight:E,ref:c,virtual:e},$,{style:Object.assign(Object.assign({},o==null?void 0:o.style),I),prefixCls:y,className:Z({[`${y}-icon-hide`]:!d,[`${y}-block-node`]:P,[`${y}-unselectable`]:!C,[`${y}-rtl`]:s==="rtl"},o==null?void 0:o.className,a,u,h),direction:s,checkable:O&&g.createElement("span",{className:`${y}-checkbox-inner`}),selectable:C,switcherIcon:p,draggable:_}),k))}),J=pe,V=0,A=1,X=2;function H(n,c,r){const{key:t,children:s}=r;function e(o){const l=o[t],a=o[s];c(l,o)!==!1&&H(a||[],c,r)}n.forEach(e)}function ye(n){let{treeData:c,expandedKeys:r,startKey:t,endKey:s,fieldNames:e}=n;const o=[];let l=V;if(t&&t===s)return[t];if(!t||!s)return[];function a(d){return d===t||d===s}return H(c,d=>{if(l===X)return!1;if(a(d)){if(o.push(d),l===V)l=A;else if(l===A)return l=X,!1}else l===A&&o.push(d);return r.includes(d)},G(e)),o}function L(n,c,r){const t=F(c),s=[];return H(n,(e,o)=>{const l=t.indexOf(e);return l!==-1&&(s.push(o),t.splice(l,1)),!!t.length},G(r)),s}var q=globalThis&&globalThis.__rest||function(n,c){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&c.indexOf(t)<0&&(r[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(n);s<t.length;s++)c.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(n,t[s])&&(r[t[s]]=n[t[s]]);return r};function me(n){const{isLeaf:c,expanded:r}=n;return c?f.createElement(re,null):r?f.createElement(ce,null):f.createElement(le,null)}function B(n){let{treeData:c,children:r}=n;return c||ie(r)}const xe=(n,c)=>{var{defaultExpandAll:r,defaultExpandParent:t,defaultExpandedKeys:s}=n,e=q(n,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const o=f.useRef(null),l=f.useRef(null),a=()=>{const{keyEntities:x}=ae(B(e));let u;return r?u=Object.keys(x):t?u=ee(e.expandedKeys||s||[],x):u=e.expandedKeys||s||[],u},[d,v]=f.useState(e.selectedKeys||e.defaultSelectedKeys||[]),[T,S]=f.useState(()=>a());f.useEffect(()=>{"selectedKeys"in e&&v(e.selectedKeys)},[e.selectedKeys]),f.useEffect(()=>{"expandedKeys"in e&&S(e.expandedKeys)},[e.expandedKeys]);const P=(x,u)=>{var h;return"expandedKeys"in e||S(x),(h=e.onExpand)===null||h===void 0?void 0:h.call(e,x,u)},k=(x,u)=>{var h;const{multiple:K,fieldNames:E}=e,{node:_,nativeEvent:p}=u,{key:i=""}=_,j=B(e),D=Object.assign(Object.assign({},u),{selected:!0}),Q=(p==null?void 0:p.ctrlKey)||(p==null?void 0:p.metaKey),U=p==null?void 0:p.shiftKey;let m;K&&Q?(m=x,o.current=i,l.current=m,D.selectedNodes=L(j,m,E)):K&&U?(m=Array.from(new Set([].concat(F(l.current||[]),F(ye({treeData:j,expandedKeys:T,startKey:i,endKey:o.current,fieldNames:E}))))),D.selectedNodes=L(j,m,E)):(m=[i],o.current=i,l.current=m,D.selectedNodes=L(j,m,E)),(h=e.onSelect)===null||h===void 0||h.call(e,m,D),"selectedKeys"in e||v(m)},{getPrefixCls:O,direction:C}=f.useContext(Y),{prefixCls:b,className:w,showIcon:I=!0,expandAction:y="click"}=e,R=q(e,["prefixCls","className","showIcon","expandAction"]),N=O("tree",b),$=Z(`${N}-directory`,{[`${N}-directory-rtl`]:C==="rtl"},w);return f.createElement(J,Object.assign({icon:me,ref:c,blockNode:!0},R,{showIcon:I,expandAction:y,prefixCls:N,className:$,expandedKeys:T,selectedKeys:d,onSelect:k,onExpand:P}))},he=f.forwardRef(xe),ge=he,M=J;M.DirectoryTree=ge;M.TreeNode=te;const Oe=M;export{Oe as T};
//# sourceMappingURL=index-0592541c.js.map
