import{r,j as t,U as $,m as p,B as m}from"./index-71b6a372.js";import{r as z,u as n,w as g}from"./xlsx-964ea548.js";/* empty css              */import j from"./config-0f658f1d.js";import{F as k}from"./FileSaver.min-c6588f23.js";import{S as _}from"./index-34e6ab0e.js";import{T as K}from"./Table-53609d1b.js";import"./Select-fb7362ba.js";import"./List-75516f59.js";import"./useShowArrow-667e4c44.js";import"./useIcons-bf3a3e6a.js";import"./index-d0216194.js";import"./styleChecker-aa1b55d9.js";import"./addEventListener-7a60baf3.js";import"./Tree-97dbcd96.js";import"./conductUtil-21ecc908.js";import"./useMultipleSelect-12441164.js";import"./Pagination-5ad47d73.js";import"./zh_CN-f51ae7db.js";import"./index-e661c40f.js";import"./index-5750ac36.js";import"./index-da5c860a.js";import"./useBubbleLock-e2b47f6f.js";import"./index-41f8be63.js";import"./index-821bd91b.js";import"./iconUtil-9bcaa615.js";import"./useLazyKVMap-79dc305d.js";const V=["序号","学科","项目名称","端","账号","密码"],we=()=>{const[d,q]=r.useState(j().dataSource),[T,u]=r.useState(!1),[E,v]=r.useState(""),[N,B]=r.useState([]),[x,f]=r.useState(""),[C,G]=r.useState(j().column),[b,D]=r.useState(),y=(e,s)=>{s||f(""),u(!0);const o=new FileReader;o.onload=l=>{const h=new Uint8Array(l.target.result),i=z(h,{type:"array"}),R=s?i.Sheets[s]:i.Sheets[i.SheetNames[0]],c=n.sheet_to_json(R,{header:1}),S=i.SheetNames.map(a=>({label:a,value:a})),H=c[0]||[],w=V.filter(a=>!H.includes(a));if(w.length>0)return p.error(`导入失败，缺少字段：${w.join("、")}`),!1;B(S),f(s||S[0].value),c.length>0?c.slice(1).forEach((a,J)=>{if(a.length===0)return!1;c[0].forEach((M,L)=>{a[L]})}):p.warning("表格无数据"),u(!1)},o.readAsArrayBuffer(e)},F=()=>{},U=e=>{b&&y(b,e)},A=()=>{const e=["序号","学科","项目名称","端","账号","密码"],s=n.aoa_to_sheet([e]),o=n.book_new();n.book_append_sheet(o,s,"Sheet1");const l=g(o,{bookType:"xlsx",type:"array"}),h=new Blob([l],{type:"application/octet-stream"});k.saveAs(h,"用户管理模板.xlsx")},I=()=>{if(!d.length)return p.warning("暂无数据可导出");const e=n.json_to_sheet(d),s=n.book_new();n.book_append_sheet(s,e,"Sheet1");const o=g(s,{bookType:"xlsx",type:"array"}),l=new Blob([o],{type:"application/octet-stream"});k.saveAs(l,"导出用户管理数据.xlsx")};return t.jsxs("div",{className:"TableDataImport bg-white p-[24px]",children:[t.jsxs("div",{className:"fileUpDiv mb-5",style:{marginTop:0,marginBottom:40},children:[t.jsx("span",{style:{marginRight:42},children:"文件名称"}),t.jsx("span",{className:"fileName",children:E}),t.jsx($,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(v(e.name),D(e),y(e),!1):(p.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:t.jsx(m,{children:"上传Excel文件"})}),t.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!x&&t.jsx(_,{disabled:!0,style:{width:120},options:[]}),x&&t.jsx(_,{defaultValue:x,style:{width:120},onChange:U,options:N}),t.jsx(m,{type:"primary",onClick:F,children:"导入表格数据"}),t.jsx(m,{type:"primary",onClick:A,children:"导出表格模板"}),t.jsx(m,{type:"primary",onClick:I,children:"导出表格数据"})]}),t.jsx(K,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:T,size:"small",dataSource:d,columns:C})]})};export{we as default};
//# sourceMappingURL=index copy-e97e4774.js.map
