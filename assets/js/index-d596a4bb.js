import{r as o,j as t,a2 as O,aA as V,B as D,ae as _}from"./index-6ab6cade.js";import{r as z,u as K}from"./xlsx-964ea548.js";import{S as N}from"./index-05e40cca.js";import{T as $}from"./Table-62c78325.js";import"./Select-74f8e578.js";import"./List-556d4d6b.js";import"./useShowArrow-628cd2bf.js";import"./useIcons-bfa037c0.js";import"./index-0ecd7869.js";import"./zh_CN-f51ae7db.js";import"./styleChecker-b88c47f4.js";import"./addEventListener-3a490a20.js";import"./Tree-27289865.js";import"./conductUtil-0f9ba3c8.js";import"./index-dcef3aa8.js";import"./index-d1e96b4a.js";import"./index-1b2860a7.js";import"./useBubbleLock-0d556991.js";import"./index-a5098ef4.js";import"./index-dc39c46e.js";import"./iconUtil-3c2f21e2.js";import"./useLazyKVMap-56df8c07.js";const de=()=>{const[T,p]=o.useState([]),[E,S]=o.useState([]),[k,g]=o.useState(!1),[b,v]=o.useState(),[A,C]=o.useState([]),[U,B]=o.useState(""),[d,y]=o.useState(""),j=(e,a)=>{S([]),p([]),a||y(""),g(!0);const l=new FileReader;l.onload=u=>{const n=new Uint8Array(u.target.result),i=z(n,{type:"array"}),L=a?i.Sheets[a]:i.Sheets[i.SheetNames[0]],c=K.sheet_to_json(L,{header:1}),w=i.SheetNames.map(r=>({label:r,value:r}));if(C(w),y(a||w[0].value),c.length>0){const r=[];c.slice(1).forEach((s,h)=>{if(s.length===0)return!1;const x={key:h};c[0].forEach((m,f)=>{x[m]=s[f]}),r.push(x)});const J=c[0].map(s=>({title:s,dataIndex:s,key:s,align:"center",render:(h,x,m)=>t.jsx(_,{style:{color:"#000",height:"100%",textAlign:"center"},bordered:!1,defaultValue:h,onBlur:f=>{F(f.target.value,m,s,r)}},m)}));S(J),p(r)}g(!1)},l.readAsArrayBuffer(e)},F=(e,a,l,u)=>{const n=JSON.parse(JSON.stringify(u));n[a][l]=e,p(n)},I=()=>{},R=e=>{b&&j(b,e)};return t.jsxs("div",{className:"TableDataImport",children:[t.jsxs("div",{className:"fileUpDiv",style:{marginTop:10},children:[t.jsx("span",{style:{marginRight:42},children:"文件名称"}),t.jsx("span",{className:"fileName",children:U}),t.jsx(O,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(B(e.name),v(e),j(e),!1):(V.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:t.jsx(D,{children:"上传Excel文件"})}),t.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!d&&t.jsx(N,{disabled:!0,style:{width:120},options:[]}),d&&t.jsx(N,{defaultValue:d,style:{width:120},onChange:R,options:A}),t.jsx(D,{type:"primary",onClick:I,children:"导入"})]}),t.jsx($,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:k,size:"small",dataSource:T,columns:E})]})};export{de as default};
//# sourceMappingURL=index-d596a4bb.js.map
