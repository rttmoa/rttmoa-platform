import{r as n,o as de,p as ie,aV as Ke,d2 as Ue,t as T,aZ as Me,n as A,d3 as Ge,E as Be,i as Se,a as he,q as Ce,d4 as qe,br as Je,aY as Ae,k as Le}from"./index-4a9fd3ee.js";import{a as we}from"./zh_CN-995af3a1.js";function De(){var a=document.documentElement.clientWidth,e=window.innerHeight||document.documentElement.clientHeight;return{width:a,height:e}}function Qe(a){var e=a.getBoundingClientRect(),t=document.documentElement;return{left:e.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||document.body.clientLeft||0),top:e.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||document.body.clientTop||0)}}var xe=n.createContext(null),en=function(e){var t=e.visible,s=e.maskTransitionName,c=e.getContainer,o=e.prefixCls,m=e.rootClassName,i=e.icons,l=e.countRender,v=e.showSwitch,C=e.showProgress,u=e.current,k=e.transform,h=e.count,w=e.scale,y=e.minScale,E=e.maxScale,p=e.closeIcon,M=e.onActive,I=e.onClose,R=e.onZoomIn,r=e.onZoomOut,S=e.onRotateRight,d=e.onRotateLeft,f=e.onFlipX,x=e.onFlipY,b=e.onReset,g=e.toolbarRender,P=e.zIndex,$=e.image,_=n.useContext(xe),D=i.rotateLeft,H=i.rotateRight,V=i.zoomIn,j=i.zoomOut,q=i.close,W=i.left,K=i.right,J=i.flipX,U=i.flipY,ae="".concat(o,"-operations-operation");n.useEffect(function(){var L=function(O){O.keyCode===Me.ESC&&I()};return t&&window.addEventListener("keydown",L),function(){window.removeEventListener("keydown",L)}},[t]);var Q=function(Y,O){Y.preventDefault(),Y.stopPropagation(),M(O)},X=n.useCallback(function(L){var Y=L.type,O=L.disabled,F=L.onClick,Z=L.icon;return n.createElement("div",{key:Y,className:de(ae,"".concat(o,"-operations-operation-").concat(Y),ie({},"".concat(o,"-operations-operation-disabled"),!!O)),onClick:F},Z)},[ae,o]),re=v?X({icon:W,onClick:function(Y){return Q(Y,-1)},type:"prev",disabled:u===0}):void 0,ee=v?X({icon:K,onClick:function(Y){return Q(Y,1)},type:"next",disabled:u===h-1}):void 0,G=X({icon:U,onClick:x,type:"flipY"}),N=X({icon:J,onClick:f,type:"flipX"}),te=X({icon:D,onClick:d,type:"rotateLeft"}),z=X({icon:H,onClick:S,type:"rotateRight"}),B=X({icon:j,onClick:r,type:"zoomOut",disabled:w<=y}),oe=X({icon:V,onClick:R,type:"zoomIn",disabled:w===E}),ce=n.createElement("div",{className:"".concat(o,"-operations")},G,N,te,z,B,oe);return n.createElement(Ke,{visible:t,motionName:s},function(L){var Y=L.className,O=L.style;return n.createElement(Ue,{open:!0,getContainer:c??document.body},n.createElement("div",{className:de("".concat(o,"-operations-wrapper"),Y,m),style:T(T({},O),{},{zIndex:P})},p===null?null:n.createElement("button",{className:"".concat(o,"-close"),onClick:I},p||q),v&&n.createElement(n.Fragment,null,n.createElement("div",{className:de("".concat(o,"-switch-left"),ie({},"".concat(o,"-switch-left-disabled"),u===0)),onClick:function(Z){return Q(Z,-1)}},W),n.createElement("div",{className:de("".concat(o,"-switch-right"),ie({},"".concat(o,"-switch-right-disabled"),u===h-1)),onClick:function(Z){return Q(Z,1)}},K)),n.createElement("div",{className:"".concat(o,"-footer")},C&&n.createElement("div",{className:"".concat(o,"-progress")},l?l(u+1,h):"".concat(u+1," / ").concat(h)),g?g(ce,T(T({icons:{prevIcon:re,nextIcon:ee,flipYIcon:G,flipXIcon:N,rotateLeftIcon:te,rotateRightIcon:z,zoomOutIcon:B,zoomInIcon:oe},actions:{onActive:M,onFlipY:x,onFlipX:f,onRotateLeft:d,onRotateRight:S,onZoomOut:r,onZoomIn:R,onReset:b,onClose:I},transform:k},_?{current:u,total:h}:{}),{},{image:$})):ce)))})},Te={x:0,y:0,rotate:0,scale:1,flipX:!1,flipY:!1};function nn(a,e,t,s){var c=n.useRef(null),o=n.useRef([]),m=n.useState(Te),i=A(m,2),l=i[0],v=i[1],C=function(w){v(Te),Ge(Te,l)||s==null||s({transform:Te,action:w})},u=function(w,y){c.current===null&&(o.current=[],c.current=Be(function(){v(function(E){var p=E;return o.current.forEach(function(M){p=T(T({},p),M)}),c.current=null,s==null||s({transform:p,action:y}),p})})),o.current.push(T(T({},l),w))},k=function(w,y,E,p,M){var I=a.current,R=I.width,r=I.height,S=I.offsetWidth,d=I.offsetHeight,f=I.offsetLeft,x=I.offsetTop,b=w,g=l.scale*w;g>t?(g=t,b=t/l.scale):g<e&&(g=M?g:e,b=g/l.scale);var P=E??innerWidth/2,$=p??innerHeight/2,_=b-1,D=_*R*.5,H=_*r*.5,V=_*(P-l.x-f),j=_*($-l.y-x),q=l.x-(V-D),W=l.y-(j-H);if(w<1&&g===1){var K=S*g,J=d*g,U=De(),ae=U.width,Q=U.height;K<=ae&&J<=Q&&(q=0,W=0)}u({x:q,y:W,scale:g},y)};return{transform:l,resetTransform:C,updateTransform:u,dispatchZoomChange:k}}function $e(a,e,t,s){var c=e+t,o=(t-s)/2;if(t>s){if(e>0)return ie({},a,o);if(e<0&&c<s)return ie({},a,-o)}else if(e<0||c>s)return ie({},a,e<0?o:-o);return{}}function ze(a,e,t,s){var c=De(),o=c.width,m=c.height,i=null;return a<=o&&e<=m?i={x:0,y:0}:(a>o||e>m)&&(i=T(T({},$e("x",t,a,o)),$e("y",s,e,m))),i}var pe=1,tn=1;function on(a,e,t,s,c,o,m){var i=c.rotate,l=c.scale,v=c.x,C=c.y,u=n.useState(!1),k=A(u,2),h=k[0],w=k[1],y=n.useRef({diffX:0,diffY:0,transformX:0,transformY:0}),E=function(r){!e||r.button!==0||(r.preventDefault(),r.stopPropagation(),y.current={diffX:r.pageX-v,diffY:r.pageY-C,transformX:v,transformY:C},w(!0))},p=function(r){t&&h&&o({x:r.pageX-y.current.diffX,y:r.pageY-y.current.diffY},"move")},M=function(){if(t&&h){w(!1);var r=y.current,S=r.transformX,d=r.transformY,f=v!==S&&C!==d;if(!f)return;var x=a.current.offsetWidth*l,b=a.current.offsetHeight*l,g=a.current.getBoundingClientRect(),P=g.left,$=g.top,_=i%180!==0,D=ze(_?b:x,_?x:b,P,$);D&&o(T({},D),"dragRebound")}},I=function(r){if(!(!t||r.deltaY==0)){var S=Math.abs(r.deltaY/100),d=Math.min(S,tn),f=pe+d*s;r.deltaY>0&&(f=pe/f),m(f,"wheel",r.clientX,r.clientY)}};return n.useEffect(function(){var R,r,S,d;if(e){S=we(window,"mouseup",M,!1),d=we(window,"mousemove",p,!1);try{window.top!==window.self&&(R=we(window.top,"mouseup",M,!1),r=we(window.top,"mousemove",p,!1))}catch{}}return function(){var f,x,b,g;(f=S)===null||f===void 0||f.remove(),(x=d)===null||x===void 0||x.remove(),(b=R)===null||b===void 0||b.remove(),(g=r)===null||g===void 0||g.remove()}},[t,h,v,C,i,e]),{isMoving:h,onMouseDown:E,onMouseMove:p,onMouseUp:M,onWheel:I}}function an(a){return new Promise(function(e){var t=document.createElement("img");t.onerror=function(){return e(!1)},t.onload=function(){return e(!0)},t.src=a})}function Fe(a){var e=a.src,t=a.isCustomPlaceholder,s=a.fallback,c=n.useState(t?"loading":"normal"),o=A(c,2),m=o[0],i=o[1],l=n.useRef(!1),v=m==="error";n.useEffect(function(){var h=!0;return an(e).then(function(w){!w&&h&&i("error")}),function(){h=!1}},[e]),n.useEffect(function(){t&&!l.current?i("loading"):v&&i("normal")},[e]);var C=function(){i("normal")},u=function(w){l.current=!1,m==="loading"&&w!==null&&w!==void 0&&w.complete&&(w.naturalWidth||w.naturalHeight)&&(l.current=!0,C())},k=v&&s?{src:s}:{onLoad:C,src:e};return[u,k,m]}function Ee(a,e){var t=a.x-e.x,s=a.y-e.y;return Math.hypot(t,s)}function rn(a,e,t,s){var c=Ee(a,t),o=Ee(e,s);if(c===0&&o===0)return[a.x,a.y];var m=c/(c+o),i=a.x+m*(e.x-a.x),l=a.y+m*(e.y-a.y);return[i,l]}function cn(a,e,t,s,c,o,m){var i=c.rotate,l=c.scale,v=c.x,C=c.y,u=n.useState(!1),k=A(u,2),h=k[0],w=k[1],y=n.useRef({point1:{x:0,y:0},point2:{x:0,y:0},eventType:"none"}),E=function(r){y.current=T(T({},y.current),r)},p=function(r){if(e){r.stopPropagation(),w(!0);var S=r.touches,d=S===void 0?[]:S;d.length>1?E({point1:{x:d[0].clientX,y:d[0].clientY},point2:{x:d[1].clientX,y:d[1].clientY},eventType:"touchZoom"}):E({point1:{x:d[0].clientX-v,y:d[0].clientY-C},eventType:"move"})}},M=function(r){var S=r.touches,d=S===void 0?[]:S,f=y.current,x=f.point1,b=f.point2,g=f.eventType;if(d.length>1&&g==="touchZoom"){var P={x:d[0].clientX,y:d[0].clientY},$={x:d[1].clientX,y:d[1].clientY},_=rn(x,b,P,$),D=A(_,2),H=D[0],V=D[1],j=Ee(P,$)/Ee(x,b);m(j,"touchZoom",H,V,!0),E({point1:P,point2:$,eventType:"touchZoom"})}else g==="move"&&(o({x:d[0].clientX-x.x,y:d[0].clientY-x.y},"move"),E({eventType:"move"}))},I=function(){if(t){if(h&&w(!1),E({eventType:"none"}),s>l)return o({x:0,y:0,scale:s},"touchZoom");var r=a.current.offsetWidth*l,S=a.current.offsetHeight*l,d=a.current.getBoundingClientRect(),f=d.left,x=d.top,b=i%180!==0,g=ze(b?S:r,b?r:S,f,x);g&&o(T({},g),"dragRebound")}};return n.useEffect(function(){var R;return t&&e&&(R=we(window,"touchmove",function(r){return r.preventDefault()},{passive:!1})),function(){var r;(r=R)===null||r===void 0||r.remove()}},[t,e]),{isTouching:h,onTouchStart:p,onTouchMove:M,onTouchEnd:I}}var sn=["fallback","src","imgRef"],ln=["prefixCls","src","alt","imageInfo","fallback","movable","onClose","visible","icons","rootClassName","closeIcon","getContainer","current","count","countRender","scaleStep","minScale","maxScale","transitionName","maskTransitionName","imageRender","imgCommonProps","toolbarRender","onTransform","onChange"],un=function(e){var t=e.fallback,s=e.src,c=e.imgRef,o=Se(e,sn),m=Fe({src:s,fallback:t}),i=A(m,2),l=i[0],v=i[1];return he.createElement("img",Ce({ref:function(u){c.current=u,l(u)}},o,v))},We=function(e){var t=e.prefixCls,s=e.src,c=e.alt,o=e.imageInfo,m=e.fallback,i=e.movable,l=i===void 0?!0:i,v=e.onClose,C=e.visible,u=e.icons,k=u===void 0?{}:u,h=e.rootClassName,w=e.closeIcon,y=e.getContainer,E=e.current,p=E===void 0?0:E,M=e.count,I=M===void 0?1:M,R=e.countRender,r=e.scaleStep,S=r===void 0?.5:r,d=e.minScale,f=d===void 0?1:d,x=e.maxScale,b=x===void 0?50:x,g=e.transitionName,P=g===void 0?"zoom":g,$=e.maskTransitionName,_=$===void 0?"fade":$,D=e.imageRender,H=e.imgCommonProps,V=e.toolbarRender,j=e.onTransform,q=e.onChange,W=Se(e,ln),K=n.useRef(),J=n.useContext(xe),U=J&&I>1,ae=J&&I>=1,Q=n.useState(!0),X=A(Q,2),re=X[0],ee=X[1],G=nn(K,f,b,j),N=G.transform,te=G.resetTransform,z=G.updateTransform,B=G.dispatchZoomChange,oe=on(K,l,C,S,N,z,B),ce=oe.isMoving,L=oe.onMouseDown,Y=oe.onWheel,O=cn(K,l,C,f,N,z,B),F=O.isTouching,Z=O.onTouchStart,ue=O.onTouchMove,ge=O.onTouchEnd,se=N.rotate,le=N.scale,ke=de(ie({},"".concat(t,"-moving"),ce));n.useEffect(function(){re||ee(!0)},[re]);var Pe=function(){te("close")},_e=function(){B(pe+S,"zoomIn")},fe=function(){B(pe/(pe+S),"zoomOut")},ve=function(){z({rotate:se+90},"rotateRight")},be=function(){z({rotate:se-90},"rotateLeft")},Re=function(){z({flipX:!N.flipX},"flipX")},ye=function(){z({flipY:!N.flipY},"flipY")},He=function(){te("reset")},Ne=function(me){var Ie=p+me;!Number.isInteger(Ie)||Ie<0||Ie>I-1||(ee(!1),te(me<0?"prev":"next"),q==null||q(Ie,p))},Ve=function(me){!C||!U||(me.keyCode===Me.LEFT?Ne(-1):me.keyCode===Me.RIGHT&&Ne(1))},je=function(me){C&&(le!==1?z({x:0,y:0,scale:1},"doubleClick"):B(pe+S,"doubleClick",me.clientX,me.clientY))};n.useEffect(function(){var ne=we(window,"keydown",Ve,!1);return function(){ne.remove()}},[C,U,p]);var Oe=he.createElement(un,Ce({},H,{width:e.width,height:e.height,imgRef:K,className:"".concat(t,"-img"),alt:c,style:{transform:"translate3d(".concat(N.x,"px, ").concat(N.y,"px, 0) scale3d(").concat(N.flipX?"-":"").concat(le,", ").concat(N.flipY?"-":"").concat(le,", 1) rotate(").concat(se,"deg)"),transitionDuration:(!re||F)&&"0s"},fallback:m,src:s,onWheel:Y,onMouseDown:L,onDoubleClick:je,onTouchStart:Z,onTouchMove:ue,onTouchEnd:ge,onTouchCancel:ge})),Xe=T({url:s,alt:c},o);return he.createElement(he.Fragment,null,he.createElement(qe,Ce({transitionName:P,maskTransitionName:_,closable:!1,keyboard:!0,prefixCls:t,onClose:v,visible:C,classNames:{wrapper:ke},rootClassName:h,getContainer:y},W,{afterClose:Pe}),he.createElement("div",{className:"".concat(t,"-img-wrapper")},D?D(Oe,T({transform:N,image:Xe},J?{current:p}:{})):Oe)),he.createElement(en,{visible:C,transform:N,maskTransitionName:_,closeIcon:w,getContainer:y,prefixCls:t,rootClassName:h,icons:k,countRender:R,showSwitch:U,showProgress:ae,current:p,count:I,scale:le,minScale:f,maxScale:b,toolbarRender:V,onActive:Ne,onZoomIn:_e,onZoomOut:fe,onRotateRight:ve,onRotateLeft:be,onFlipX:Re,onFlipY:ye,onClose:v,onReset:He,zIndex:W.zIndex!==void 0?W.zIndex+1:void 0,image:Xe}))},Ye=["crossOrigin","decoding","draggable","loading","referrerPolicy","sizes","srcSet","useMap","alt"];function fn(a){var e=n.useState({}),t=A(e,2),s=t[0],c=t[1],o=n.useCallback(function(i,l){return c(function(v){return T(T({},v),{},ie({},i,l))}),function(){c(function(v){var C=T({},v);return delete C[i],C})}},[]),m=n.useMemo(function(){return a?a.map(function(i){if(typeof i=="string")return{data:{src:i}};var l={};return Object.keys(i).forEach(function(v){["src"].concat(Je(Ye)).includes(v)&&(l[v]=i[v])}),{data:l}}):Object.keys(s).reduce(function(i,l){var v=s[l],C=v.canPreview,u=v.data;return C&&i.push({data:u,id:l}),i},[])},[a,s]);return[m,o,!!a]}var vn=["visible","onVisibleChange","getContainer","current","movable","minScale","maxScale","countRender","closeIcon","onChange","onTransform","toolbarRender","imageRender"],mn=["src"],dn=function(e){var t,s=e.previewPrefixCls,c=s===void 0?"rc-image-preview":s,o=e.children,m=e.icons,i=m===void 0?{}:m,l=e.items,v=e.preview,C=e.fallback,u=Ae(v)==="object"?v:{},k=u.visible,h=u.onVisibleChange,w=u.getContainer,y=u.current,E=u.movable,p=u.minScale,M=u.maxScale,I=u.countRender,R=u.closeIcon,r=u.onChange,S=u.onTransform,d=u.toolbarRender,f=u.imageRender,x=Se(u,vn),b=fn(l),g=A(b,3),P=g[0],$=g[1],_=g[2],D=Le(0,{value:y}),H=A(D,2),V=H[0],j=H[1],q=n.useState(!1),W=A(q,2),K=W[0],J=W[1],U=((t=P[V])===null||t===void 0?void 0:t.data)||{},ae=U.src,Q=Se(U,mn),X=Le(!!k,{value:k,onChange:function(F,Z){h==null||h(F,Z,V)}}),re=A(X,2),ee=re[0],G=re[1],N=n.useState(null),te=A(N,2),z=te[0],B=te[1],oe=n.useCallback(function(O,F,Z,ue){var ge=_?P.findIndex(function(se){return se.data.src===F}):P.findIndex(function(se){return se.id===O});j(ge<0?0:ge),G(!0),B({x:Z,y:ue}),J(!0)},[P,_]);n.useEffect(function(){ee?K||j(0):J(!1)},[ee]);var ce=function(F,Z){j(F),r==null||r(F,Z)},L=function(){G(!1),B(null)},Y=n.useMemo(function(){return{register:$,onPreview:oe}},[$,oe]);return n.createElement(xe.Provider,{value:Y},o,n.createElement(We,Ce({"aria-hidden":!ee,movable:E,visible:ee,prefixCls:c,closeIcon:R,onClose:L,mousePosition:z,imgCommonProps:Q,src:ae,fallback:C,icons:i,minScale:p,maxScale:M,getContainer:w,current:V,count:P.length,countRender:I,onTransform:S,toolbarRender:d,imageRender:f,onChange:ce},x)))},Ze=0;function gn(a,e){var t=n.useState(function(){return Ze+=1,String(Ze)}),s=A(t,1),c=s[0],o=n.useContext(xe),m={data:e,canPreview:a};return n.useEffect(function(){if(o)return o.register(c,m)},[]),n.useEffect(function(){o&&o.register(c,m)},[a,e]),c}var hn=["src","alt","onPreviewClose","prefixCls","previewPrefixCls","placeholder","fallback","width","height","style","preview","className","onClick","onError","wrapperClassName","wrapperStyle","rootClassName"],Cn=["src","visible","onVisibleChange","getContainer","mask","maskClassName","movable","icons","scaleStep","minScale","maxScale","imageRender","toolbarRender"],wn=function(e){var t=e.src,s=e.alt,c=e.onPreviewClose,o=e.prefixCls,m=o===void 0?"rc-image":o,i=e.previewPrefixCls,l=i===void 0?"".concat(m,"-preview"):i,v=e.placeholder,C=e.fallback,u=e.width,k=e.height,h=e.style,w=e.preview,y=w===void 0?!0:w,E=e.className,p=e.onClick,M=e.onError,I=e.wrapperClassName,R=e.wrapperStyle,r=e.rootClassName,S=Se(e,hn),d=v&&v!==!0,f=Ae(y)==="object"?y:{},x=f.src,b=f.visible,g=b===void 0?void 0:b,P=f.onVisibleChange,$=P===void 0?c:P,_=f.getContainer,D=_===void 0?void 0:_,H=f.mask,V=f.maskClassName,j=f.movable,q=f.icons,W=f.scaleStep,K=f.minScale,J=f.maxScale,U=f.imageRender,ae=f.toolbarRender,Q=Se(f,Cn),X=x??t,re=Le(!!g,{value:g,onChange:$}),ee=A(re,2),G=ee[0],N=ee[1],te=Fe({src:t,isCustomPlaceholder:d,fallback:C}),z=A(te,3),B=z[0],oe=z[1],ce=z[2],L=n.useState(null),Y=A(L,2),O=Y[0],F=Y[1],Z=n.useContext(xe),ue=!!y,ge=function(){N(!1),F(null)},se=de(m,I,r,ie({},"".concat(m,"-error"),ce==="error")),le=n.useMemo(function(){var fe={};return Ye.forEach(function(ve){e[ve]!==void 0&&(fe[ve]=e[ve])}),fe},Ye.map(function(fe){return e[fe]})),ke=n.useMemo(function(){return T(T({},le),{},{src:X})},[X,le]),Pe=gn(ue,ke),_e=function(ve){var be=Qe(ve.target),Re=be.left,ye=be.top;Z?Z.onPreview(Pe,X,Re,ye):(F({x:Re,y:ye}),N(!0)),p==null||p(ve)};return n.createElement(n.Fragment,null,n.createElement("div",Ce({},S,{className:se,onClick:ue?_e:p,style:T({width:u,height:k},R)}),n.createElement("img",Ce({},le,{className:de("".concat(m,"-img"),ie({},"".concat(m,"-img-placeholder"),v===!0),E),style:T({height:k},h),ref:B},oe,{width:u,height:k,onError:M})),ce==="loading"&&n.createElement("div",{"aria-hidden":"true",className:"".concat(m,"-placeholder")},v),H&&ue&&n.createElement("div",{className:de("".concat(m,"-mask"),V),style:{display:(h==null?void 0:h.display)==="none"?"none":void 0}},H)),!Z&&ue&&n.createElement(We,Ce({"aria-hidden":!G,visible:G,prefixCls:l,onClose:ge,mousePosition:O,src:X,alt:s,imageInfo:{width:u,height:k},fallback:C,getContainer:D,icons:q,movable:j,scaleStep:W,minScale:K,maxScale:J,rootClassName:r,imageRender:U,imgCommonProps:le,toolbarRender:ae},Q)))};wn.PreviewGroup=dn;export{wn as I};
