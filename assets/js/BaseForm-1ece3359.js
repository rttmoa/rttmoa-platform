import{W as me,bm as J,d as se,b9 as vr,b7 as gr,aF as Me,bw as Be,r as f,c0 as je,by as ce,bz as z,Z as s,bx as pe,S as xe,j as R,R as hr,C as yr,ch as de,T as ze,a8 as Ge,z as ye,X as k,bt as pr,dY as ar,b as or,B as Ue,aD as wr,y as Ee,cg as Ne,az as be,V as Pr,bV as Cr}from"./index-423f46ac.js";import{d as Rr,b as ir,u as We,a as ur,p as br,P as xr}from"./index-20957c5f.js";import{_ as Le}from"./createForOfIteratorHelper-adf5964d.js";import{q as Fr}from"./merge-0ec43793.js";var Sr=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Ke=function(e){return e==="*"||e==="x"||e==="X"},Qe=function(e){var n=parseInt(e,10);return isNaN(n)?e:n},Ar=function(e,n){return J(e)!==J(n)?[String(e),String(n)]:[e,n]},jr=function(e,n){if(Ke(e)||Ke(n))return 0;var t=Ar(Qe(e),Qe(n)),o=me(t,2),a=o[0],u=o[1];return a>u?1:a<u?-1:0},Tr=function(e,n){for(var t=0;t<Math.max(e.length,n.length);t++){var o=jr(e[t]||"0",n[t]||"0");if(o!==0)return o}return 0},Xe=function(e){var n,t=e.match(Sr);return t==null||(n=t.shift)===null||n===void 0||n.call(t),t},dn=function(e,n){var t=Xe(e),o=Xe(n),a=t.pop(),u=o.pop(),l=Tr(t,o);return l!==0?l:a||u?a?-1:1:0},lr=se.createContext({}),sr={exports:{}};(function(r,e){(function(n,t){r.exports=t()})(vr,function(){var n="month",t="quarter";return function(o,a){var u=a.prototype;u.quarter=function(i){return this.$utils().u(i)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(i-1))};var l=u.add;u.add=function(i,c){return i=Number(i),this.$utils().p(c)===t?this.add(3*i,n):l.bind(this)(i,c)};var g=u.startOf;u.startOf=function(i,c){var m=this.$utils(),d=!!m.u(c)||c;if(m.p(i)===t){var h=this.quarter()-1;return d?this.month(3*h).startOf(n).startOf("day"):this.month(3*h+2).endOf(n).endOf("day")}return g.bind(this)(i,c)}}})})(sr);var Ir=sr.exports;const $r=gr(Ir);var Ve=function(e){return e==null};Me.extend($r);var Mr={time:"HH:mm:ss",timeRange:"HH:mm:ss",date:"YYYY-MM-DD",dateWeek:"YYYY-wo",dateMonth:"YYYY-MM",dateQuarter:"YYYY-[Q]Q",dateYear:"YYYY",dateRange:"YYYY-MM-DD",dateTime:"YYYY-MM-DD HH:mm:ss",dateTimeRange:"YYYY-MM-DD HH:mm:ss"};function Je(r){return Object.prototype.toString.call(r)==="[object Object]"}function Er(r){if(Je(r)===!1)return!1;var e=r.constructor;if(e===void 0)return!0;var n=e.prototype;return!(Je(n)===!1||n.hasOwnProperty("isPrototypeOf")===!1)}var Ye=function(e){return!!(e!=null&&e._isAMomentObject)},Ze=function(e,n,t){if(!n)return e;if(Me.isDayjs(e)||Ye(e)){if(n==="number")return e.valueOf();if(n==="string")return e.format(Mr[t]||"YYYY-MM-DD HH:mm:ss");if(typeof n=="string"&&n!=="string")return e.format(n);if(typeof n=="function")return n(e,t)}return e},Nr=function r(e,n,t,o,a){var u={};return typeof window>"u"||J(e)!=="object"||Ve(e)||e instanceof Blob||Array.isArray(e)?e:(Object.keys(e).forEach(function(l){var g=a?[a,l].flat(1):[l],i=Be(t,g)||"text",c="text",m;typeof i=="string"?c=i:i&&(c=i.valueType,m=i.dateFormat);var d=e[l];if(!(Ve(d)&&o)){if(Er(d)&&!Array.isArray(d)&&!Me.isDayjs(d)&&!Ye(d)){u[l]=r(d,n,t,o,g);return}if(Array.isArray(d)){u[l]=d.map(function(h,I){return Me.isDayjs(h)||Ye(h)?Ze(h,m||n,c):r(h,n,t,o,[l,"".concat(I)].flat(1))});return}u[l]=Ze(d,m||n,c)}}),u)};function fr(r){if(typeof r=="function"){for(var e=arguments.length,n=new Array(e>1?e-1:0),t=1;t<e;t++)n[t-1]=arguments[t];return r.apply(void 0,n)}return r}var Te=function(e){var n=f.useRef(null);return n.current=e,f.useCallback(function(){for(var t,o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return(t=n.current)===null||t===void 0?void 0:t.call.apply(t,[n].concat(je(a)))},[])};function Ie(r,e,n,t){if(r===e)return!0;if(r&&e&&J(r)==="object"&&J(e)==="object"){if(r.constructor!==e.constructor)return!1;var o,a,u;if(Array.isArray(r)){if(o=r.length,o!=e.length)return!1;for(a=o;a--!==0;)if(!Ie(r[a],e[a],n,t))return!1;return!0}if(r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;var l=Le(r.entries()),g;try{for(l.s();!(g=l.n()).done;)if(a=g.value,!e.has(a[0]))return!1}catch(I){l.e(I)}finally{l.f()}var i=Le(r.entries()),c;try{for(i.s();!(c=i.n()).done;)if(a=c.value,!Ie(a[1],e.get(a[0]),n,t))return!1}catch(I){i.e(I)}finally{i.f()}return!0}if(r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;var m=Le(r.entries()),d;try{for(m.s();!(d=m.n()).done;)if(a=d.value,!e.has(a[0]))return!1}catch(I){m.e(I)}finally{m.f()}return!0}if(ArrayBuffer.isView(r)&&ArrayBuffer.isView(e)){if(o=r.length,o!=e.length)return!1;for(a=o;a--!==0;)if(r[a]!==e[a])return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf&&r.valueOf)return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString&&r.toString)return r.toString()===e.toString();if(u=Object.keys(r),o=u.length,o!==Object.keys(e).length)return!1;for(a=o;a--!==0;)if(!Object.prototype.hasOwnProperty.call(e,u[a]))return!1;for(a=o;a--!==0;){var h=u[a];if(!(n!=null&&n.includes(h))&&!(h==="_owner"&&r.$$typeof)&&!Ie(r[h],e[h],n,t))return!1}return!0}return r!==r&&e!==e}var De=0;function Vr(r){var e=f.useRef(null),n=f.useState(function(){return r.proFieldKey?r.proFieldKey.toString():(De+=1,De.toString())}),t=me(n,1),o=t[0],a=f.useRef(o),u=function(){var c=ce(z().mark(function m(){var d,h,I,b;return z().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return(d=e.current)===null||d===void 0||d.abort(),I=new AbortController,e.current=I,F.next=5,Promise.race([(h=r.request)===null||h===void 0?void 0:h.call(r,r.params,r),new Promise(function(U,O){var y;(y=e.current)===null||y===void 0||(y=y.signal)===null||y===void 0||y.addEventListener("abort",function(){O(new Error("aborted"))})})]);case 5:return b=F.sent,F.abrupt("return",b);case 7:case"end":return F.stop()}},m)}));return function(){return c.apply(this,arguments)}}();f.useEffect(function(){return function(){De+=1}},[]);var l=Rr([a.current,r.params],u,{revalidateOnFocus:!1,shouldRetryOnError:!1,revalidateOnReconnect:!1}),g=l.data,i=l.error;return[g||i]}var Or=function(e){var n=f.useRef();return f.useEffect(function(){n.current=e}),n.current},_r=function(){for(var e={},n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];for(var a=t.length,u,l=0;l<a;l+=1)for(u in t[l])t[l].hasOwnProperty(u)&&(J(e[u])==="object"&&J(t[l][u])==="object"&&e[u]!==void 0&&e[u]!==null&&!Array.isArray(e[u])&&!Array.isArray(t[l][u])?e[u]=s(s({},e[u]),t[l][u]):e[u]=t[l][u]);return e},er=0,rr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:21;if(typeof window>"u"||!window.crypto)return(er+=1).toFixed(0);for(var n="",t=crypto.getRandomValues(new Uint8Array(e));e--;){var o=63&t[e];n+=o<36?o.toString(36):o<62?(o-26).toString(36).toUpperCase():o<63?"_":"-"}return n},cr=function(){return typeof window>"u"?rr():window.crypto&&window.crypto.randomUUID&&typeof crypto.randomUUID=="function"?crypto.randomUUID():rr()};function Lr(r){return J(r)!=="object"?!1:r===null?!0:!(se.isValidElement(r)||r.constructor===RegExp||r instanceof Map||r instanceof Set||r instanceof HTMLElement||r instanceof Blob||r instanceof File||Array.isArray(r))}var Dr=function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Object.keys(n).reduce(function(l,g){var i=n[g];return Ve(i)||(l[g]=i),l},{});if(Object.keys(o).length<1||typeof window>"u"||J(e)!=="object"||Ve(e)||e instanceof Blob)return e;var a=Array.isArray(e)?[]:{},u=function l(g,i){var c=Array.isArray(g),m=c?[]:{};return g==null||g===void 0?m:(Object.keys(g).forEach(function(d){var h=function O(y,L){return Array.isArray(y)&&y.forEach(function(S,E){if(S){var Y=L==null?void 0:L[E];typeof S=="function"&&(L[E]=S(L,d,g)),J(S)==="object"&&!Array.isArray(S)&&Object.keys(S).forEach(function(B){var _=Y==null?void 0:Y[B];if(typeof S[B]=="function"&&_){var G=S[B](Y[B],d,g);Y[B]=J(G)==="object"?G[B]:G}else J(S[B])==="object"&&Array.isArray(S[B])&&_&&O(S[B],_)}),J(S)==="object"&&Array.isArray(S)&&Y&&O(S,Y)}}),d},I=i?[i,d].flat(1):[d].flat(1),b=g[d],p=Be(o,I),F=function(){var y,L,S=!1;if(typeof p=="function"){L=p==null?void 0:p(b,d,g);var E=J(L);E!=="object"&&E!=="undefined"?(y=d,S=!0):y=L}else y=h(p,b);if(Array.isArray(y)){m=pe(m,y,b);return}J(y)==="object"&&!Array.isArray(a)?a=Fr(a,y):J(y)==="object"&&Array.isArray(a)?m=s(s({},m),y):(y!==null||y!==void 0)&&(m=pe(m,[y],S?L:b))};if(p&&typeof p=="function"&&F(),!(typeof window>"u")){if(Lr(b)){var U=l(b,I);if(Object.keys(U).length<1)return;m=pe(m,[d],U);return}F()}}),t?m:g)};return a=Array.isArray(e)&&Array.isArray(a)?je(u(e)):_r({},u(e),a),a},Ae=globalThis&&globalThis.__assign||function(){return Ae=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},Ae.apply(this,arguments)};function Ur(r){var e,n=(typeof window<"u"?window:{}).URL,t=new n((e=window==null?void 0:window.location)===null||e===void 0?void 0:e.href);return Object.keys(r).forEach(function(o){var a=r[o];a!=null?Array.isArray(a)?(t.searchParams.delete(o),a.forEach(function(u){t.searchParams.append(o,u)})):a instanceof Date?Number.isNaN(a.getTime())||t.searchParams.set(o,a.toISOString()):typeof a=="object"?t.searchParams.set(o,JSON.stringify(a)):t.searchParams.set(o,a):t.searchParams.delete(o)}),t}function Yr(r,e){var n;r===void 0&&(r={}),e===void 0&&(e={disabled:!1});var t=f.useState(),o=t[1],a=typeof window<"u"&&((n=window==null?void 0:window.location)===null||n===void 0?void 0:n.search),u=f.useMemo(function(){return e.disabled?{}:new URLSearchParams(a||{})},[e.disabled,a]),l=f.useMemo(function(){if(e.disabled)return{};if(typeof window>"u"||!window.URL)return{};var c=[];u.forEach(function(d,h){c.push({key:h,value:d})}),c=c.reduce(function(d,h){return(d[h.key]=d[h.key]||[]).push(h),d},{}),c=Object.keys(c).map(function(d){var h=c[d];return h.length===1?[d,h[0].value]:[d,h.map(function(I){var b=I.value;return b})]});var m=Ae({},r);return c.forEach(function(d){var h=d[0],I=d[1];m[h]=Wr(h,I,{},r)}),m},[e.disabled,r,u]);function g(c){if(!(typeof window>"u"||!window.URL)){var m=Ur(c);window.location.search!==m.search&&window.history.replaceState({},"",m.toString()),u.toString()!==m.searchParams.toString()&&o({})}}f.useEffect(function(){e.disabled||typeof window>"u"||!window.URL||g(Ae(Ae({},r),l))},[e.disabled,l]);var i=function(c){g(c)};return f.useEffect(function(){if(e.disabled)return function(){};if(typeof window>"u"||!window.URL)return function(){};var c=function(){o({})};return window.addEventListener("popstate",c),function(){window.removeEventListener("popstate",c)}},[e.disabled]),[l,i]}var Br={true:!0,false:!1};function Wr(r,e,n,t){if(!n)return e;var o=n[r],a=e===void 0?t[r]:e;return o===Number?Number(a):o===Boolean||e==="true"||e==="false"?Br[a]:Array.isArray(o)?o.find(function(u){return u==a})||t[r]:a}var Hr=se.createContext({});const dr=Hr;var qr=["children","Wrapper"],kr=["children","Wrapper"],mr=f.createContext({grid:!1,colProps:void 0,rowProps:void 0}),zr=function(e){var n=e.grid,t=e.rowProps,o=e.colProps;return{grid:!!n,RowWrapper:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=u.children,g=u.Wrapper,i=xe(u,qr);return n?R.jsx(hr,s(s(s({gutter:8},t),i),{},{children:l})):g?R.jsx(g,{children:l}):l},ColWrapper:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=u.children,g=u.Wrapper,i=xe(u,kr),c=f.useMemo(function(){var m=s(s({},o),i);return typeof m.span>"u"&&typeof m.xs>"u"&&(m.xs=24),m},[i]);return n?R.jsx(yr,s(s({},c),{},{children:l})):g?R.jsx(g,{children:l}):l}}},He=function(e){var n=f.useMemo(function(){return J(e)==="object"?e:{grid:e}},[e]),t=f.useContext(mr),o=t.grid,a=t.colProps;return f.useMemo(function(){return zr({grid:!!(o||n.grid),rowProps:n==null?void 0:n.rowProps,colProps:(n==null?void 0:n.colProps)||a,Wrapper:n==null?void 0:n.Wrapper})},[n==null?void 0:n.Wrapper,n.grid,o,JSON.stringify([a,n==null?void 0:n.colProps,n==null?void 0:n.rowProps])])},qe=se.createContext({mode:"edit"}),Gr=["creatorButtonProps","deleteIconProps","copyIconProps","itemContainerRender","itemRender","alwaysShowItemLabel","prefixCls","creatorRecord","action","actionGuard","children","actionRender","fields","meta","field","index","formInstance","originName","containerClassName","containerStyle","min","max","count"],Kr=function(e){return Array.isArray(e)?e:typeof e=="function"?[e]:pr(e)},Qr=function(e){var n,t;e.creatorButtonProps;var o=e.deleteIconProps,a=e.copyIconProps,u=e.itemContainerRender,l=e.itemRender,g=e.alwaysShowItemLabel,i=e.prefixCls;e.creatorRecord;var c=e.action;e.actionGuard;var m=e.children,d=e.actionRender,h=e.fields,I=e.meta,b=e.field,p=e.index,F=e.formInstance,U=e.originName,O=e.containerClassName,y=e.containerStyle,L=e.min,S=e.max,E=e.count,Y=xe(e,Gr),B=f.useContext(ir),_=B.hashId,G=((n=de.useConfig)===null||n===void 0?void 0:n.call(de))||{componentSize:"middle"},H=G.componentSize,Q=f.useContext(Oe),V=f.useRef(!1),D=f.useContext(qe),M=D.mode,$=f.useState(!1),j=me($,2),A=j[0],v=j[1],P=f.useState(!1),T=me(P,2),w=T[0],C=T[1];f.useEffect(function(){return function(){V.current=!0}},[]);var re=function(){return F.getFieldValue([Q.listName,U,p==null?void 0:p.toString()].flat(1).filter(function(X){return X!=null}))},ae={getCurrentRowData:re,setCurrentRowData:function(X){var te,q=(F==null||(te=F.getFieldsValue)===null||te===void 0?void 0:te.call(F))||{},N=[Q.listName,U,p==null?void 0:p.toString()].flat(1).filter(function(K){return K!=null}),W=pe(q,N,s(s({},re()),X||{}));return F.setFieldsValue(W)}},Z=Kr(m).map(function(x){return typeof x=="function"?x==null?void 0:x(b,p,s(s({},c),ae),E):x}).map(function(x,X){if(se.isValidElement(x)){var te;return se.cloneElement(x,s({key:x.key||(x==null||(te=x.props)===null||te===void 0?void 0:te.name)||X},(x==null?void 0:x.props)||{}))}return x}),ee=f.useMemo(function(){if(M==="read"||a===!1||S===E)return null;var x=a,X=x.Icon,te=X===void 0?ar:X,q=x.tooltipText;return R.jsx(ze,{title:q,children:w?R.jsx(Ge,{}):R.jsx(te,{className:ye("".concat(i,"-action-icon action-copy"),_),onClick:ce(z().mark(function N(){var W;return z().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return C(!0),W=F==null?void 0:F.getFieldValue([Q.listName,U,b.name].filter(function(he){return he!==void 0}).flat(1)),fe.next=4,c.add(W);case 4:C(!1);case 5:case"end":return fe.stop()}},N)}))})},"copy")},[a,S,E,w,i,_,F,Q.listName,b.name,U,c]),we=f.useMemo(function(){if(M==="read"||o===!1||L===E)return null;var x=o,X=x.Icon,te=X===void 0?or:X,q=x.tooltipText;return R.jsx(ze,{title:q,children:A?R.jsx(Ge,{}):R.jsx(te,{className:ye("".concat(i,"-action-icon action-remove"),_),onClick:ce(z().mark(function N(){return z().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return v(!0),K.next=3,c.remove(b.name);case 3:V.current||v(!1);case 4:case"end":return K.stop()}},N)}))})},"delete")},[o,L,E,A,i,_,c,b.name]),Pe=f.useMemo(function(){return[ee,we].filter(function(x){return x!=null})},[ee,we]),ne=(d==null?void 0:d(b,c,Pe,E))||Pe,oe=ne.length>0&&M!=="read"?R.jsx("div",{className:ye("".concat(i,"-action"),k({},"".concat(i,"-action-small"),H==="small"),_),children:ne}):null,ve={name:Y.name,field:b,index:p,record:F==null||(t=F.getFieldValue)===null||t===void 0?void 0:t.call(F,[Q.listName,U,b.name].filter(function(x){return x!==void 0}).flat(1)),fields:h,operation:c,meta:I},Fe=He(),ge=Fe.grid,ie=(u==null?void 0:u(Z,ve))||Z,le=(l==null?void 0:l({listDom:R.jsx("div",{className:ye("".concat(i,"-container"),O,_),style:s({width:ge?"100%":void 0},y),children:ie}),action:oe},ve))||R.jsxs("div",{className:ye("".concat(i,"-item"),_,k(k({},"".concat(i,"-item-default"),g===void 0),"".concat(i,"-item-show-label"),g)),style:{display:"flex",alignItems:"flex-end"},children:[R.jsx("div",{className:ye("".concat(i,"-container"),O,_),style:s({width:ge?"100%":void 0},y),children:ie}),oe]});return R.jsx(Oe.Provider,{value:s(s({},b),{},{listName:[Q.listName,U,b.name].filter(function(x){return x!==void 0}).flat(1)}),children:le})},Xr=function(e){var n=We(),t=e.creatorButtonProps,o=e.prefixCls,a=e.children,u=e.creatorRecord,l=e.action,g=e.fields,i=e.actionGuard,c=e.max,m=e.fieldExtraRender,d=e.meta,h=e.containerClassName,I=e.containerStyle,b=e.onAfterAdd,p=e.onAfterRemove,F=f.useContext(ir),U=F.hashId,O=f.useRef(new Map),y=f.useState(!1),L=me(y,2),S=L[0],E=L[1],Y=f.useMemo(function(){return g.map(function(V){var D,M;if(!((D=O.current)!==null&&D!==void 0&&D.has(V.key.toString()))){var $;($=O.current)===null||$===void 0||$.set(V.key.toString(),cr())}var j=(M=O.current)===null||M===void 0?void 0:M.get(V.key.toString());return s(s({},V),{},{uuid:j})})},[g]),B=f.useMemo(function(){var V=s({},l),D=Y.length;return i!=null&&i.beforeAddRow?V.add=ce(z().mark(function M(){var $,j,A,v,P,T=arguments;return z().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:for($=T.length,j=new Array($),A=0;A<$;A++)j[A]=T[A];return C.next=3,i.beforeAddRow.apply(i,j.concat([D]));case 3:if(v=C.sent,!v){C.next=8;break}return P=l.add.apply(l,j),b==null||b.apply(void 0,j.concat([D+1])),C.abrupt("return",P);case 8:return C.abrupt("return",!1);case 9:case"end":return C.stop()}},M)})):V.add=ce(z().mark(function M(){var $,j,A,v,P=arguments;return z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:for($=P.length,j=new Array($),A=0;A<$;A++)j[A]=P[A];return v=l.add.apply(l,j),b==null||b.apply(void 0,j.concat([D+1])),w.abrupt("return",v);case 4:case"end":return w.stop()}},M)})),i!=null&&i.beforeRemoveRow?V.remove=ce(z().mark(function M(){var $,j,A,v,P,T=arguments;return z().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:for($=T.length,j=new Array($),A=0;A<$;A++)j[A]=T[A];return C.next=3,i.beforeRemoveRow.apply(i,j.concat([D]));case 3:if(v=C.sent,!v){C.next=8;break}return P=l.remove.apply(l,j),p==null||p.apply(void 0,j.concat([D-1])),C.abrupt("return",P);case 8:return C.abrupt("return",!1);case 9:case"end":return C.stop()}},M)})):V.remove=ce(z().mark(function M(){var $,j,A,v,P=arguments;return z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:for($=P.length,j=new Array($),A=0;A<$;A++)j[A]=P[A];return v=l.remove.apply(l,j),p==null||p.apply(void 0,j.concat([D-1])),w.abrupt("return",v);case 4:case"end":return w.stop()}},M)})),V},[l,i==null?void 0:i.beforeAddRow,i==null?void 0:i.beforeRemoveRow,b,p,Y.length]),_=f.useMemo(function(){if(t===!1||Y.length===c)return null;var V=t||{},D=V.position,M=D===void 0?"bottom":D,$=V.creatorButtonText,j=$===void 0?n.getMessage("editableTable.action.add","添加一行数据"):$;return R.jsx(Ue,s(s({className:"".concat(o,"-creator-button-").concat(M," ").concat(U||"").trim(),type:"dashed",loading:S,block:!0,icon:R.jsx(wr,{})},Ee(t||{},["position","creatorButtonText"])),{},{onClick:ce(z().mark(function A(){var v,P;return z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return E(!0),P=Y.length,M==="top"&&(P=0),w.next=5,B.add((v=fr(u))!==null&&v!==void 0?v:{},P);case 5:E(!1);case 6:case"end":return w.stop()}},A)})),children:j}))},[t,Y.length,c,n,o,U,S,B,u]),G=f.useContext(qe),H=s({width:"max-content",maxWidth:"100%",minWidth:"100%"},I),Q=f.useMemo(function(){return Y.map(function(V,D){return f.createElement(Qr,s(s({},e),{},{key:V.uuid,field:V,index:D,action:B,count:Y.length}),a)})},[a,e,Y,B]);return G.mode==="read"||e.readonly===!0?R.jsx(R.Fragment,{children:Q}):R.jsxs("div",{style:H,className:h,children:[t!==!1&&(t==null?void 0:t.position)==="top"&&_,Q,m&&m(B,d),t!==!1&&(t==null?void 0:t.position)!=="top"&&_]})},Jr=function(e){return k(k({},"".concat(e.antCls,"-pro"),k({},"".concat(e.antCls,"-form:not(").concat(e.antCls,"-form-horizontal)"),k({},e.componentCls,k({},"&-item:not(".concat(e.componentCls,"-item-show-label)"),k({},"".concat(e.antCls,"-form-item-label"),{display:"none"}))))),e.componentCls,k(k({maxWidth:"100%","&-item":{"&&-show-label":k({},"".concat(e.antCls,"-form-item-label"),{display:"inline-block"}),"&&-default:first-child":{"div:first-of-type":k({},"".concat(e.antCls,"-form-item"),k({},"".concat(e.antCls,"-form-item-label"),{display:"inline-block"}))},"&&-default:not(:first-child)":{"div:first-of-type":k({},"".concat(e.antCls,"-form-item"),k({},"".concat(e.antCls,"-form-item-label"),{display:"none"}))}},"&-action":{display:"flex",height:e.controlHeight,marginBlockEnd:e.marginLG,lineHeight:e.controlHeight+"px","&-small":{height:e.controlHeightSM,lineHeight:e.controlHeightSM}},"&-action-icon":{marginInlineStart:8,cursor:"pointer",transition:"color 0.3s ease-in-out","&:hover":{color:e.colorPrimaryTextHover}}},"".concat(e.proComponentsCls,"-card ").concat(e.proComponentsCls,"-card-extra"),k({},e.componentCls,{"&-action":{marginBlockEnd:0}})),"&-creator-button-top",{marginBlockEnd:24}))};function Zr(r){return ur("ProFormList",function(e){var n=s(s({},e),{},{componentCls:".".concat(r)});return[Jr(n)]})}var en=["transform","actionRender","creatorButtonProps","label","alwaysShowItemLabel","tooltip","creatorRecord","itemRender","rules","itemContainerRender","fieldExtraRender","copyIconProps","children","deleteIconProps","actionRef","style","prefixCls","actionGuard","min","max","colProps","wrapperCol","rowProps","onAfterAdd","onAfterRemove","isValidateList","emptyListMessage","className","containerClassName","containerStyle","readonly"],Oe=se.createContext({});function mn(r){var e=f.useRef(),n=f.useContext(de.ConfigContext),t=f.useContext(Oe),o=n.getPrefixCls("pro-form-list"),a=We(),u=se.useContext(dr),l=u.setFieldValueType,g=r.transform,i=r.actionRender,c=r.creatorButtonProps,m=r.label,d=r.alwaysShowItemLabel,h=r.tooltip,I=r.creatorRecord,b=r.itemRender,p=r.rules,F=r.itemContainerRender,U=r.fieldExtraRender,O=r.copyIconProps,y=O===void 0?{Icon:ar,tooltipText:a.getMessage("copyThisLine","复制此项")}:O,L=r.children,S=r.deleteIconProps,E=S===void 0?{Icon:or,tooltipText:a.getMessage("deleteThisLine","删除此项")}:S,Y=r.actionRef,B=r.style,_=r.prefixCls,G=r.actionGuard,H=r.min,Q=r.max,V=r.colProps,D=r.wrapperCol,M=r.rowProps,$=r.onAfterAdd,j=r.onAfterRemove,A=r.isValidateList,v=A===void 0?!1:A,P=r.emptyListMessage,T=P===void 0?"列表不能为空":P,w=r.className,C=r.containerClassName,re=r.containerStyle,ae=r.readonly,Z=xe(r,en),ee=He({colProps:V,rowProps:M}),we=ee.ColWrapper,Pe=ee.RowWrapper,ne=f.useContext(lr),oe=f.useMemo(function(){return t.name===void 0?[Z.name].flat(1):[t.name,Z.name].flat(1)},[t.name,Z.name]);f.useImperativeHandle(Y,function(){return s(s({},e.current),{},{get:function(le){return ne.formRef.current.getFieldValue([].concat(je(oe),[le]))},getList:function(){return ne.formRef.current.getFieldValue(je(oe))}})},[oe,ne.formRef]),f.useEffect(function(){Ne(!!ne.formRef,"ProFormList 必须要放到 ProForm 中,否则会造成行为异常。"),Ne(!!ne.formRef,"Proformlist must be placed in ProForm, otherwise it will cause abnormal behavior.")},[ne.formRef]),f.useEffect(function(){!l||!r.name||l([r.name].flat(1).filter(function(ie){return ie!==void 0}),{valueType:"formList",transform:g})},[r.name,l,g]);var ve=Zr(o),Fe=ve.wrapSSR,ge=ve.hashId;return ne.formRef?Fe(R.jsx(we,{children:R.jsx("div",{className:ye(o,ge),style:B,children:R.jsx(be.Item,s(s({label:m,prefixCls:_,tooltip:h,style:B,required:p==null?void 0:p.some(function(ie){return ie.required}),wrapperCol:D,className:w},Z),{},{name:v?oe:void 0,rules:v?[{validator:function(le,x){return!x||x.length===0?Promise.reject(new Error(T)):Promise.resolve()},required:!0}]:void 0,children:R.jsx(be.List,s(s({rules:p},Z),{},{name:oe,children:function(le,x,X){return e.current=x,R.jsxs(Pe,{children:[R.jsx(Xr,{name:oe,readonly:!!ae,originName:Z.name,copyIconProps:y,deleteIconProps:E,formInstance:ne.formRef.current,prefixCls:o,meta:X,fields:le,itemContainerRender:F,itemRender:b,fieldExtraRender:U,creatorButtonProps:c,creatorRecord:I,actionRender:i,action:x,actionGuard:G,alwaysShowItemLabel:d,min:H,max:Q,count:le.length,onAfterAdd:function(q,N,W){v&&ne.formRef.current.validateFields([oe]),$==null||$(q,N,W)},onAfterRemove:function(q,N){v&&N===0&&ne.formRef.current.validateFields([oe]),j==null||j(q,N)},containerClassName:C,containerStyle:re,children:L}),R.jsx(be.ErrorList,{errors:X.errors})]})}}))}))})})):null}var rn=function(e){var n=We(),t=be.useFormInstance();if(e.render===!1)return null;var o=e.onSubmit,a=e.render,u=e.onReset,l=e.searchConfig,g=l===void 0?{}:l,i=e.submitButtonProps,c=e.resetButtonProps,m=br.useToken(),d=m.token,h=function(){t.submit(),o==null||o()},I=function(){t.resetFields(),u==null||u()},b=g.submitText,p=b===void 0?n.getMessage("tableForm.submit","提交"):b,F=g.resetText,U=F===void 0?n.getMessage("tableForm.reset","重置"):F,O=[];c!==!1&&O.push(f.createElement(Ue,s(s({},Ee(c??{},["preventDefault"])),{},{key:"rest",onClick:function(S){var E;c!=null&&c.preventDefault||I(),c==null||(E=c.onClick)===null||E===void 0||E.call(c,S)}}),U)),i!==!1&&O.push(f.createElement(Ue,s(s({type:"primary"},Ee(i||{},["preventDefault"])),{},{key:"submit",onClick:function(S){var E;i!=null&&i.preventDefault||h(),i==null||(E=i.onClick)===null||E===void 0||E.call(i,S)}}),p));var y=a?a(s(s({},e),{},{form:t,submit:h,reset:I}),O):O;return y?Array.isArray(y)?(y==null?void 0:y.length)<1?null:(y==null?void 0:y.length)===1?y[0]:R.jsx("div",{style:{display:"flex",gap:d.marginXS,alignItems:"center"},children:y}):y:null};const nn=rn;var tn=["children","contentRender","submitter","fieldProps","formItemProps","groupProps","transformKey","formRef","onInit","form","loading","formComponentType","extraUrlParams","syncToUrl","onUrlSearchChange","onReset","omitNil","isKeyPressSubmit","autoFocusFirstInput","grid","rowProps","colProps"],an=["extraUrlParams","syncToUrl","isKeyPressSubmit","syncToUrlAsImportant","syncToInitialValues","children","contentRender","submitter","fieldProps","proFieldProps","formItemProps","groupProps","dateFormatter","formRef","onInit","form","formComponentType","onReset","grid","rowProps","colProps","omitNil","request","params","initialValues","formKey","readonly","onLoadingChange","loading"],$e=function(e,n,t){return e===!0?n:fr(e,n,t)},nr=function(e){return!e||Array.isArray(e)?e:[e]};function on(r){var e,n=r.children,t=r.contentRender,o=r.submitter;r.fieldProps,r.formItemProps,r.groupProps;var a=r.transformKey,u=r.formRef,l=r.onInit,g=r.form,i=r.loading;r.formComponentType;var c=r.extraUrlParams,m=c===void 0?{}:c,d=r.syncToUrl,h=r.onUrlSearchChange,I=r.onReset,b=r.omitNil,p=b===void 0?!0:b;r.isKeyPressSubmit;var F=r.autoFocusFirstInput,U=F===void 0?!0:F,O=r.grid,y=r.rowProps,L=r.colProps,S=xe(r,tn),E=be.useFormInstance(),Y=(de===null||de===void 0||(e=de.useConfig)===null||e===void 0?void 0:e.call(de))||{componentSize:"middle"},B=Y.componentSize,_=f.useRef(g||E),G=He({grid:O,rowProps:y}),H=G.RowWrapper,Q=Te(function(){return E}),V=f.useMemo(function(){return{getFieldsFormatValue:function(P){var T;return a((T=Q())===null||T===void 0?void 0:T.getFieldsValue(P),p)},getFieldFormatValue:function(){var P,T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],w=nr(T);if(!w)throw new Error("nameList is require");var C=(P=Q())===null||P===void 0?void 0:P.getFieldValue(w),re=w?pe({},w,C):C,ae=je(w);return ae.shift(),Be(a(re,p,ae),w)},getFieldFormatValueObject:function(P){var T,w=nr(P),C=(T=Q())===null||T===void 0?void 0:T.getFieldValue(w),re=w?pe({},w,C):C;return a(re,p,w)},validateFieldsReturnFormatValue:function(){var v=ce(z().mark(function T(w){var C,re,ae;return z().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!(!Array.isArray(w)&&w)){ee.next=2;break}throw new Error("nameList must be array");case 2:return ee.next=4,(C=Q())===null||C===void 0?void 0:C.validateFields(w);case 4:return re=ee.sent,ae=a(re,p),ee.abrupt("return",ae||{});case 7:case"end":return ee.stop()}},T)}));function P(T){return v.apply(this,arguments)}return P}()}},[p,a]),D=f.useMemo(function(){return se.Children.toArray(n).map(function(v,P){return P===0&&se.isValidElement(v)&&U?se.cloneElement(v,s(s({},v.props),{},{autoFocus:U})):v})},[U,n]),M=f.useMemo(function(){return typeof o=="boolean"||!o?{}:o},[o]),$=f.useMemo(function(){if(o!==!1)return R.jsx(nn,s(s({},M),{},{onReset:function(){var P,T,w=a((P=_.current)===null||P===void 0?void 0:P.getFieldsValue(),p);if(M==null||(T=M.onReset)===null||T===void 0||T.call(M,w),I==null||I(w),d){var C,re=Object.keys(a((C=_.current)===null||C===void 0?void 0:C.getFieldsValue(),!1)).reduce(function(ae,Z){return s(s({},ae),{},k({},Z,w[Z]||void 0))},m);h($e(d,re||{},"set"))}},submitButtonProps:s({loading:i},M.submitButtonProps)}),"submitter")},[o,M,i,a,p,I,d,m,h]),j=f.useMemo(function(){var v=O?R.jsx(H,{children:D}):D;return t?t(v,$,_.current):v},[O,H,D,t,$]),A=Or(r.initialValues);return f.useEffect(function(){if(!(d||!r.initialValues||!A||S.request)){var v=Ie(r.initialValues,A);Ne(v,"initialValues 只在 form 初始化时生效，如果你需要异步加载推荐使用 request，或者 initialValues ? <Form/> : null "),Ne(v,"The initialValues only take effect when the form is initialized, if you need to load asynchronously recommended request, or the initialValues ? <Form/> : null ")}},[r.initialValues]),f.useImperativeHandle(u,function(){return s(s({},_.current),V)},[V,_.current]),f.useEffect(function(){var v,P,T=a((v=_.current)===null||v===void 0||(P=v.getFieldsValue)===null||P===void 0?void 0:P.call(v,!0),p);l==null||l(T,s(s({},_.current),V))},[]),R.jsx(lr.Provider,{value:s(s({},V),{},{formRef:_}),children:R.jsx(de,{componentSize:S.size||B,children:R.jsxs(mr.Provider,{value:{grid:O,colProps:L},children:[S.component!==!1&&R.jsx("input",{type:"text",style:{display:"none"}}),j]})})})}var tr=0;function vn(r){var e=r.extraUrlParams,n=e===void 0?{}:e,t=r.syncToUrl,o=r.isKeyPressSubmit,a=r.syncToUrlAsImportant,u=a===void 0?!1:a,l=r.syncToInitialValues,g=l===void 0?!0:l;r.children,r.contentRender,r.submitter;var i=r.fieldProps,c=r.proFieldProps,m=r.formItemProps,d=r.groupProps,h=r.dateFormatter,I=h===void 0?"string":h,b=r.formRef;r.onInit;var p=r.form,F=r.formComponentType;r.onReset,r.grid,r.rowProps,r.colProps;var U=r.omitNil,O=U===void 0?!0:U,y=r.request,L=r.params,S=r.initialValues,E=r.formKey,Y=E===void 0?tr:E;r.readonly;var B=r.onLoadingChange,_=r.loading,G=xe(r,an),H=f.useRef({}),Q=Pr(!1,{onChange:B,value:_}),V=me(Q,2),D=V[0],M=V[1],$=Yr({},{disabled:!t}),j=me($,2),A=j[0],v=j[1],P=f.useRef(cr());f.useEffect(function(){tr+=0},[]);var T=Vr({request:y,params:L,proFieldKey:Y}),w=me(T,1),C=w[0],re=f.useContext(de.ConfigContext),ae=re.getPrefixCls,Z=ae("pro-form"),ee=ur("ProForm",function(q){return k({},".".concat(Z),k({},"> div:not(".concat(q.proComponentsCls,"-form-light-filter)"),{".pro-field":{maxWidth:"100%","@media screen and (max-width: 575px)":{maxWidth:"calc(93vw - 48px)"},"&-xs":{width:104},"&-s":{width:216},"&-sm":{width:216},"&-m":{width:328},"&-md":{width:328},"&-l":{width:440},"&-lg":{width:440},"&-xl":{width:552}}}))}),we=ee.wrapSSR,Pe=ee.hashId,ne=f.useState(function(){return t?$e(t,A,"get"):{}}),oe=me(ne,2),ve=oe[0],Fe=oe[1],ge=f.useRef({}),ie=f.useRef({}),le=Te(function(q,N,W){return Dr(Nr(q,I,ie.current,N,W),ge.current,N)});f.useEffect(function(){g||Fe({})},[g]);var x=Te(function(){return s(s({},A),n)});f.useEffect(function(){t&&v($e(t,x(),"set"))},[n,x,t]);var X=f.useMemo(function(){if(!(typeof window>"u")&&F&&["DrawerForm"].includes(F))return function(q){return q.parentNode||document.body}},[F]),te=Te(ce(z().mark(function q(){var N,W,K,fe,he,Se,Ce;return z().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(G.onFinish){ue.next=2;break}return ue.abrupt("return");case 2:if(!D){ue.next=4;break}return ue.abrupt("return");case 4:return ue.prev=4,K=H==null||(N=H.current)===null||N===void 0||(W=N.getFieldsFormatValue)===null||W===void 0?void 0:W.call(N),fe=G.onFinish(K),fe instanceof Promise&&M(!0),ue.next=10,fe;case 10:t&&(Ce=Object.keys(H==null||(he=H.current)===null||he===void 0||(Se=he.getFieldsFormatValue)===null||Se===void 0?void 0:Se.call(he,void 0,!1)).reduce(function(Re,ke){var _e;return s(s({},Re),{},k({},ke,(_e=K[ke])!==null&&_e!==void 0?_e:void 0))},n),Object.keys(A).forEach(function(Re){Ce[Re]!==!1&&Ce[Re]!==0&&!Ce[Re]&&(Ce[Re]=void 0)}),v($e(t,Ce,"set"))),M(!1),ue.next=18;break;case 14:ue.prev=14,ue.t0=ue.catch(4),ue.t0,M(!1);case 18:case"end":return ue.stop()}},q,null,[[4,14]])})));return f.useImperativeHandle(b,function(){return H.current},[!C]),!C&&r.request?R.jsx("div",{style:{paddingTop:50,paddingBottom:50,textAlign:"center"},children:R.jsx(Cr,{})}):we(R.jsx(qe.Provider,{value:{mode:r.readonly?"read":"edit"},children:R.jsx(xr,{needDeps:!0,children:R.jsx(dr.Provider,{value:{formRef:H,fieldProps:i,proFieldProps:c,formItemProps:m,groupProps:d,formComponentType:F,getPopupContainer:X,formKey:P.current,setFieldValueType:function(N,W){var K=W.valueType,fe=K===void 0?"text":K,he=W.dateFormat,Se=W.transform;Array.isArray(N)&&(ge.current=pe(ge.current,N,Se),ie.current=pe(ie.current,N,{valueType:fe,dateFormat:he}))}},children:R.jsx(Oe.Provider,{value:{},children:R.jsx(be,s(s({onKeyPress:function(N){if(o&&N.key==="Enter"){var W;(W=H.current)===null||W===void 0||W.submit()}},autoComplete:"off",form:p},Ee(G,["ref","labelWidth","autoFocusFirstInput"])),{},{ref:function(N){H.current&&(H.current.nativeElement=N==null?void 0:N.nativeElement)},initialValues:u?s(s(s({},S),C),ve):s(s(s({},ve),S),C),onValuesChange:function(N,W){var K;G==null||(K=G.onValuesChange)===null||K===void 0||K.call(G,le(N,!!O),le(W,!!O))},className:ye(r.className,Z,Pe),onFinish:te,children:R.jsx(on,s(s({transformKey:le,autoComplete:"off",loading:D,onUrlSearchChange:v},r),{},{formRef:H,initialValues:s(s({},S),C)}))}))})})})}))}export{vn as B,qe as E,dr as F,mr as G,lr as P,He as a,Or as b,dn as c,mn as d,Hr as e,Ve as f,Oe as g,Mr as h,Ie as i,_r as m,cr as n,fr as r,Te as u};
//# sourceMappingURL=BaseForm-1ece3359.js.map
