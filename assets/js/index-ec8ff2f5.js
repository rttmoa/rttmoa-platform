import{ak as O,al as P,r as u,j as e,aa as f,a as le,C as se,B as v,W as R,bG as ae,bm as ie,V,aP as ne,M as re,k as $,am as z,T as L}from"./index-e56a422c.js";import{C as de}from"./index-4bdb91c4.js";import{S as N}from"./index-062133e8.js";import{D as Y}from"./index-44cb417a.js";import{T as ce}from"./index-1763ccee.js";import{r as oe}from"./roleManage-0f512a12.js";import ue from"./UserFormModal-04900fc8.js";import{C as K}from"./index-3b3621a9.js";import{P as me}from"./index-213789d4.js";import"./index-0ade8a8c.js";import"./index-1b7687c3.js";import"./List-e3176c57.js";import"./useIcons-da519b29.js";import"./customParseFormat-960dc75d.js";import"./___vite-browser-external_commonjs-proxy-a925e521.js";import"./Table-1513621a.js";import"./styleChecker-e91e8398.js";import"./iconUtil-cec25390.js";import"./conductUtil-3f51dcc5.js";import"./index-a2ee4857.js";import"./index-77d5b257.js";import"./Skeleton-4cfa936e.js";const he=a=>O.get(P+"/user/manage/list",a),xe=a=>O.post(P+"/user/manage/create",a),fe=a=>O.post(P+"/user/manage/edit",a);function A(a=[]){if(!a)return[];let d=[];return a.forEach(m=>{d.push(e.jsx(N.Option,{value:m.id,children:m.name},m.id))}),d}function _(a){if(!a)return"";const d=new Date(a),m=d.getMonth()<9?`0${d.getMonth()+1}`:d.getMonth()+1,i=d.getDate()<10?`0${d.getDate()}`:d.getDate();return`${d.getFullYear()}-${m}-${i}`}function pe(a){const{filterSubmit:d,multiForm:m}=a,[i,p]=u.useState(!1),C=()=>{let s=m.getFieldsValue();s.startTime&&(s.startTime=_(s.startTime)),s.endTime&&(s.endTime=_(s.endTime)),d&&d(s)},l=()=>{m.resetFields()},o=()=>{const{formList:s,extendFormList:n}=a;let c=[];return s&&s.length>0&&s.forEach((j,I)=>{const{label:h,field:y,tree:b,type:w,initialValue:S,placeholder:g,width:k,name:E}=j;switch(w){case"TIME":c.push(e.jsx(f.Item,{name:"startTime",label:"开始时间",children:e.jsx(Y,{style:k,showTime:!0,placeholder:g,format:"YYYY-MM-DD hh:mm:ss"})},"startTime"),e.jsx(f.Item,{label:"结束时间",name:"endTime",children:e.jsx(Y,{style:k,showTime:!0,placeholder:g,format:"YYYY-MM-DD hh:mm:ss"})},"endTime"));break;case"INPUT":c.push(e.jsx(f.Item,{name:y,label:h,children:e.jsx(R,{type:"text",style:{width:k},placeholder:g})},y));break;case"SELECT":c.push(e.jsx(f.Item,{name:y,label:h,children:e.jsx(N,{style:{width:k},placeholder:g,children:A(j.list)})},y));break;case"CHECKBOX":c.push(e.jsx(f.Item,{name:y,label:h,children:e.jsx(de,{children:h})},y));break}}),n&&n.length>0&&n.forEach(j=>{const{label:I,field:h,tree:y,type:b,initialValue:w,placeholder:S,width:g,name:k,style:E}=j;if(b==="INPUT"){const F=e.jsx(f.Item,{name:h,label:I,style:E,children:e.jsx(R,{type:"text",placeholder:S,style:{width:g}})},h);i===!0?c.push(F):c.push([])}else if(b==="SELECT"){const F=e.jsx(f.Item,{name:h,label:I,style:E,children:e.jsx(N,{style:{width:g},placeholder:S,children:A(j.list)})},h);i===!0?c.push(F):c.push([])}}),c};return e.jsx("div",{children:e.jsx(f,{layout:"inline",form:m,children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx(le,{style:{width:"calc(100% - 300px)"},gutter:[32,24],children:o().map((s,n)=>e.jsx(se,{span:8,children:s}))}),e.jsx("div",{style:{width:300,position:"fixed",right:0},children:e.jsxs(f.Item,{children:[e.jsx(v,{type:"primary",onClick:C,children:"查询"}),e.jsx(v,{className:"mx-3",onClick:l,children:"重置"}),e.jsx("a",{href:"javascript:;",onClick:()=>{p(!i)},children:a&&a.extendFormList&&a.extendFormList.length>0?i===!1?"展开":"收起":""})]})})]})})})}const je=[{type:"INPUT",label:"用户名",field:"user_name",placeholder:"请输入用户名",initialValue:"",width:200},{type:"INPUT",label:"联系地址",field:"address",placeholder:"请输入联系地址",initialValue:"",width:200},{type:"SELECT",label:"婚姻状态",field:"isMarried",placeholder:"全部",initialValue:"0",width:200,list:[{id:"0",name:"全部"},{id:"1",name:"未婚"},{id:"2",name:"已婚"}]},{type:"SELECT",label:"性别",field:"sex",placeholder:"全部",initialValue:3,width:200,list:[{id:3,name:"全部"},{id:0,name:"女"},{id:1,name:"男"}]}],ye=[{type:"TIME",width:200},{type:"INPUT",placeholder:"请输入电影名",width:200,label:"电影",field:"movies"},{type:"SELECT",placeholder:"请选择电影",width:200,label:"选择种类",field:"kinds1",name:"key",list:[{id:1,key:"泰坦尼克号"},{id:2,key:"阿凡达"},{id:3,key:"蜘蛛侠"}]}],ge=[{title:"物流状态(单)",key:"state",options:[{label:"全部",value:""},{label:"已下单",value:"1",icon:"ShoppingCartOutlined"},{label:"已发货",value:"2",icon:"CarOutlined"},{label:"已签收",value:"3",icon:"FormOutlined"},{label:"已退回",value:"4",icon:"CloseCircleOutlined"},{label:"已完成",value:"5",icon:"CheckSquareOutlined"}]},{title:"商品类型(多)",key:"type",multiple:!0,options:[{label:"全部",value:""},{label:"食品类",value:"1"},{label:"服装类",value:"2"},{label:"家具类",value:"3"},{label:"日用品类",value:"4"}]}];function ke({data:a,defaultValue:d,selectChange:m}){const[i,p]=u.useState({});u.useEffect(()=>{a.forEach(l=>{l.multiple?p(o=>({...o,[l.key]:d[l.key]||[""]})):p(o=>({...o,[l.key]:d[l.key]||""}))})},[]);const C=(l,o)=>{if(!l.multiple)i[l.key]!==o.value&&p(s=>({...s,[l.key]:o.value}));else if(l.options[0].value===o.value&&p(s=>({...s,[l.key]:[o.value]})),i[l.key].includes(o.value)){let s=i[l.key].findIndex(n=>n===o.value);p(n=>({...n,[l.key]:i[l.key].filter(c=>c!==i[l.key].splice(s,1))}))}else p(s=>({...s,[l.key]:[...s[l.key],o.value]})),i[l.key].includes(l.options[0].value);m&&m(i)};return e.jsx("div",{className:"select-filter",children:a.map((l,o)=>{var s;return e.jsxs("div",{className:"select-filter-item",children:[e.jsx("div",{className:"select-filter-item-title",children:e.jsxs("span",{children:[l.title,"："]})}),e.jsx("div",{children:(s=l.options)!=null&&s.length?e.jsx("ul",{className:"select-filter-list",children:l.options.map((n,c)=>{const j=n.value===i[l.key],I=Array.isArray(i[l.key])&&i[l.key].includes(n.value);return e.jsxs("li",{className:`${j&&"active"||I&&"active"}`,onClick:()=>{C(l,n)},children:[n.icon&&e.jsx(ae,{name:n.icon}),e.jsx("span",{children:n.label})]},n.value)})}):e.jsx("span",{className:"select-filter-noData",children:"暂无数据"})})]},l.key)})})}const Ae=()=>{const[a,d]=u.useState({}),[m,i]=u.useState([]),[p,C]=u.useState(!1),[l,o]=u.useState([]),[s,n]=u.useState({page:1,pageSize:10,totalCount:0}),[c,j]=u.useState({selectedRowKeys:[],selectedIds:[],selectedItem:{}}),[I,h]=u.useState(!1),[y,b]=u.useState(""),[w,S]=u.useState(""),[g,k]=u.useState({}),[E,F]=u.useState({}),[B,q]=u.useState({state:"1",type:["1","3"]}),[U]=f.useForm(),[G]=f.useForm(),H=()=>{C(!0),setTimeout(()=>{const{page:t,pageSize:r}=s;let x={page:t,pageSize:r,...E};he(x).then(T=>{C(!1);const D=T.data.list.map((ee,te)=>({...ee,key:te}));o(D.splice(0,r)),n({page:T.data.page,pageSize:T.data.page_size,totalCount:T.data.total_count})})},500)},J=()=>{oe().then(t=>{let r=t.data.list;const x=r.reduce((T,D)=>(T[D.id]=D.role_name,T),{});d(x||[]),i(r)})};u.useEffect(()=>{H(),J()},[s.page,s.pageSize]);const W=[{title:"id",dataIndex:"id",width:80,fixed:"left"},{title:"用户名",dataIndex:"username",width:80,fixed:"left"},{title:"性别",dataIndex:"sex",render:t=>t===1?"男":"女"},{title:"状态",dataIndex:"state",render:t=>({1:e.jsx(L,{color:"green",children:"痛苦"}),2:e.jsx(L,{color:"blue",children:"委屈"}),3:e.jsx(L,{color:"orange",children:"迷茫"}),4:e.jsx(L,{color:"red",children:"平淡"}),5:e.jsx(L,{color:"purple",children:"开心"})})[t]},{title:"爱好",dataIndex:"interest",render:t=>({1:"游泳",2:"打篮球",3:"踢足球",4:"跑步",5:"爬山",6:"骑行",7:"桌球",8:"麦霸"})[t]},{title:"婚姻状态",dataIndex:"isMarried",render(t){return t?e.jsx($,{status:"success",text:"已婚"}):e.jsx($,{status:"error",text:"未婚"})}},{title:"所属角色",dataIndex:"role_id",render:t=>a[t]},{title:"手机号",render(){let x=(15303663375+"").replace(/(\d{3})\d*(\d{4})/g,"$1***$2");return e.jsx("span",{children:x})}},{title:"身份证号",render(){let x=(231085199811011415n+"").replace(/(\d{3})\d*(\d{4})/g,"$1***********$2");return e.jsx("span",{children:x})}},{title:"联系地址",dataIndex:"address"},{title:"邮箱",dataIndex:"email"},{title:"生日",dataIndex:"birthday"},{title:"早起时间",dataIndex:"time"},{title:"操作",fixed:"right",width:200,render(t){return e.jsxs(V,{children:[e.jsx(v,{size:"small",onClick:()=>{M("detail",t)},children:"详情"}),e.jsx(v,{size:"small",onClick:()=>{M("edit",t)},children:"编辑"}),e.jsx(v,{size:"small",onClick:()=>{M("delete",t)},children:"删除"})]})}}],M=(t,r)=>{t==="create"?(h(!0),b("新建用户"),S(t)):["edit","detail"].includes(t)?(b(t==="edit"?"编辑用户":"查看详情"),S(t),k(r),h(!0)):t==="delete"?z.success(`删除用户成功！ id：${r.id}`):t==="moreDelete"&&z.success(`删除更多用户成功！ id：${JSON.stringify(c.selectedIds)}`)},X=()=>{let t=w,r=U.getFieldsValue();t==="create"?xe(r):fe(r)},Q=t=>{q(t)},Z=e.jsxs("div",{children:[e.jsx(K,{className:"mb20",style:{},children:e.jsx(ie,{defaultActiveKey:"1",centered:!0,items:[{label:"输入框查询",key:"1",children:e.jsx(pe,{multiForm:G,formList:je,extendFormList:ye,filterSubmit:(t={})=>{F(t)}})},{label:"选择框查询",key:"2",children:e.jsx(ke,{data:ge,defaultValue:B,selectChange:Q})}]})}),e.jsx(K,{className:"mb30",title:"用户列表",extra:e.jsxs(V,{size:"large",children:[e.jsx(v,{size:"middle",onClick:()=>{M("create",null)},children:"新建"}),e.jsx(me,{title:"批量删除",description:"你确定要删除吗？",okText:"确定",cancelText:"取消",onConfirm:()=>{M("moreDelete",null)},children:e.jsx(v,{size:"middle",disabled:c.selectedRowKeys.length<=1,icon:e.jsx(ne,{}),children:"批量删除"})})]}),style:{width:"100%"},children:e.jsx(ce,{rowSelection:"checkbox",columns:W,dataSource:l,pagination:s,selectedRowKeys:c.selectedRowKeys,selectedIds:c.selectedIds,selectedItem:c.selectedItem,updateSelectedItem:(t,r,x)=>{j({selectedRowKeys:t,selectedIds:x&&x.length>0?x:[],selectedRows:r})},updatePage:(t,r)=>{n(x=>({...x,page:t,pageSize:r}))},loading:p,id:"cart-scrollTable",xScroll:!0})}),e.jsx(re,{width:800,title:y,open:I,onOk:X,onCancel:()=>{b(""),h(!1),S(""),k({})},children:e.jsx(ue,{roles:m,userInfo:g,type:w,form:U})})]});return e.jsx(e.Fragment,{children:Z})};export{Ae as default};
