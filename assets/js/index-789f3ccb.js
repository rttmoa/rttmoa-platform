import{r as o,j as t,M as O,aC as V,B as D,a1 as _}from"./index-487798a4.js";import{r as z,u as K}from"./xlsx-964ea548.js";import{S as N}from"./index-79e00cd3.js";import{T as M}from"./Table-08799662.js";import"./Select-0711de6c.js";import"./List-cbde957a.js";import"./useIcons-63d83608.js";import"./index-20ae0f26.js";import"./zh_CN-759a4edf.js";import"./styleChecker-e5bf4446.js";import"./Tree-d2f141e9.js";import"./conductUtil-a07cc58e.js";import"./index-708d3030.js";import"./index-fb4ec38d.js";import"./index-42bc38f7.js";import"./useBubbleLock-37cca063.js";import"./index-8465edc1.js";import"./index-09b65487.js";import"./iconUtil-0160a478.js";const ce=()=>{const[T,p]=o.useState([]),[E,S]=o.useState([]),[k,g]=o.useState(!1),[b,v]=o.useState(),[C,U]=o.useState([]),[A,B]=o.useState(""),[d,y]=o.useState(""),j=(e,a)=>{S([]),p([]),a||y(""),g(!0);const l=new FileReader;l.onload=u=>{const n=new Uint8Array(u.target.result),i=z(n,{type:"array"}),L=a?i.Sheets[a]:i.Sheets[i.SheetNames[0]],c=K.sheet_to_json(L,{header:1}),w=i.SheetNames.map(r=>({label:r,value:r}));if(U(w),y(a||w[0].value),c.length>0){const r=[];c.slice(1).forEach((s,h)=>{if(s.length===0)return!1;const x={key:h};c[0].forEach((m,f)=>{x[m]=s[f]}),r.push(x)});const J=c[0].map(s=>({title:s,dataIndex:s,key:s,align:"center",render:(h,x,m)=>t.jsx(_,{style:{color:"#000",height:"100%",textAlign:"center"},bordered:!1,defaultValue:h,onBlur:f=>{F(f.target.value,m,s,r)}},m)}));S(J),p(r)}g(!1)},l.readAsArrayBuffer(e)},F=(e,a,l,u)=>{const n=JSON.parse(JSON.stringify(u));n[a][l]=e,p(n)},I=()=>{},R=e=>{b&&j(b,e)};return t.jsxs("div",{className:"TableDataImport",children:[t.jsxs("div",{className:"fileUpDiv",style:{marginTop:10},children:[t.jsx("span",{style:{marginRight:42},children:"文件名称"}),t.jsx("span",{className:"fileName",children:A}),t.jsx(O,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(B(e.name),v(e),j(e),!1):(V.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:t.jsx(D,{children:"上传Excel文件"})}),t.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!d&&t.jsx(N,{disabled:!0,style:{width:120},options:[]}),d&&t.jsx(N,{defaultValue:d,style:{width:120},onChange:R,options:C}),t.jsx(D,{type:"primary",onClick:I,children:"导入"})]}),t.jsx(M,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:k,size:"small",dataSource:T,columns:E})]})};export{ce as default};
