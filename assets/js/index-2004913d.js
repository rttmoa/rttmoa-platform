import{r as o,j as e}from"./react-12b51ca5.js";import{r as k}from"./roleManage-9a162c5b.js";import{c as Z,d as ee,e as te,g as ie,h as se}from"./userManage2-7e6593d0.js";import oe from"./treeList-6be657f6.js";import re from"./tableList-be841a9b.js";import{m,n as v}from"./index-5960db8a.js";import le from"./addPolice-9eea7b93.js";import ae from"./selectRole-f38dffef.js";import{F as f,a8 as y,h as pe,I as ne,B as g,c as z}from"./antd-e2492052.js";import"./@ant-design-63539318.js";import"./rc-util-8976b5fa.js";import"./react-dom-e71a48dd.js";import"./@babel-c46ce09a.js";import"./classnames-3ded05b8.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-5c9960e4.js";import"./@umijs-02c6bdf5.js";import"./swr-1237c4b3.js";import"./use-sync-external-store-ad55a9d4.js";import"./@dnd-kit-908a095e.js";import"./dayjs-6d610299.js";import"./@ctrl-bad846bd.js";import"./omit.js-929edb61.js";import"./lodash.merge-9922d51b.js";import"./safe-stable-stringify-023075f7.js";import"./@chenshuai2144-5a33ccd2.js";import"./reactcss-f166c0a9.js";import"./lodash-40f09dbd.js";import"./tinycolor2-ea5bcbb6.js";import"./lodash.tonumber-b59040d8.js";import"./rc-field-form-e46b50c8.js";import"./async-validator-dee29e8b.js";import"./@emotion-70f0a3ab.js";import"./stylis-d04dd720.js";import"./rc-motion-25d44171.js";import"./rc-notification-3ca02e51.js";import"./rc-overflow-7fc9dc70.js";import"./rc-picker-d202c760.js";import"./@rc-component-60bdd203.js";import"./rc-tabs-f080ce12.js";import"./rc-dropdown-1fd4539e.js";import"./rc-menu-c99c3faa.js";import"./rc-cascader-238c5b8d.js";import"./rc-select-8e380119.js";import"./rc-virtual-list-5b0902fa.js";import"./rc-tree-898f7873.js";import"./rc-input-number-f64f90f1.js";import"./rc-input-3682369a.js";import"./rc-collapse-3e02f0e2.js";import"./rc-drawer-9ef263c4.js";import"./scroll-into-view-if-needed-582d6ca4.js";import"./compute-scroll-into-view-e3f0ecc2.js";import"./rc-image-3cfe7923.js";import"./rc-dialog-8eb1683d.js";import"./rc-mentions-9823f19c.js";import"./rc-textarea-b098f88a.js";import"./rc-tooltip-01b6b839.js";import"./qrcode.react-e22f0a27.js";import"./rc-rate-2d3465a8.js";import"./rc-segmented-6536d122.js";import"./rc-slider-e91f05e6.js";import"./rc-steps-f39c48c2.js";import"./rc-switch-8d316ace.js";import"./rc-table-a211065a.js";import"./rc-checkbox-ae7b2d99.js";import"./throttle-debounce-87e7e444.js";import"./rc-pagination-334fefa5.js";import"./rc-tree-select-5a273e06.js";import"./copy-to-clipboard-47a2b094.js";import"./toggle-selection-93f4ad84.js";import"./rc-upload-71d17dfe.js";import"./rc-progress-a416f280.js";import"./react-redux-814b67d1.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@reduxjs-1e85e38e.js";import"./immer-41fd5235.js";import"./redux-9b50431e.js";import"./redux-thunk-5e43a849.js";import"./redux-persist-0e7c8dbe.js";import"./react-router-dom-6ebba419.js";import"./react-router-0b469a74.js";import"./@remix-run-26f48157.js";import"./@react-three-892cc760.js";import"./three-61b4c2af.js";import"./react-use-measure-3cc199c6.js";import"./debounce-3dd95b19.js";import"./its-fine-c588097f.js";import"./react-reconciler-70247064.js";import"./scheduler-765c72db.js";import"./react-merge-refs-239dbb3c.js";import"./zustand-942b6941.js";import"./react-i18next-172d1bb0.js";import"./axios-a342f982.js";import"./nprogress-ac7b4ba8.js";import"./antd-img-crop-c6426bab.js";import"./tslib-9305e412.js";import"./react-easy-crop-57e783c5.js";import"./normalize-wheel-e63deb77.js";import"./compare-versions-d85a82c7.js";import"./ahooks-2e5c1fd5.js";import"./screenfull-d32598f8.js";import"./react-transition-group-7a2d7ec0.js";import"./dom-helpers-9a525042.js";import"./react-colorful-c5c19197.js";import"./qs-7f9cc4dd.js";import"./side-channel-fd57f060.js";import"./get-intrinsic-369a924f.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-ebb1c907.js";import"./set-function-length-e011fe34.js";import"./define-data-property-10275fa5.js";import"./es-define-property-d670c2ca.js";import"./gopd-7cdb7e9d.js";import"./has-property-descriptors-3e3c0959.js";import"./object-inspect-17338ea2.js";import"./crypto-js-31e0a020.js";import"./md5-1d85d820.js";import"./crypt-5ea4a8e1.js";import"./charenc-bfd911d6.js";import"./is-buffer-793dba8c.js";import"./i18next-5484cd5c.js";const me=f.Item,{Content:de,Sider:ce}=y,Ai=()=>{const[C]=f.useForm(),[A]=f.useForm(),[U,S]=o.useState(""),[p,u]=o.useState({PoliceAddVisible:!1,moduletype:"",moduletitle:""}),[N,b]=o.useState(""),[R,x]=o.useState(!1),[D,h]=o.useState(!1),[V,L]=o.useState(!1),[d,ue]=o.useState({view:!0,freeze:!0,delete:!0,edit:!0,add:!0}),[r,a]=o.useState({keyword:"",pageSize:10,pageNo:1,deptCode:""}),[F,T]=o.useState({list:[],loading:!1}),[n,E]=o.useState({list:[],loading:!1}),[w,K]=o.useState({list:[],loading:!1}),[P,I]=o.useState({list:[],loading:!1}),l=t=>{ee(r).then(i=>{let s=i.data;s.list.splice(0,s.list.length-10),E({list:s}),t&&t()})};o.useEffect(()=>{k().then(t=>{I({list:t.data.list})}),Z({}).then(t=>{T({list:t.data}),a(i=>({...i,deptCode:t.data[0].deptCode})),S(t.data[0].deptName)}),l(()=>{})},[]);const M=t=>{k().then(i=>{I({list:i.data}),x(!0),b(t)})},O=t=>{te({id:t}).then(i=>{K({list:i.data}),u({PoliceAddVisible:!0,moduletype:"edit",moduletitle:"详情"}),b(t)})},$=(t,i)=>{ie({id:t,status:i}).then(s=>{m.success(s.msg),l(()=>{})})},B=t=>{if(sessionStorage.getItem("userid")===t){m.warning("自己不能删除自己");return}const i=n.list;let s=r.pageNo;se({deptcode:r.deptCode,id:t}).then(c=>{m.success(c.msg),i.totalPage>1&&i.totalCount%10===1&&(s-=1),a(j=>({...j,pageNo:s})),l(()=>{})})},G=[{title:"姓名",dataIndex:"chineseName",key:"chineseName",width:"15%"},{title:"职务",dataIndex:"post",key:"post",width:"15%",render:t=>e.jsx("span",{children:"员工"})},{title:"帐号",dataIndex:"username",key:"username",width:"15%"},{title:"帐号状态",dataIndex:"statusLabel",key:"statusLabel",width:"15%",render:(t,i,s)=>e.jsx("span",{children:i.status?"已冻结":"正常"})},{title:"角色",dataIndex:"roles",key:"roles",width:"20%",render:(t,i,s)=>{const c=[];(t||[]).map(Y=>{c.push(Y.role_name)});let j=c.length===0?"":c.join(",");return e.jsx(g,{type:"default",onClick:()=>{M(i.id)},children:j||"普通用户"})}},{title:"操作",key:"operate",render:(t,i,s)=>e.jsxs("span",{children:[d.view?e.jsxs("span",{children:[e.jsx("a",{onClick:()=>O(i.id),children:"详情"}),e.jsx("span",{className:"ant-divider"})]}):null,d.freeze?e.jsx("span",{children:e.jsx(z,{title:`确认${i.status?"解冻":"冻结"}账户?`,placement:"left",onConfirm:()=>$(i.id,`${i.status}`),children:e.jsx("a",{children:i.status?"解冻账户":"冻结账户"})})}):null,e.jsx("span",{className:"ant-divider"}),d.delete?e.jsx(z,{title:"删除用户?",placement:"left",onConfirm:()=>B(i.id),children:e.jsx("a",{children:"删除"})}):null]})}],H=(t=[],i)=>{h(!0),S(i),a(s=>({...s,deptCode:t[0],pageNo:1,keyword:""})),l(()=>{h(!1)})},_=()=>{const t=C.getFieldsValue();h(!0),a(i=>({...i,keyword:t,pageNo:1})),l(()=>{h(!1)})},q=t=>{a({pageNo:t}),l(()=>{})},J=(t,i)=>{a(s=>({...s,pageNo:1,pageSize:i}))},Q=()=>{r.deptCode?(v.info({message:`deptId是${r.deptCode}`}),u({PoliceAddVisible:!0,moduletype:"add",moduletitle:"新增"})):v.error({message:"错误",description:"请先选择部门"})},W=()=>{m.info("用户数据同步中"),L(!0),setTimeout(()=>{m.success("用户数据同步完成"),L(!1),l(()=>{})},2500)},X=()=>{const t=n.list;let i=r.pageNo;p.moduletype==="add"&&t&&t.totalCount>0&&t.totalCount%10===0&&(i+=1),u({PoliceAddVisible:!1,moduletype:"",moduletitle:""}),a(s=>({...s,pageNo:i})),l(()=>{})};return e.jsxs("div",{className:"page page-scrollfix page-usermanage",children:[e.jsx(y,{children:e.jsxs(y,{className:"page-body",children:[e.jsx(ce,{width:240,children:e.jsxs(pe,{spinning:!1,children:[e.jsx("h3",{className:"page-title",children:"城市"}),e.jsx("div",{className:"treeside",children:e.jsx(oe,{trees:F.list,curDeptCode:r.deptCode,onSelect:H})})]})}),e.jsxs(de,{children:[e.jsxs("h3",{className:"page-title",children:[U,e.jsxs("span",{className:"error",children:[" ",n.list.totalCount?n.list.totalCount:0]}),"人"]}),e.jsx("div",{className:"page-header",children:e.jsxs(f,{layout:"inline",className:"flexrow",form:C,onFinish:_,children:[e.jsx(me,{labelCol:{span:6},children:e.jsx(ne,{className:"input-base-width",placeholder:"请输入关键字进行搜索"})}),e.jsx(g,{type:"primary",size:"middle",htmlType:"submit",children:"搜索"})]})}),e.jsx("div",{className:"page-content has-pagination table-flex table-scrollfix",children:e.jsx(re,{size:"small",style:{maxHeight:800},rowKey:"id",columns:G,currentPage:r.pageNo,pageSize:r.pageSize,dataSource:n.list.list,loading:D,totalCount:n.list.totalCount,onChange:q,onShowSizeChange:J,border:!0})}),e.jsx("div",{className:"page-footer",children:e.jsxs("div",{className:"page-footer-buttons",children:[d.add?e.jsxs(g,{type:"primary",style:{marginRight:"10px"},onClick:Q,children:[" ","新增人员"]}):null,d.add?e.jsxs(g,{type:"primary",loading:V,onClick:W,children:[" ","同步人员"]}):null]})})]})]})}),p.PoliceAddVisible?e.jsx(le,{form:A,visible:p.PoliceAddVisible,type:p.moduletype,title:p.moduletitle,handleOk:X,values:p.moduletype==="add"?"":w.list,deptId:r.deptCode,currPeopleId:N,onCancel:()=>{u({PoliceAddVisible:!1,moduletype:"",moduletitle:""})},roleList:P.list.list||[]}):null,R?e.jsx(ae,{visible:R,handleOkRole:()=>{x(!1),l(()=>{})},values:w,currPeopleId:N,select:P.list.list,onCancel:()=>{m.info("取消成功"),x(!1)}}):null]})};export{Ai as default};
