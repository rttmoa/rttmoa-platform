import{r as l,j as a,W as O,b2 as V,B as D,au as N,a7 as _,b5 as z,b6 as K,I as W}from"./.pnpm-e6eae8df.js";const q=()=>{const[T,u]=l.useState([]),[E,b]=l.useState([]),[k,g]=l.useState(!1),[S,v]=l.useState(),[C,I]=l.useState([]),[U,A]=l.useState(""),[h,y]=l.useState(""),j=(e,t)=>{b([]),u([]),t||y(""),g(!0);const o=new FileReader;o.onload=x=>{const r=new Uint8Array(x.target.result),c=z(r,{type:"array"}),L=t?c.Sheets[t]:c.Sheets[c.SheetNames[0]],i=K.sheet_to_json(L,{header:1}),w=c.SheetNames.map(n=>({label:n,value:n}));if(I(w),y(t||w[0].value),i.length>0){const n=[];i.slice(1).forEach((s,m)=>{if(s.length===0)return!1;const p={key:m};i[0].forEach((d,f)=>{p[d]=s[f]}),n.push(p)});const J=i[0].map(s=>({title:s,dataIndex:s,key:s,align:"center",render:(m,p,d)=>a.jsx(W,{style:{color:"#000",height:"100%",textAlign:"center"},bordered:!1,defaultValue:m,onBlur:f=>{B(f.target.value,d,s,n)}},d)}));b(J),u(n)}g(!1)},o.readAsArrayBuffer(e)},B=(e,t,o,x)=>{const r=JSON.parse(JSON.stringify(x));r[t][o]=e,u(r)},F=()=>{},R=e=>{S&&j(S,e)};return a.jsxs("div",{className:"TableDataImport",children:[a.jsxs("div",{className:"fileUpDiv",style:{marginTop:10},children:[a.jsx("span",{style:{marginRight:42},children:"文件名称"}),a.jsx("span",{className:"fileName",children:U}),a.jsx(O,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(A(e.name),v(e),j(e),!1):(V.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:a.jsx(D,{children:"上传Excel文件"})}),a.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!h&&a.jsx(N,{disabled:!0,style:{width:120},options:[]}),h&&a.jsx(N,{defaultValue:h,style:{width:120},onChange:R,options:C}),a.jsx(D,{type:"primary",onClick:F,children:"导入"})]}),a.jsx(_,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:k,size:"small",dataSource:T,columns:E})]})};export{q as default};
