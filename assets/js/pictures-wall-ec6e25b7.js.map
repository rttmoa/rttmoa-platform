{"version":3,"file":"pictures-wall-ec6e25b7.js","sources":["../../../src/views/module/product/component/pictures-wall.tsx"],"sourcesContent":["import { Modal, Upload, message } from \"antd\";\nimport type { GetProp, UploadFile, UploadProps } from \"antd\";\nimport React, { useEffect, useState } from \"react\";\nconst serverUrl = \"http://localhost:5000/upload/\";\n\nexport default function PicturesWall({ images }: any) {\n  const [previewVisible, setpreviewVisible] = useState(false); // 图片弹窗\n  const [previewImage, setpreviewImage] = useState(\"\"); // 大图的url\n  const [fileList, setFileList] = useState([]);\n\n  useEffect(() => {\n    const imgs = images;\n    console.log(imgs);\n    if (imgs && imgs.length > 0) {\n      let fileList = [];\n      fileList = imgs.map((img: any, index: number) => ({\n        uid: -index,\n        name: img,\n        status: \"done\",\n        // url: serverUrl + img\n        url: img\n      }));\n      setFileList(fileList);\n    }\n  }, []);\n\n  /**\n   * 父组件获取此值\n   * @returns\n   */\n  const getImgs = () => fileList.map((file: any) => file.name);\n\n  const handlePreview = (file: any) => {\n    setpreviewImage(file.url || file.thumbUrl);\n    setpreviewVisible(true);\n  };\n\n  const handleChange: UploadProps[\"onChange\"] = ({ file, fileList }: any) => {\n    console.log(\"上传事件：\", file, file.status, fileList.length, file === fileList[fileList.length - 1]);\n    setFileList(fileList);\n\n    // 一旦上传成功, 将当前上传的file的信息修正(name, url)\n    // if (file.status === \"done\") {\n    //   const result = file.response; // {status: 0, data: {name: 'xxx.jpg', url: '图片地址'}}\n    //   if (result.status === 0) {\n    //     message.success(\"上传图片成功!\");\n    //     const { name, url } = result.data;\n    //     file = fileList[fileList.length - 1];\n    //     file.name = name;\n    //     file.url = url;\n    //   } else {\n    //     message.error(\"上传图片失败\");\n    //   }\n    // } else if (file.status === \"removed\") {\n    // 删除图片\n    //   const result = await reqDeleteImg(file.name);\n    //   if (result.status === 0) {\n    //     message.success(\"删除图片成功!\");\n    //   } else {\n    //     message.error(\"删除图片失败!\");\n    //   }\n    // }\n    // 在操作(上传/删除)过程中更新fileList状态\n    //setFileList(fileList);\n  };\n  return (\n    <>\n      <Upload\n        action=\"https://run.mocky.io/v3/435e224c-44fb-4773-9faf-380c5e6a2188\" /*上传图片的接口地址*/\n        accept=\"image/*\" /*只接收图片格式*/\n        name=\"image\" /*请求参数名*/\n        listType=\"picture-card\" /*卡片样式*/\n        fileList={fileList} /*所有已上传图片文件对象的数组*/\n        onPreview={handlePreview}\n        onChange={handleChange}\n      >\n        {fileList.length >= 4 ? null : (\n          <div>\n            <div>+</div>\n            <div>Upload</div>\n          </div>\n        )}\n      </Upload>\n      <Modal\n        open={previewVisible}\n        footer={null}\n        onCancel={() => {\n          setpreviewVisible(false);\n        }}\n      >\n        <img alt=\"example\" style={{ width: \"100%\" }} src={previewImage} />\n      </Modal>\n    </>\n  );\n  // return (\n  //   <>\n  //     <Upload\n  //       name=\"file\"\n  //       listType=\"picture-card\"\n  //       className=\"avatar-uploader\"\n  //       showUploadList={true}\n  //       action={serverUrl + \"/api/v1/common/file_upload\"}\n  //       onChange={handleChange}\n  // \t\t\tfileList={fileList}\n  //     >\n  //       {imageUrl ? (\n  // <img src={serverUrl + imageUrl} alt=\"avatar\" style={{ width: \"100%\" }} />\n  //         <img src={imageUrl} alt=\"avatar\" style={{ width: 100, height: 100 }} />\n  //       ) : (\n  // <div>\n  //   <Icon type={loading ? \"loading\" : \"plus\"} />\n  //   <div className=\"ant-upload-text\">Upload</div>\n  // </div>\n  // <img src={defaultImg} alt=\"avatar\" style={{ width: \"100%\" }} />\n  //         <span>+</span>\n  //       )}\n  //     </Upload>\n  //   </>\n  // );\n}\n"],"names":["PicturesWall","images","previewVisible","setpreviewVisible","useState","previewImage","setpreviewImage","fileList","setFileList","useEffect","imgs","img","index","handlePreview","file","handleChange","jsxs","Fragment","jsx","Upload","Modal"],"mappings":"6DAKwB,SAAAA,EAAa,CAAE,OAAAC,GAAe,CACpD,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,WAAS,EAAK,EACpD,CAACC,EAAcC,CAAe,EAAIF,WAAS,EAAE,EAC7C,CAACG,EAAUC,CAAW,EAAIJ,EAAA,SAAS,CAAE,CAAA,EAE3CK,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAOT,EAET,GAAAS,GAAQA,EAAK,OAAS,EAAG,CAC3B,IAAIH,EAAW,CAAA,EACfA,EAAWG,EAAK,IAAI,CAACC,EAAUC,KAAmB,CAChD,IAAK,CAACA,EACN,KAAMD,EACN,OAAQ,OAER,IAAKA,CACL,EAAA,EACFH,EAAYD,CAAQ,CACtB,CACF,EAAG,CAAE,CAAA,EAQC,MAAAM,EAAiBC,GAAc,CACnBR,EAAAQ,EAAK,KAAOA,EAAK,QAAQ,EACzCX,EAAkB,EAAI,CAAA,EAGlBY,EAAwC,CAAC,CAAE,KAAAD,EAAM,SAAAP,KAAoB,CAC9CO,EAAK,OAAQP,EAAS,OAAiBA,EAASA,EAAS,OAAS,CAAC,EAC9FC,EAAYD,CAAQ,CAAA,EA0BtB,OAEIS,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAC,EAAA,IAACC,EAAA,CACC,OAAO,+DACP,OAAO,UACP,KAAK,QACL,SAAS,eACT,SAAAZ,EACA,UAAWM,EACX,SAAUE,EAET,SAASR,EAAA,QAAU,EAAI,YACrB,MACC,CAAA,SAAA,CAAAW,EAAAA,IAAC,OAAI,SAAC,GAAA,CAAA,EACNA,EAAAA,IAAC,OAAI,SAAM,QAAA,CAAA,CAAA,EACb,CAAA,CAEJ,EACAA,EAAA,IAACE,EAAA,CACC,KAAMlB,EACN,OAAQ,KACR,SAAU,IAAM,CACdC,EAAkB,EAAK,CACzB,EAEA,SAAAe,EAAA,IAAC,MAAI,CAAA,IAAI,UAAU,MAAO,CAAE,MAAO,MAAA,EAAU,IAAKb,CAAc,CAAA,CAAA,CAClE,CACF,CAAA,CAAA,CA2BJ"}