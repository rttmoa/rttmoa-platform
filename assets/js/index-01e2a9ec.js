import{T as Z,c as ee,a as te}from"./Tree-d7ec55a3.js";import{a as b,aS as G,c6 as ne,b1 as se,c7 as oe,o as J,br as F,r as f,bv as re,c8 as ce,c9 as le}from"./index-23197e8f.js";import{f as Q,c as ae,a as ie}from"./conductUtil-a9a07cfe.js";import{u as de,S as fe}from"./iconUtil-4b9a5d6f.js";const z=4;function ue(n){const{dropPosition:c,dropLevelOffset:r,prefixCls:t,indent:s,direction:e="ltr"}=n,o=e==="ltr"?"left":"right",l=e==="ltr"?"right":"left",a={[o]:-r*s+z,[l]:0};switch(c){case-1:a.top=-3;break;case 1:a.bottom=-3;break;default:a.bottom=-3,a[o]=s+z;break}return b.createElement("div",{style:a,className:`${t}-drop-indicator`})}const pe=b.forwardRef((n,c)=>{var r;const{getPrefixCls:t,direction:s,virtual:e,tree:o}=b.useContext(G),{prefixCls:l,className:a,showIcon:d=!1,showLine:E,switcherIcon:T,switcherLoadingIcon:S,blockNode:P=!1,children:k,checkable:O=!1,selectable:C=!0,draggable:g,motion:w,style:I}=n,y=t("tree",l),R=t(),N=w??Object.assign(Object.assign({},ne(R)),{motionAppear:!1}),$=Object.assign(Object.assign({},n),{checkable:O,selectable:C,showIcon:d,motion:N,blockNode:P,showLine:!!E,dropIndicatorRender:ue}),[x,u,h]=de(y),[,K]=se(),v=K.paddingXS/2+(((r=K.Tree)===null||r===void 0?void 0:r.titleHeight)||K.controlHeightSM),_=b.useMemo(()=>{if(!g)return!1;let i={};switch(typeof g){case"function":i.nodeDraggable=g;break;case"object":i=Object.assign({},g);break}return i.icon!==!1&&(i.icon=i.icon||b.createElement(oe,null)),i},[g]),p=i=>b.createElement(fe,{prefixCls:y,switcherIcon:T,switcherLoadingIcon:S,treeNodeProps:i,showLine:E});return x(b.createElement(Z,Object.assign({itemHeight:v,ref:c,virtual:e},$,{style:Object.assign(Object.assign({},o==null?void 0:o.style),I),prefixCls:y,className:J({[`${y}-icon-hide`]:!d,[`${y}-block-node`]:P,[`${y}-unselectable`]:!C,[`${y}-rtl`]:s==="rtl"},o==null?void 0:o.className,a,u,h),direction:s,checkable:O&&b.createElement("span",{className:`${y}-checkbox-inner`}),selectable:C,switcherIcon:p,draggable:_}),k))}),U=pe,V=0,A=1,B=2;function H(n,c,r){const{key:t,children:s}=r;function e(o){const l=o[t],a=o[s];c(l,o)!==!1&&H(a||[],c,r)}n.forEach(e)}function ye(n){let{treeData:c,expandedKeys:r,startKey:t,endKey:s,fieldNames:e}=n;const o=[];let l=V;if(t&&t===s)return[t];if(!t||!s)return[];function a(d){return d===t||d===s}return H(c,d=>{if(l===B)return!1;if(a(d)){if(o.push(d),l===V)l=A;else if(l===A)return l=B,!1}else l===A&&o.push(d);return r.includes(d)},Q(e)),o}function L(n,c,r){const t=F(c),s=[];return H(n,(e,o)=>{const l=t.indexOf(e);return l!==-1&&(s.push(o),t.splice(l,1)),!!t.length},Q(r)),s}var X=globalThis&&globalThis.__rest||function(n,c){var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&c.indexOf(t)<0&&(r[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(n);s<t.length;s++)c.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(n,t[s])&&(r[t[s]]=n[t[s]]);return r};function me(n){const{isLeaf:c,expanded:r}=n;return c?f.createElement(re,null):r?f.createElement(ce,null):f.createElement(le,null)}function q(n){let{treeData:c,children:r}=n;return c||ie(r)}const xe=(n,c)=>{var{defaultExpandAll:r,defaultExpandParent:t,defaultExpandedKeys:s}=n,e=X(n,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const o=f.useRef(null),l=f.useRef(null),a=()=>{const{keyEntities:x}=ae(q(e));let u;return r?u=Object.keys(x):t?u=ee(e.expandedKeys||s||[],x):u=e.expandedKeys||s||[],u},[d,E]=f.useState(e.selectedKeys||e.defaultSelectedKeys||[]),[T,S]=f.useState(()=>a());f.useEffect(()=>{"selectedKeys"in e&&E(e.selectedKeys)},[e.selectedKeys]),f.useEffect(()=>{"expandedKeys"in e&&S(e.expandedKeys)},[e.expandedKeys]);const P=(x,u)=>{var h;return"expandedKeys"in e||S(x),(h=e.onExpand)===null||h===void 0?void 0:h.call(e,x,u)},k=(x,u)=>{var h;const{multiple:K,fieldNames:v}=e,{node:_,nativeEvent:p}=u,{key:i=""}=_,j=q(e),D=Object.assign(Object.assign({},u),{selected:!0}),W=(p==null?void 0:p.ctrlKey)||(p==null?void 0:p.metaKey),Y=p==null?void 0:p.shiftKey;let m;K&&W?(m=x,o.current=i,l.current=m,D.selectedNodes=L(j,m,v)):K&&Y?(m=Array.from(new Set([].concat(F(l.current||[]),F(ye({treeData:j,expandedKeys:T,startKey:i,endKey:o.current,fieldNames:v}))))),D.selectedNodes=L(j,m,v)):(m=[i],o.current=i,l.current=m,D.selectedNodes=L(j,m,v)),(h=e.onSelect)===null||h===void 0||h.call(e,m,D),"selectedKeys"in e||E(m)},{getPrefixCls:O,direction:C}=f.useContext(G),{prefixCls:g,className:w,showIcon:I=!0,expandAction:y="click"}=e,R=X(e,["prefixCls","className","showIcon","expandAction"]),N=O("tree",g),$=J(`${N}-directory`,{[`${N}-directory-rtl`]:C==="rtl"},w);return f.createElement(U,Object.assign({icon:me,ref:c,blockNode:!0},R,{showIcon:I,expandAction:y,prefixCls:N,className:$,expandedKeys:T,selectedKeys:d,onSelect:k,onExpand:P}))},he=f.forwardRef(xe),be=he,M=U;M.DirectoryTree=be;M.TreeNode=te;const Oe=M;export{Oe as T};
