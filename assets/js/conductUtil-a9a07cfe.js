import{aY as A,t as C,bq as N,ba as F,i as _,aX as B,br as E}from"./index-23197e8f.js";function w(e,r){return e[r]}var M=["children"];function P(e,r){return"".concat(e,"-").concat(r)}function W(e){return e&&e.type&&e.type.isTreeNode}function S(e,r){return e??r}function T(e){var r=e||{},l=r.title,t=r._title,a=r.key,s=r.children,o=l||"title";return{title:o,_title:t||[o],key:a||"key",children:s||"children"}}function H(e){function r(l){var t=F(l);return t.map(function(a){if(!W(a))return N(!a,"Tree/TreeNode can only accept TreeNode as children."),null;var s=a.key,o=a.props,p=o.children,y=_(o,M),v=C({key:s},y),u=r(p);return u.length&&(v.children=u),v}).filter(function(a){return a})}return r(e)}function I(e,r,l){var t=T(l),a=t._title,s=t.key,o=t.children,p=new Set(r===!0?[]:r),y=[];function v(u){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return u.map(function(n,i){for(var c=P(d?d.pos:"0",i),h=S(n[s],c),f,g=0;g<a.length;g+=1){var K=a[g];if(n[K]!==void 0){f=n[K];break}}var k=Object.assign(B(n,[].concat(E(a),[s,o])),{title:f,key:h,parent:d,pos:c,children:null,data:n,isStart:[].concat(E(d?d.isStart:[]),[i===0]),isEnd:[].concat(E(d?d.isEnd:[]),[i===u.length-1])});return y.push(k),r===!0||p.has(h)?k.children=v(n[o]||[],k):k.children=[],k})}return v(e),y}function $(e,r,l){var t={};A(l)==="object"?t=l:t={externalGetKey:l},t=t||{};var a=t,s=a.childrenPropName,o=a.externalGetKey,p=a.fieldNames,y=T(p),v=y.key,u=y.children,d=s||u,n;o?typeof o=="string"?n=function(h){return h[o]}:typeof o=="function"&&(n=function(h){return o(h)}):n=function(h,f){return S(h[v],f)};function i(c,h,f,g){var K=c?c[d]:e,k=c?P(f.pos,h):"0",x=c?[].concat(E(g),[c]):[];if(c){var m=n(c,k),O={node:c,index:h,pos:k,key:m,parentPos:f.node?f.pos:null,level:f.level+1,nodes:x};r(O)}K&&K.forEach(function(G,j){i(G,j,{node:c,pos:k,level:f?f.level+1:-1},x)})}i(null)}function J(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=r.initWrapper,t=r.processEntity,a=r.onProcessFinished,s=r.externalGetKey,o=r.childrenPropName,p=r.fieldNames,y=arguments.length>2?arguments[2]:void 0,v=s||y,u={},d={},n={posEntities:u,keyEntities:d};return l&&(n=l(n)||n),$(e,function(i){var c=i.node,h=i.index,f=i.pos,g=i.key,K=i.parentPos,k=i.level,x=i.nodes,m={node:c,nodes:x,index:h,key:g,pos:f,level:k},O=S(g,f);u[f]=m,d[O]=m,m.parent=u[K],m.parent&&(m.parent.children=m.parent.children||[],m.parent.children.push(m)),t&&t(m,n)},{externalGetKey:v,childrenPropName:o,fieldNames:p}),a&&a(n),n}function L(e,r){var l=r.expandedKeys,t=r.selectedKeys,a=r.loadedKeys,s=r.loadingKeys,o=r.checkedKeys,p=r.halfCheckedKeys,y=r.dragOverNodeKey,v=r.dropPosition,u=r.keyEntities,d=w(u,e),n={eventKey:e,expanded:l.indexOf(e)!==-1,selected:t.indexOf(e)!==-1,loaded:a.indexOf(e)!==-1,loading:s.indexOf(e)!==-1,checked:o.indexOf(e)!==-1,halfChecked:p.indexOf(e)!==-1,pos:String(d?d.pos:""),dragOver:y===e&&v===0,dragOverGapTop:y===e&&v===-1,dragOverGapBottom:y===e&&v===1};return n}function Q(e){var r=e.data,l=e.expanded,t=e.selected,a=e.checked,s=e.loaded,o=e.loading,p=e.halfChecked,y=e.dragOver,v=e.dragOverGapTop,u=e.dragOverGapBottom,d=e.pos,n=e.active,i=e.eventKey,c=C(C({},r),{},{expanded:l,selected:t,checked:a,loaded:s,loading:o,halfChecked:p,dragOver:y,dragOverGapTop:v,dragOverGapBottom:u,pos:d,active:n,key:i});return"props"in c||Object.defineProperty(c,"props",{get:function(){return N(!1,"Second param return from event is node data instead of TreeNode instance. Please read value directly instead of reading from `props`."),e}}),c}function b(e,r){var l=new Set;return e.forEach(function(t){r.has(t)||l.add(t)}),l}function q(e){var r=e||{},l=r.disabled,t=r.disableCheckbox,a=r.checkable;return!!(l||t)||a===!1}function X(e,r,l,t){for(var a=new Set(e),s=new Set,o=0;o<=l;o+=1){var p=r.get(o)||new Set;p.forEach(function(d){var n=d.key,i=d.node,c=d.children,h=c===void 0?[]:c;a.has(n)&&!t(i)&&h.filter(function(f){return!t(f.node)}).forEach(function(f){a.add(f.key)})})}for(var y=new Set,v=l;v>=0;v-=1){var u=r.get(v)||new Set;u.forEach(function(d){var n=d.parent,i=d.node;if(!(t(i)||!d.parent||y.has(d.parent.key))){if(t(d.parent.node)){y.add(n.key);return}var c=!0,h=!1;(n.children||[]).filter(function(f){return!t(f.node)}).forEach(function(f){var g=f.key,K=a.has(g);c&&!K&&(c=!1),!h&&(K||s.has(g))&&(h=!0)}),c&&a.add(n.key),h&&s.add(n.key),y.add(n.key)}})}return{checkedKeys:Array.from(a),halfCheckedKeys:Array.from(b(s,a))}}function Y(e,r,l,t,a){for(var s=new Set(e),o=new Set(r),p=0;p<=t;p+=1){var y=l.get(p)||new Set;y.forEach(function(n){var i=n.key,c=n.node,h=n.children,f=h===void 0?[]:h;!s.has(i)&&!o.has(i)&&!a(c)&&f.filter(function(g){return!a(g.node)}).forEach(function(g){s.delete(g.key)})})}o=new Set;for(var v=new Set,u=t;u>=0;u-=1){var d=l.get(u)||new Set;d.forEach(function(n){var i=n.parent,c=n.node;if(!(a(c)||!n.parent||v.has(n.parent.key))){if(a(n.parent.node)){v.add(i.key);return}var h=!0,f=!1;(i.children||[]).filter(function(g){return!a(g.node)}).forEach(function(g){var K=g.key,k=s.has(K);h&&!k&&(h=!1),!f&&(k||o.has(K))&&(f=!0)}),h||s.delete(i.key),f&&o.add(i.key),v.add(i.key)}})}return{checkedKeys:Array.from(s),halfCheckedKeys:Array.from(b(o,s))}}function R(e,r,l,t){var a=[],s;t?s=t:s=q;var o=new Set(e.filter(function(u){var d=!!w(l,u);return d||a.push(u),d})),p=new Map,y=0;Object.keys(l).forEach(function(u){var d=l[u],n=d.level,i=p.get(n);i||(i=new Set,p.set(n,i)),i.add(d),y=Math.max(y,n)}),N(!a.length,"Tree missing follow keys: ".concat(a.slice(0,100).map(function(u){return"'".concat(u,"'")}).join(", ")));var v;return r===!0?v=X(o,p,y,s):v=Y(o,r.halfCheckedKeys,p,y,s),v}export{H as a,Q as b,J as c,L as d,S as e,T as f,w as g,R as h,I as i};
