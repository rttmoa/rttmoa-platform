import{r as o,X as y,dj as st,dk as Pe,dl as ct,V as Te,$ as F,W as ke,d as C,dm as ft,Z as Oe,c0 as dt,G as vt,dn as mt,bs as b}from"./index-83fc08b5.js";function pt(){var e=o.useState({id:0,callback:null}),n=y(e,2),u=n[0],s=n[1],i=o.useCallback(function(c){s(function(r){var f=r.id;return{id:f+1,callback:c}})},[]);return o.useEffect(function(){var c;(c=u.callback)===null||c===void 0||c.call(u)},[u]),i}var $e=o.createContext(null);function gt(e){var n=o.useContext($e),u=n.notFoundContent,s=n.activeIndex,i=n.setActiveIndex,c=n.selectOption,r=n.onFocus,f=n.onBlur,v=n.onScroll,m=e.prefixCls,g=e.options,E=g[s]||{};return o.createElement(st,{prefixCls:"".concat(m,"-menu"),activeKey:E.key,onSelect:function(h){var p=h.key,S=g.find(function(_){var I=_.key;return I===p});c(S)},onFocus:r,onBlur:f,onScroll:v},g.map(function(x,h){var p=x.key,S=x.disabled,_=x.className,I=x.style,L=x.label;return o.createElement(Pe,{key:p,disabled:S,className:_,style:I,onMouseEnter:function(){i(h)}},L)}),!g.length&&o.createElement(Pe,{disabled:!0},u))}var xt={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},Ct=function(n){var u=n.prefixCls,s=n.options,i=n.children,c=n.visible,r=n.transitionName,f=n.getPopupContainer,v=n.dropdownClassName,m=n.direction,g=n.placement,E="".concat(u,"-dropdown"),x=o.createElement(gt,{prefixCls:E,options:s}),h=o.useMemo(function(){var p;return m==="rtl"?p=g==="top"?"topLeft":"bottomLeft":p=g==="top"?"topRight":"bottomRight",p},[m,g]);return o.createElement(ct,{prefixCls:E,popupVisible:c,popup:x,popupPlacement:h,popupTransitionName:r,builtinPlacements:xt,getPopupContainer:f,popupClassName:v},i)},ht=function(){return null};function St(e){var n=e.selectionStart;return e.value.slice(0,n)}function wt(e,n){return n.reduce(function(u,s){var i=e.lastIndexOf(s);return i>u.location?{location:i,prefix:s}:u},{location:-1,prefix:""})}function Re(e){return(e||"").toLowerCase()}function bt(e,n,u){var s=e[0];if(!s||s===u)return e;for(var i=e,c=n.length,r=0;r<c;r+=1)if(Re(i[r])!==Re(n[r])){i=i.slice(r);break}else r===c-1&&(i=i.slice(c));return i}function yt(e,n){var u=n.measureLocation,s=n.prefix,i=n.targetText,c=n.selectionStart,r=n.split,f=e.slice(0,u);f[f.length-r.length]===r&&(f=f.slice(0,f.length-r.length)),f&&(f="".concat(f).concat(r));var v=bt(e.slice(c),i.slice(c-u-s.length),r);v.slice(0,r.length)===r&&(v=v.slice(r.length));var m="".concat(f).concat(s).concat(i).concat(r);return{text:"".concat(m).concat(v),selectionLocation:m.length}}function Et(e,n){e.setSelectionRange(n,n),e.blur(),e.focus()}function It(e,n){return!n||e.indexOf(n)===-1}function Nt(e,n){var u=n.value,s=u===void 0?"":u,i=e.toLowerCase();return s.toLowerCase().indexOf(i)!==-1}var _t=["prefixCls","className","style","prefix","split","notFoundContent","value","defaultValue","children","options","open","allowClear","silent","validateSearch","filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","rows","visible","onPopupScroll"],Mt=["suffix","prefixCls","defaultValue","value","allowClear","onChange","classNames","className","disabled","onClear"],Pt=o.forwardRef(function(e,n){var u=e.prefixCls,s=e.className,i=e.style,c=e.prefix,r=c===void 0?"@":c,f=e.split,v=f===void 0?" ":f,m=e.notFoundContent,g=m===void 0?"Not Found":m,E=e.value,x=e.defaultValue,h=e.children,p=e.options,S=e.open;e.allowClear;var _=e.silent,I=e.validateSearch,L=I===void 0?It:I,A=e.filterOption,R=A===void 0?Nt:A,K=e.onChange,N=e.onKeyDown,w=e.onKeyUp,re=e.onPressEnter,oe=e.onSearch,G=e.onSelect,le=e.onFocus,H=e.onBlur,Fe=e.transitionName,Le=e.placement,Ae=e.direction,Ke=e.getPopupContainer,Be=e.dropdownClassName,ie=e.rows,De=ie===void 0?1:ie;e.visible;var Z=e.onPopupScroll,Ve=Te(e,_t),j=o.useMemo(function(){return Array.isArray(r)?r:[r]},[r]),ue=o.useRef(null),B=o.useRef(null),q=o.useRef(null),J=function(){var t;return(t=B.current)===null||t===void 0||(t=t.resizableTextArea)===null||t===void 0?void 0:t.textArea};C.useImperativeHandle(n,function(){var l;return{focus:function(){var a;return(a=B.current)===null||a===void 0?void 0:a.focus()},blur:function(){var a;return(a=B.current)===null||a===void 0?void 0:a.blur()},textarea:(l=B.current)===null||l===void 0||(l=l.resizableTextArea)===null||l===void 0?void 0:l.textArea,nativeElement:ue.current}});var je=o.useState(!1),se=y(je,2),U=se[0],ce=se[1],Ue=o.useState(""),fe=y(Ue,2),de=fe[0],ve=fe[1],We=o.useState(""),me=y(We,2),pe=me[0],Xe=me[1],Ye=o.useState(0),ge=y(Ye,2),xe=ge[0],Ce=ge[1],ze=o.useState(0),he=y(ze,2),Q=he[0],ee=he[1],Ge=o.useState(!1),Se=y(Ge,2),He=Se[0],we=Se[1],Ze=ke("",{defaultValue:x,value:E}),be=y(Ze,2),T=be[0],qe=be[1];o.useEffect(function(){U&&q.current&&(q.current.scrollTop=J().scrollTop)},[U]);var Je=C.useMemo(function(){if(S)for(var l=0;l<j.length;l+=1){var t=j[l],a=T.lastIndexOf(t);if(a>=0)return[!0,"",t,a]}return[U,de,pe,xe]},[S,U,j,T,de,pe,xe]),W=y(Je,4),k=W[0],te=W[1],X=W[2],ne=W[3],ae=C.useCallback(function(l){var t;return p&&p.length>0?t=p.map(function(a){var d;return F(F({},a),{},{key:(d=a==null?void 0:a.key)!==null&&d!==void 0?d:a.value})}):t=dt(h).map(function(a){var d=a.props,M=a.key;return F(F({},d),{},{label:d.children,key:M||d.value})}),t.filter(function(a){return R===!1?!0:R(l,a)})},[h,p,R]),Y=C.useMemo(function(){return ae(te)},[ae,te]),Qe=pt(),et=function(t,a,d){ce(!0),ve(t),Xe(a),Ce(d),ee(0)},O=function(t){ce(!1),Ce(0),ve(""),Qe(t)},ye=function(t){qe(t),K==null||K(t)},tt=function(t){var a=t.target.value;ye(a)},Ee=function(t){var a,d=t.value,M=d===void 0?"":d,P=yt(T,{measureLocation:ne,targetText:M,prefix:X,selectionStart:(a=J())===null||a===void 0?void 0:a.selectionStart,split:v}),$=P.text,D=P.selectionLocation;ye($),O(function(){Et(J(),D)}),G==null||G(t,X)},nt=function(t){var a=t.which;if(N==null||N(t),!!k){if(a===b.UP||a===b.DOWN){var d=Y.length,M=a===b.UP?-1:1,P=(Q+M+d)%d;ee(P),t.preventDefault()}else if(a===b.ESC)O();else if(a===b.ENTER){if(t.preventDefault(),_)return;if(!Y.length){O();return}var $=Y[Q];Ee($)}}},at=function(t){var a=t.key,d=t.which,M=t.target,P=St(M),$=wt(P,j),D=$.location,z=$.prefix;if(w==null||w(t),[b.ESC,b.UP,b.DOWN,b.ENTER].indexOf(d)===-1)if(D!==-1){var V=P.slice(D+z.length),Me=L(V,v),ut=!!ae(V).length;Me?(a===z||a==="Shift"||d===b.ALT||a==="AltGraph"||k||V!==te&&ut)&&et(V,z,D):k&&O(),oe&&Me&&oe(V,z)}else k&&O()},rt=function(t){!k&&re&&re(t)},Ie=o.useRef(),Ne=function(t){window.clearTimeout(Ie.current),!He&&t&&le&&le(t),we(!0)},_e=function(t){Ie.current=window.setTimeout(function(){we(!1),O(),H==null||H(t)},0)},ot=function(){Ne()},lt=function(){_e()},it=function(t){Z==null||Z(t)};return C.createElement("div",{className:vt(u,s),style:i,ref:ue},C.createElement(mt,Oe({ref:B,value:T},Ve,{rows:De,onChange:tt,onKeyDown:nt,onKeyUp:at,onPressEnter:rt,onFocus:Ne,onBlur:_e})),k&&C.createElement("div",{ref:q,className:"".concat(u,"-measure")},T.slice(0,ne),C.createElement($e.Provider,{value:{notFoundContent:g,activeIndex:Q,setActiveIndex:ee,selectOption:Ee,onFocus:ot,onBlur:lt,onScroll:it}},C.createElement(Ct,{prefixCls:u,transitionName:Fe,placement:Le,direction:Ae,options:Y,visible:!0,getPopupContainer:Ke,dropdownClassName:Be},C.createElement("span",null,X))),T.slice(ne+X.length)))}),Rt=o.forwardRef(function(e,n){var u=e.suffix,s=e.prefixCls,i=s===void 0?"rc-mentions":s,c=e.defaultValue,r=e.value,f=e.allowClear,v=e.onChange,m=e.classNames,g=e.className,E=e.disabled,x=e.onClear,h=Te(e,Mt),p=o.useRef(null),S=o.useRef(null);o.useImperativeHandle(n,function(){var N,w;return F(F({},S.current),{},{nativeElement:((N=p.current)===null||N===void 0?void 0:N.nativeElement)||((w=S.current)===null||w===void 0?void 0:w.nativeElement)})});var _=ke("",{defaultValue:c,value:r}),I=y(_,2),L=I[0],A=I[1],R=function(w){A(w),v==null||v(w)},K=function(){R("")};return C.createElement(ft,{suffix:u,prefixCls:i,value:L,allowClear:f,handleReset:K,className:g,classNames:m,disabled:E,ref:p,onClear:x},C.createElement(Pt,Oe({className:m==null?void 0:m.mentions,prefixCls:i,ref:S,onChange:R,disabled:E},h)))});Rt.Option=ht;export{Rt as M};
//# sourceMappingURL=Mentions-7012fca3.js.map
