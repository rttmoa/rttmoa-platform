import{u as W,T as Y,S as Z,c as ee,C as te}from"./iconUtil-832b41e6.js";import{a as h,aJ as J,bs as ne,bp as se,bt as re,p as X,bd as L,r as f,bu as oe,bv as ce,bw as ae}from"./index-d95cf114.js";import{f as q,c as le,a as ie}from"./conductUtil-d73127d5.js";const z=4;function de(e){const{dropPosition:c,dropLevelOffset:o,prefixCls:n,indent:s,direction:t="ltr"}=e,r=t==="ltr"?"left":"right",a=t==="ltr"?"right":"left",i={[r]:-o*s+z,[a]:0};switch(c){case-1:i.top=-3;break;case 1:i.bottom=-3;break;default:i.bottom=-3,i[r]=s+z;break}return h.createElement("div",{style:i,className:`${n}-drop-indicator`})}const fe=h.forwardRef((e,c)=>{var o;const{getPrefixCls:n,direction:s,virtual:t,tree:r}=h.useContext(J),{prefixCls:a,className:i,showIcon:d=!1,showLine:v,switcherIcon:N,blockNode:E=!1,children:I,checkable:C=!1,selectable:O=!0,draggable:g,motion:w,style:D}=e,y=n("tree",a),$=n(),A=w??Object.assign(Object.assign({},ne($)),{motionAppear:!1}),S=Object.assign(Object.assign({},e),{checkable:C,selectable:O,showIcon:d,motion:A,blockNode:E,showLine:!!v,dropIndicatorRender:de}),[_,b,u]=W(y),[,p]=se(),T=p.paddingXS/2+(((o=p.Tree)===null||o===void 0?void 0:o.titleHeight)||p.controlHeightSM),K=h.useMemo(()=>{if(!g)return!1;let l={};switch(typeof g){case"function":l.nodeDraggable=g;break;case"object":l=Object.assign({},g);break}return l.icon!==!1&&(l.icon=l.icon||h.createElement(re,null)),l},[g]),F=l=>h.createElement(Z,{prefixCls:y,switcherIcon:N,treeNodeProps:l,showLine:v});return _(h.createElement(Y,Object.assign({itemHeight:T,ref:c,virtual:t},S,{style:Object.assign(Object.assign({},r==null?void 0:r.style),D),prefixCls:y,className:X({[`${y}-icon-hide`]:!d,[`${y}-block-node`]:E,[`${y}-unselectable`]:!O,[`${y}-rtl`]:s==="rtl"},r==null?void 0:r.className,i,b,u),direction:s,checkable:C&&h.createElement("span",{className:`${y}-checkbox-inner`}),selectable:O,switcherIcon:F,draggable:K}),I))}),G=fe;var m;(function(e){e[e.None=0]="None",e[e.Start=1]="Start",e[e.End=2]="End"})(m||(m={}));function M(e,c,o){const{key:n,children:s}=o;function t(r){const a=r[n],i=r[s];c(a,r)!==!1&&M(i||[],c,o)}e.forEach(t)}function ue(e){let{treeData:c,expandedKeys:o,startKey:n,endKey:s,fieldNames:t}=e;const r=[];let a=m.None;if(n&&n===s)return[n];if(!n||!s)return[];function i(d){return d===n||d===s}return M(c,d=>{if(a===m.End)return!1;if(i(d)){if(r.push(d),a===m.None)a=m.Start;else if(a===m.Start)return a=m.End,!1}else a===m.Start&&r.push(d);return o.includes(d)},q(t)),r}function H(e,c,o){const n=L(c),s=[];return M(e,(t,r)=>{const a=n.indexOf(t);return a!==-1&&(s.push(r),n.splice(a,1)),!!n.length},q(o)),s}var V=globalThis&&globalThis.__rest||function(e,c){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&c.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)c.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(o[n[s]]=e[n[s]]);return o};function pe(e){const{isLeaf:c,expanded:o}=e;return c?f.createElement(oe,null):o?f.createElement(ce,null):f.createElement(ae,null)}function B(e){let{treeData:c,children:o}=e;return c||ie(o)}const ye=(e,c)=>{var{defaultExpandAll:o,defaultExpandParent:n,defaultExpandedKeys:s}=e,t=V(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const r=f.useRef(),a=f.useRef(),i=()=>{const{keyEntities:b}=le(B(t));let u;return o?u=Object.keys(b):n?u=ee(t.expandedKeys||s||[],b):u=t.expandedKeys||s||[],u},[d,v]=f.useState(t.selectedKeys||t.defaultSelectedKeys||[]),[N,E]=f.useState(()=>i());f.useEffect(()=>{"selectedKeys"in t&&v(t.selectedKeys)},[t.selectedKeys]),f.useEffect(()=>{"expandedKeys"in t&&E(t.expandedKeys)},[t.expandedKeys]);const I=(b,u)=>{var p;return"expandedKeys"in t||E(b),(p=t.onExpand)===null||p===void 0?void 0:p.call(t,b,u)},C=(b,u)=>{var p;const{multiple:T,fieldNames:K}=t,{node:F,nativeEvent:l}=u,{key:P=""}=F,j=B(t),k=Object.assign(Object.assign({},u),{selected:!0}),Q=(l==null?void 0:l.ctrlKey)||(l==null?void 0:l.metaKey),U=l==null?void 0:l.shiftKey;let x;T&&Q?(x=b,r.current=P,a.current=x,k.selectedNodes=H(j,x,K)):T&&U?(x=Array.from(new Set([].concat(L(a.current||[]),L(ue({treeData:j,expandedKeys:N,startKey:P,endKey:r.current,fieldNames:K}))))),k.selectedNodes=H(j,x,K)):(x=[P],r.current=P,a.current=x,k.selectedNodes=H(j,x,K)),(p=t.onSelect)===null||p===void 0||p.call(t,x,k),"selectedKeys"in t||v(x)},{getPrefixCls:O,direction:g}=f.useContext(J),{prefixCls:w,className:D,showIcon:y=!0,expandAction:$="click"}=t,A=V(t,["prefixCls","className","showIcon","expandAction"]),S=O("tree",w),_=X(`${S}-directory`,{[`${S}-directory-rtl`]:g==="rtl"},D);return f.createElement(G,Object.assign({icon:pe,ref:c,blockNode:!0},A,{showIcon:y,expandAction:$,prefixCls:S,className:_,expandedKeys:N,selectedKeys:d,onSelect:C,onExpand:I}))},xe=f.forwardRef(ye),be=xe,R=G;R.DirectoryTree=be;R.TreeNode=te;const Ke=R;export{Ke as T};
