{"version":3,"file":"Modal-b7a529e0.js","sources":["../../../src/views/system/dept/component/Modal.tsx"],"sourcesContent":["import { FindAllMenu } from '@/api/modules/upack/common';\nimport { Button, Card, Cascader, Checkbox, Col, Form, Input, InputNumber, Modal, Radio, Row, Space, Switch, Tree, TreeSelect } from 'antd';\nimport TextArea from 'antd/es/input/TextArea';\nimport { useEffect, useState } from 'react';\n\nconst ModalComponent = (Props: any) => {\n\tconst {\n\t\tform, // form\n\t\tmenuList, // 菜单\n\n\t\tmodalTitle: title, // 标题\n\t\tmodalType: type, // 类型\n\t\tmodalIsVisible, // 显示\n\t\tmodalMenuInfo: data, // 菜单信息\n\n\t\tsetModalIsVisible, // 设置显示\n\n\t\thandleModalSubmit, // 提交\n\t} = Props;\n\n\tconst [isTop, setIsTop] = useState('是');\n\tconst [value, setValue] = useState<string>('');\n\n\t// & 这里优化\n\tuseEffect(() => {\n\t\tform.setFieldsValue({\n\t\t\tisTop: type === 'create' ? '是' : '否',\n\t\t\tparent_id: data?.name,\n\t\t\temail: type === 'create' ? '' : data?.email,\n\t\t\tleader: type === 'create' ? '' : data?.leader,\n\t\t\tname: type === 'create' ? '' : data?.name,\n\t\t\tphone: type === 'create' ? '' : data?.phone,\n\t\t\tsort: type === 'create' ? '' : data?.sort,\n\t\t\tstatus: type === 'create' ? '' : data?.status,\n\t\t});\n\t\tsetIsTop(type === 'create' ? '是' : '否');\n\t}, [data, type]);\n\n\t// & 这里可以提取 公共\n\t// * 处理菜单结构：  处理成TreeSelect需要的格式\n\tconst handleMenu = (menuConfig: any, type: string) => {\n\t\treturn menuConfig?.map((item: any) => {\n\t\t\tconst option: any = {\n\t\t\t\tvalue: item.name || null,\n\t\t\t\tlabel: item.name || null,\n\t\t\t};\n\t\t\tif (item.children && item.children.length) {\n\t\t\t\toption.children = handleMenu(item.children, 'children');\n\t\t\t}\n\t\t\treturn option;\n\t\t});\n\t};\n\tconst treeData = handleMenu(menuList, '');\n\n\t// 取消\n\tconst OnCancel = () => {\n\t\tsetModalIsVisible(false);\n\t};\n\t// * Modal 提交\n\tconst Submit = () => {\n\t\tform.submit();\n\t};\n\t// * Form 提交\n\tconst FormOnFinish = () => {\n\t\tconsole.log('提交');\n\t\tconst formList = form.getFieldsValue();\n\t\tformList.isTop = isTop; // 是否 是顶级上级\n\t\tif (isTop == '是') formList.parent_id = 0; // 父 id\n\t\tif (isTop == '否') formList.parent_id = value;\n\t\tif (type == 'edit') {\n\t\t\tformList._id = data.unique;\n\t\t}\n\t\tconsole.log('parent_id', isTop, '+', formList.parent_id);\n\t\thandleModalSubmit && handleModalSubmit(type, formList);\n\t};\n\treturn (\n\t\t<Modal\n\t\t\ttitle={title}\n\t\t\twidth={800}\n\t\t\topen={modalIsVisible}\n\t\t\tonCancel={OnCancel}\n\t\t\tfooter={[\n\t\t\t\t<Button loading={false} onClick={OnCancel}>\n\t\t\t\t\t取消\n\t\t\t\t</Button>,\n\t\t\t\t<Button key='link' type='primary' loading={false} onClick={Submit}>\n\t\t\t\t\t提交\n\t\t\t\t</Button>,\n\t\t\t]}\n\t\t>\n\t\t\t<Form form={form} onFinish={FormOnFinish} layout='horizontal' size='middle' labelCol={{ span: 6 }} wrapperCol={{ span: 16 }}>\n\t\t\t\t<Row gutter={16}>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='部门名称' name='name' rules={[{ required: true, message: '必填：部门名称' }]}>\n\t\t\t\t\t\t\t<Input variant='outlined' placeholder='请输入部门名称' maxLength={30} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='部门排序' name='sort' rules={[{ required: true, message: '必填：部门排序' }]}>\n\t\t\t\t\t\t\t<InputNumber variant='outlined' placeholder='请输入部门排序' maxLength={30} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='负责人' name='leader' rules={[{ required: false, message: '' }]}>\n\t\t\t\t\t\t\t<Input variant='outlined' placeholder='请输入负责人' maxLength={30} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='联系电话' name='phone' rules={[{ required: false, message: '' }]}>\n\t\t\t\t\t\t\t<Input variant='outlined' placeholder='请输入联系电话' maxLength={30} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='邮箱' name='email' rules={[{ required: false, message: '' }]}>\n\t\t\t\t\t\t\t<Input variant='outlined' placeholder='请输入邮箱' maxLength={30} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\n\t\t\t\t\t<Col span={12}>\n\t\t\t\t\t\t<Form.Item label='部门状态' name='status' rules={[{ required: false, message: '' }]}>\n\t\t\t\t\t\t\t<Radio.Group\n\t\t\t\t\t\t\t\tname='radiogroup'\n\t\t\t\t\t\t\t\tdefaultValue='启用'\n\t\t\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t\t\t{ value: '启用', label: '启用' },\n\t\t\t\t\t\t\t\t\t{ value: '停用', label: '停用' },\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={24} pull={3}>\n\t\t\t\t\t\t<Form.Item label='部门描述' name='desc' rules={[{ required: false, message: '' }]}>\n\t\t\t\t\t\t\t<Input.TextArea rows={3} placeholder='请输入部门描述' maxLength={6} />\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col span={24} pull={3}>\n\t\t\t\t\t\t<Form.Item label='是否顶级部门' name='isTop' rules={[{ required: true, message: '' }]}>\n\t\t\t\t\t\t\t<Radio.Group\n\t\t\t\t\t\t\t\toptions={['是', '否']}\n\t\t\t\t\t\t\t\tdefaultValue='是'\n\t\t\t\t\t\t\t\tonChange={(item: any) => {\n\t\t\t\t\t\t\t\t\tsetIsTop(item.target.value);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={isTop}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t</Col>\n\t\t\t\t\t{isTop == '是' && (\n\t\t\t\t\t\t<Col span={24} pull={3}>\n\t\t\t\t\t\t\t<Form.Item />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t)}\n\t\t\t\t\t{isTop == '否' && (\n\t\t\t\t\t\t<Col span={24} pull={3}>\n\t\t\t\t\t\t\t<Form.Item label='上级部门' name='parent_id' rules={[{ required: true, message: '必须：上级部门' }]}>\n\t\t\t\t\t\t\t\t<TreeSelect\n\t\t\t\t\t\t\t\t\tstyle={{ width: '100%' }}\n\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\tplaceholder='请选择上级部门'\n\t\t\t\t\t\t\t\t\tallowClear\n\t\t\t\t\t\t\t\t\tonChange={newValue => {\n\t\t\t\t\t\t\t\t\t\tsetValue(newValue);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttreeData={treeData}\n\t\t\t\t\t\t\t\t\tdropdownStyle={{ maxHeight: 500, overflow: 'auto' }}\n\t\t\t\t\t\t\t\t\tclassName='custom-tree-dropdown'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Form.Item>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t)}\n\t\t\t\t</Row>\n\t\t\t</Form>\n\t\t</Modal>\n\t);\n};\nexport default ModalComponent;\n"],"names":["ModalComponent","Props","form","menuList","title","type","modalIsVisible","data","setModalIsVisible","handleModalSubmit","isTop","setIsTop","useState","value","setValue","useEffect","handleMenu","menuConfig","item","option","treeData","OnCancel","Submit","FormOnFinish","formList","jsx","Modal","Button","Form","jsxs","Row","Col","Input","InputNumber","Radio","TreeSelect","newValue"],"mappings":"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"}