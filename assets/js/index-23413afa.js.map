{"version":3,"file":"index-23413afa.js","sources":["../../../src/hooks/useAuthButton.ts","../../../src/components/AuthButton/index.tsx","../../../src/views/auth/button/index.tsx"],"sourcesContent":["import { RootState, useSelector } from '@/redux'\r\nimport { getMenuByPath } from '@/utils'\r\n\r\n/**\r\n * @description  use Hooks Set auth button\r\n */\r\nconst useAuthButton = () => {\r\n\tconst authButtonList = useSelector((state: RootState) => state.auth.authButtonList)\r\n\t// console.log('authButtonList', authButtonList);\r\n\t// {\r\n\t//   \"authButton\": [\r\n\t//       \"add\",\r\n\t//       \"edit\",\r\n\t//       \"delete\",\r\n\t//       \"import\",\r\n\t//       \"export\"\r\n\t//   ],\r\n\t//   \"useProTable\": [\r\n\t//       \"add\",\r\n\t//       \"batchAdd\",\r\n\t//       \"export\",\r\n\t//       \"batchDelete\",\r\n\t//       \"status\"\r\n\t//     ]\r\n\t// }\r\n\tconst meta = getMenuByPath()?.meta ?? {}\r\n\r\n\tlet currentPageAuthButton: { [key: string]: boolean } = {}\r\n\r\n\tauthButtonList[meta.key!]?.forEach(item => (currentPageAuthButton[item] = true))\r\n\r\n\treturn {\r\n\t\tBUTTONS: currentPageAuthButton,\r\n\t}\r\n}\r\n\r\nexport default useAuthButton\r\n","import React from 'react'\r\nimport { useSelector } from '@/redux'\r\nimport { getMenuByPath } from '@/utils'\r\n\r\ntype authStr = 'add' | 'edit' | 'delete' | 'import' | 'export'\r\ntype authArr = ['add', 'edit', 'delete', 'import', 'export']\r\ntype AuthButtonProps = {\r\n\tauthority: string | string[]\r\n\tchildren: React.ReactNode\r\n}\r\n\r\nconst AuthButton: React.FC<AuthButtonProps> = ({ authority, children }) => {\r\n\tconst authButtonList = useSelector(state => state.auth.authButtonList) ?? []\r\n\r\n\tconst meta = getMenuByPath()?.meta ?? {}\r\n\r\n\tlet isAuth = false\r\n\r\n\tif (typeof authority === 'string') {\r\n\t\tauthButtonList[meta.key!]?.includes(authority) && (isAuth = true)\r\n\t}\r\n\tif (authority instanceof Array && authority.length) {\r\n\t\tconst hasPermission = authority.every(item => authButtonList[meta.key!]?.includes(item))\r\n\t\thasPermission && (isAuth = true)\r\n\t}\r\n\r\n\treturn <React.Fragment>{isAuth && children}</React.Fragment>\r\n}\r\n\r\nexport default React.memo(AuthButton)\r\n","import useAuthButton from '@/hooks/useAuthButton'\r\nimport AuthButton from '@/components/AuthButton'\r\nimport { Alert, Button, Card, Divider, Space } from 'antd'\r\nimport { DeleteOutlined, EditOutlined, PlusCircleOutlined, VerticalAlignBottomOutlined, VerticalAlignTopOutlined } from '@ant-design/icons'\r\n\r\nconst AuthButtonPage: React.FC = () => {\r\n\tconst { BUTTONS } = useAuthButton()\r\n\t// console.log('BUTTONS', BUTTONS);\r\n\treturn (\r\n\t\t<Card>\r\n\t\t\t<Alert message={`当前用户按钮权限：${JSON.stringify(Object.keys(BUTTONS))}`} type=\"success\" showIcon />\r\n\t\t\t<Divider orientation=\"left\" plain className=\"mt30\">\r\n\t\t\t\t使用 Hooks 绑定按钮权限\r\n\t\t\t</Divider>\r\n\t\t\t<Space>\r\n\t\t\t\t{BUTTONS.add && (\r\n\t\t\t\t\t<Button type=\"primary\" icon={<PlusCircleOutlined />}>\r\n\t\t\t\t\t\t新增\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t\t{BUTTONS.edit && (\r\n\t\t\t\t\t<Button type=\"primary\" icon={<EditOutlined />}>\r\n\t\t\t\t\t\t编辑\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t\t{BUTTONS.delete && (\r\n\t\t\t\t\t<Button type=\"primary\" icon={<DeleteOutlined />}>\r\n\t\t\t\t\t\t删除\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t\t{BUTTONS.import && (\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\r\n\t\t\t\t\t\t导入数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t\t{BUTTONS.export && (\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\r\n\t\t\t\t\t\t导出数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t</Space>\r\n\r\n\t\t\t<Divider orientation=\"left\" plain className=\"mt30\">\r\n\t\t\t\t使用 HOC 绑定按钮权限\r\n\t\t\t</Divider>\r\n\t\t\t<Space>\r\n\t\t\t\t<AuthButton authority=\"add\">\r\n\t\t\t\t\t<Button type=\"primary\" icon={<PlusCircleOutlined />}>\r\n\t\t\t\t\t\t新增\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority=\"edit\">\r\n\t\t\t\t\t<Button type=\"primary\" icon={<EditOutlined />}>\r\n\t\t\t\t\t\t编辑\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority=\"delete\">\r\n\t\t\t\t\t<Button type=\"primary\" icon={<DeleteOutlined />}>\r\n\t\t\t\t\t\t删除\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority=\"import\">\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\r\n\t\t\t\t\t\t导入数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority=\"export\">\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\r\n\t\t\t\t\t\t导出数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t</Space>\r\n\r\n\t\t\t<Divider orientation=\"left\" plain className=\"mt30\">\r\n\t\t\t\t使用 HOC 绑定多个按钮权限\r\n\t\t\t</Divider>\r\n\t\t\t<Space>\r\n\t\t\t\t<AuthButton authority={['add', 'edit', 'delete', 'import', 'export']}>\r\n\t\t\t\t\t<Button type=\"primary\" icon={<PlusCircleOutlined />}>\r\n\t\t\t\t\t\t新增\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority={['add', 'edit', 'delete', 'import', 'export']}>\r\n\t\t\t\t\t<Button type=\"primary\" icon={<EditOutlined />}>\r\n\t\t\t\t\t\t编辑\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority={['add', 'edit', 'delete', 'import', 'export']}>\r\n\t\t\t\t\t<Button type=\"primary\" icon={<DeleteOutlined />}>\r\n\t\t\t\t\t\t删除\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority={['add', 'edit', 'delete', 'import', 'export']}>\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\r\n\t\t\t\t\t\t导入数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t\t<AuthButton authority={['add', 'edit', 'delete', 'import', 'export']}>\r\n\t\t\t\t\t<Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\r\n\t\t\t\t\t\t导出数据\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</AuthButton>\r\n\t\t\t</Space>\r\n\t\t</Card>\r\n\t)\r\n}\r\n\r\nexport default AuthButtonPage\r\n"],"names":["useAuthButton","authButtonList","useSelector","state","auth","meta","getMenuByPath","currentPageAuthButton","key","forEach","item","BUTTONS","AuthButton","authority","children","_a","isAuth","_b","jsx","React","AuthButton$1","AuthButtonPage","Card","Alert","Divider","Space","Button","PlusCircleOutlined","EditOutlined","DeleteOutlined","VerticalAlignTopOutlined","VerticalAlignBottomOutlined"],"mappings":"4KAMA,MAAMA,EAAgBA,IAAM,SAC3B,MAAMC,EAAiBC,EAAaC,GAAqBA,EAAMC,KAAKH,cAAc,EAkB5EI,IAAOC,EAAAA,MAAAA,YAAAA,EAAiBD,OAAQ,CAAA,EAEtC,IAAIE,EAAoD,CAAA,EAEzCN,OAAAA,EAAAA,EAAAI,EAAKG,GAAI,IAATP,MAAAA,EAAYQ,WAAiBF,EAAsBG,CAAI,EAAI,IAEnE,CACNC,QAASJ,EAEX,ECvBMK,EAAwC,CAAC,CAAE,UAAAC,EAAW,SAAAC,KAAe,SAC1E,MAAMb,EAAiBC,EAAYC,GAASA,EAAM,KAAK,cAAc,GAAK,GAEpEE,IAAOU,EAAAT,MAAA,YAAAS,EAAiB,OAAQ,CAAA,EAEtC,IAAIC,EAAS,GAET,OAAA,OAAOH,GAAc,WACxBI,EAAAhB,EAAeI,EAAK,GAAI,IAAxB,MAAAY,EAA2B,SAASJ,KAAeG,EAAS,IAEzDH,aAAqB,OAASA,EAAU,QACrBA,EAAU,MAAcH,GAAA,OAAA,OAAAK,EAAAd,EAAeI,EAAK,GAAI,IAAxB,YAAAU,EAA2B,SAASL,GAAK,IACrEM,EAAS,IAGpBE,EAAAA,IAAAC,EAAM,SAAN,CAAgB,YAAUL,CAAS,CAAA,CAC5C,EAEAM,EAAeD,EAAM,KAAKP,CAAU,ECxB9BS,EAA2B,IAAM,CAChC,KAAA,CAAE,QAAAV,GAAYX,IAEpB,cACEsB,EACA,CAAA,SAAA,CAAAJ,EAAA,IAACK,EAAM,CAAA,QAAS,YAAY,KAAK,UAAU,OAAO,KAAKZ,CAAO,CAAC,CAAC,GAAI,KAAK,UAAU,SAAQ,GAAC,EAC5FO,EAAAA,IAACM,GAAQ,YAAY,OAAO,MAAK,GAAC,UAAU,OAAO,SAEnD,iBAAA,CAAA,SACCC,EACC,CAAA,SAAA,CAAQd,EAAA,WACPe,EAAO,CAAA,KAAK,UAAU,KAAMR,EAAAA,IAACS,EAAmB,CAAA,CAAA,EAAI,SAErD,IAAA,CAAA,EAEAhB,EAAQ,MACRO,EAAAA,IAACQ,EAAO,CAAA,KAAK,UAAU,KAAMR,EAAAA,IAACU,EAAa,CAAA,CAAA,EAAI,SAE/C,IAAA,CAAA,EAEAjB,EAAQ,QACRO,EAAAA,IAACQ,EAAO,CAAA,KAAK,UAAU,KAAMR,EAAAA,IAACW,EAAe,CAAA,CAAA,EAAI,SAEjD,IAAA,CAAA,EAEAlB,EAAQ,QACRO,EAAAA,IAACQ,EAAO,CAAA,KAAK,UAAU,KAAMR,EAAAA,IAACY,EAAyB,CAAA,CAAA,EAAI,SAE3D,MAAA,CAAA,EAEAnB,EAAQ,QACRO,EAAAA,IAACQ,EAAO,CAAA,KAAK,UAAU,KAAMR,EAAAA,IAACa,EAA4B,CAAA,CAAA,EAAI,SAE9D,MAAA,CAAA,CAAA,EAEF,EAEAb,EAAAA,IAACM,GAAQ,YAAY,OAAO,MAAK,GAAC,UAAU,OAAO,SAEnD,eAAA,CAAA,SACCC,EACA,CAAA,SAAA,CAAAP,EAAA,IAACN,EAAW,CAAA,UAAU,MACrB,SAAAM,EAAAA,IAACQ,EAAO,CAAA,KAAK,UAAU,KAAOR,EAAA,IAAAS,EAAA,CAAA,CAAmB,EAAI,SAAA,IAErD,CAAA,EACD,EACCT,EAAA,IAAAN,EAAA,CAAW,UAAU,OACrB,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,KAAMR,EAAA,IAACU,EAAa,CAAA,CAAA,EAAI,aAE/C,CAAA,EACD,EACCV,EAAA,IAAAN,EAAA,CAAW,UAAU,SACrB,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,KAAMR,EAAA,IAACW,EAAe,CAAA,CAAA,EAAI,aAEjD,CAAA,EACD,EACCX,EAAA,IAAAN,EAAA,CAAW,UAAU,SACrB,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,KAAMR,EAAA,IAACY,EAAyB,CAAA,CAAA,EAAI,eAE3D,CAAA,EACD,EACCZ,EAAA,IAAAN,EAAA,CAAW,UAAU,SACrB,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,KAAMR,EAAA,IAACa,EAA4B,CAAA,CAAA,EAAI,eAE9D,CAAA,EACD,CAAA,EACD,EAEAb,EAAAA,IAACM,GAAQ,YAAY,OAAO,MAAK,GAAC,UAAU,OAAO,SAEnD,iBAAA,CAAA,SACCC,EACA,CAAA,SAAA,CAAAP,EAAAA,IAACN,GAAW,UAAW,CAAC,MAAO,OAAQ,SAAU,SAAU,QAAQ,EAClE,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,WAAOC,EAAmB,CAAA,CAAA,EAAI,cAErD,CACD,CAAA,QACCf,EAAW,CAAA,UAAW,CAAC,MAAO,OAAQ,SAAU,SAAU,QAAQ,EAClE,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,WAAOE,EAAa,CAAA,CAAA,EAAI,cAE/C,CACD,CAAA,QACChB,EAAW,CAAA,UAAW,CAAC,MAAO,OAAQ,SAAU,SAAU,QAAQ,EAClE,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,WAAOG,EAAe,CAAA,CAAA,EAAI,cAEjD,CACD,CAAA,QACCjB,EAAW,CAAA,UAAW,CAAC,MAAO,OAAQ,SAAU,SAAU,QAAQ,EAClE,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,WAAOI,EAAyB,CAAA,CAAA,EAAI,gBAE3D,CACD,CAAA,QACClB,EAAW,CAAA,UAAW,CAAC,MAAO,OAAQ,SAAU,SAAU,QAAQ,EAClE,SAACM,EAAAA,IAAAQ,EAAA,CAAO,KAAK,UAAU,WAAOK,EAA4B,CAAA,CAAA,EAAI,gBAE9D,CACD,CAAA,CAAA,EACD,CACD,CAAA,CAAA,CAEF"}