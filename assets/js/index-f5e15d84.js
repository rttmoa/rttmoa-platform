import{b0 as x,b1 as g,r as a,ax as n,j as e,B as p,aa as k,ak as b,m as D}from"./index-3957a516.js";import{C as L}from"./index-1107b54a.js";import{T as R}from"./Table-1fefb412.js";import{S as u}from"./index-7d840c80.js";import"./index-f58f0e9c.js";import"./styleChecker-05134c12.js";import"./addEventListener-a826476c.js";import"./List-0e1ae3e6.js";import"./Tree-db5072ad.js";import"./conductUtil-f43807c6.js";import"./useMultipleSelect-92119d87.js";import"./Pagination-aea0c4ec.js";import"./zh_CN-f51ae7db.js";import"./index-8679876f.js";import"./index-a77b8328.js";import"./index-a50f25cb.js";import"./useBubbleLock-e13a7356.js";import"./index-99aa7995.js";import"./useShowArrow-fa21a597.js";import"./useIcons-5870fba2.js";import"./index-ae7ffe7f.js";import"./iconUtil-68c18442.js";import"./useLazyKVMap-ec4a154a.js";import"./Select-82bff7d6.js";const M=s=>x.get(g+`/category/list?parentId=${s}`),P=(s,r)=>x.post(g+"/category/add",{parentId:s,categoryName:r}),$=(s,r)=>x.post(g+"/category/update",{parentId:s,categoryName:r}),ge=()=>{const[s,r]=a.useState(!1),[o,i]=a.useState("0"),[w,y]=a.useState(""),[h,I]=a.useState({}),[j,N]=a.useState([]),[O,f]=a.useState([]),[C,c]=a.useState(0),[S]=n.useForm(),[F]=n.useForm(),m=async t=>{r(!0),t=t||o;const l=await M(t);if(r(!1),l.code===200){let d=l.data.map((A,B)=>({...A,key:B}));t=="0"?N(d):f(d)}else D.error("获取分类列表失败")};a.useEffect(()=>{m("")},[]);const _=[{title:o==="0"?"一级分类名称":"二级分类名称",dataIndex:"name"},{title:"操作",width:300,render:t=>e.jsxs("span",{children:[e.jsx(p,{style:{color:"#fe8281"},type:"link",onClick:()=>{E(t)},children:o==="0"?"修改一级分类":"修改二级分类"}),o==="0"?e.jsx(p,{type:"link",onClick:()=>{V(t)},children:"查看子分类"}):null]})}],E=t=>{I(t),c(2)},V=t=>{i(t._id),y(t.name),m(t._id)},T=()=>{i("0"),y(""),f([])},U=async()=>{const{parentId:t,categoryName:l}=S.getFieldsValue(),d=await P(t,l);c(0),d.code===200&&(t===o?m(t):t==="0"&&m("0"))},v=async()=>{c(0);const t=h._id,{categoryName:l}=F.getFieldsValue();(await $(t,l)).code===200&&m("")};return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:o==="0"?"一级分类列表":e.jsxs("span",{children:[e.jsx(p,{onClick:T,type:"link",children:e.jsx("b",{children:"一级分类列表"})}),"->","   ",e.jsx("span",{className:"font-normal font-serif",children:w})]}),extra:e.jsx(p,{type:"primary",onClick:()=>{c(1)},children:"添加分类"}),children:e.jsx(R,{loading:s,columns:_,dataSource:o==="0"?j:O})}),e.jsx(k,{title:"添加分类",open:C===1,onOk:U,onCancel:()=>{c(0)},children:e.jsx(q,{categorys:j,parentId:o,form:S})}),e.jsx(k,{title:"修改分类",open:C===2,onOk:v,onCancel:()=>{c(0)},children:e.jsx(z,{categoryName:h.name,form:F})})]})};function q({categorys:s,parentId:r,form:o}){return a.useEffect(()=>()=>{o.resetFields()}),e.jsx(e.Fragment,{children:e.jsxs(n,{form:o,initialValues:{parentId:r},children:[e.jsx(n.Item,{name:"parentId",children:e.jsxs(u,{children:[e.jsx(u.Option,{value:"0",children:"一级分类"}),s.map(i=>e.jsx(u.Option,{value:i._id,children:i.name},i._id))]})}),e.jsx(n.Item,{name:"categoryName",children:e.jsx(b,{placeholder:"请输入分类名称"})})]})})}function z({categoryName:s,form:r}){return a.useEffect(()=>()=>{r.resetFields()}),e.jsx(e.Fragment,{children:e.jsx(n,{form:r,initialValues:{categoryName:s},children:e.jsx(n.Item,{name:"categoryName",children:e.jsx(b,{placeholder:"请输入分类名称"})})})})}export{ge as default};
//# sourceMappingURL=index-f5e15d84.js.map
