{"version":3,"file":"index-3ebf9430.js","sources":["../../../src/hooks/useAuthButton.ts","../../../src/components/AuthButton/index.tsx","../../../src/views/auth/button/index.tsx"],"sourcesContent":["import { RootState, useSelector } from \"@/redux\";\nimport { getMenuByPath } from \"@/utils\";\n\n/**\n * @description  use Hooks Set auth button\n */\nconst useAuthButton = () => {\n  const authButtonList = useSelector((state: RootState) => state.auth.authButtonList);\n  // console.log(authButtonList);\n  // {\n  //   \"authButton\": [\n  //       \"add\",\n  //       \"edit\",\n  //       \"delete\",\n  //       \"import\",\n  //       \"export\"\n  //   ],\n  //   \"useProTable\": [\n  //       \"add\",\n  //       \"batchAdd\",\n  //       \"export\",\n  //       \"batchDelete\",\n  //       \"status\"\n  //     ]\n  // }\n  const meta = getMenuByPath()?.meta ?? {};\n\n  let currentPageAuthButton: { [key: string]: boolean } = {};\n\n  authButtonList[meta.key!]?.forEach(item => (currentPageAuthButton[item] = true));\n\n  return {\n    BUTTONS: currentPageAuthButton\n  };\n};\n\nexport default useAuthButton;\n","import React from \"react\";\nimport { useSelector } from \"@/redux\";\nimport { getMenuByPath } from \"@/utils\";\n\ntype authStr = \"add\" | \"edit\" | \"delete\" | \"import\" | \"export\";\ntype authArr = [\"add\", \"edit\", \"delete\", \"import\", \"export\"];\ntype AuthButtonProps = {\n  authority: string | string[];\n  children: React.ReactNode;\n};\n\nconst AuthButton: React.FC<AuthButtonProps> = ({ authority, children }) => {\n  const authButtonList = useSelector(state => state.auth.authButtonList) ?? [];\n\n  const meta = getMenuByPath()?.meta ?? {};\n\n  let isAuth = false;\n\n  if (typeof authority === \"string\") {\n    authButtonList[meta.key!]?.includes(authority) && (isAuth = true);\n  }\n  if (authority instanceof Array && authority.length) {\n    const hasPermission = authority.every(item => authButtonList[meta.key!]?.includes(item));\n    hasPermission && (isAuth = true);\n  }\n\n  return <React.Fragment>{isAuth && children}</React.Fragment>;\n};\n\nexport default React.memo(AuthButton);\n","import useAuthButton from \"@/hooks/useAuthButton\";\nimport AuthButton from \"@/components/AuthButton\";\nimport { Alert, Button, Card, Divider, Space } from \"antd\";\nimport {\n  DeleteOutlined,\n  EditOutlined,\n  PlusCircleOutlined,\n  VerticalAlignBottomOutlined,\n  VerticalAlignTopOutlined\n} from \"@ant-design/icons\";\n\nconst AuthButtonPage: React.FC = () => {\n  const { BUTTONS } = useAuthButton();\n\n  return (\n    <Card>\n      <Alert message={`当前用户按钮权限：${JSON.stringify(Object.keys(BUTTONS))}`} type=\"success\" showIcon />\n      <Divider orientation=\"left\" plain className=\"mt30\">\n        使用 Hooks 绑定按钮权限\n      </Divider>\n      <Space>\n        {BUTTONS.add && (\n          <Button type=\"primary\" icon={<PlusCircleOutlined />}>\n            新增\n          </Button>\n        )}\n        {BUTTONS.edit && (\n          <Button type=\"primary\" icon={<EditOutlined />}>\n            编辑\n          </Button>\n        )}\n        {BUTTONS.delete && (\n          <Button type=\"primary\" icon={<DeleteOutlined />}>\n            删除\n          </Button>\n        )}\n        {BUTTONS.import && (\n          <Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\n            导入数据\n          </Button>\n        )}\n        {BUTTONS.export && (\n          <Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\n            导出数据\n          </Button>\n        )}\n      </Space>\n\n      <Divider orientation=\"left\" plain className=\"mt30\">\n        使用 HOC 绑定按钮权限\n      </Divider>\n      <Space>\n        <AuthButton authority=\"add\">\n          <Button type=\"primary\" icon={<PlusCircleOutlined />}>\n            新增\n          </Button>\n        </AuthButton>\n        <AuthButton authority=\"edit\">\n          <Button type=\"primary\" icon={<EditOutlined />}>\n            编辑\n          </Button>\n        </AuthButton>\n        <AuthButton authority=\"delete\">\n          <Button type=\"primary\" icon={<DeleteOutlined />}>\n            删除\n          </Button>\n        </AuthButton>\n        <AuthButton authority=\"import\">\n          <Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\n            导入数据\n          </Button>\n        </AuthButton>\n        <AuthButton authority=\"export\">\n          <Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\n            导出数据\n          </Button>\n        </AuthButton>\n      </Space>\n\n      <Divider orientation=\"left\" plain className=\"mt30\">\n        使用 HOC 绑定多个按钮权限\n      </Divider>\n      <Space>\n        <AuthButton authority={[\"add\", \"edit\", \"delete\", \"import\", \"export\"]}>\n          <Button type=\"primary\" icon={<PlusCircleOutlined />}>\n            新增\n          </Button>\n        </AuthButton>\n        <AuthButton authority={[\"add\", \"edit\", \"delete\", \"import\", \"export\"]}>\n          <Button type=\"primary\" icon={<EditOutlined />}>\n            编辑\n          </Button>\n        </AuthButton>\n        <AuthButton authority={[\"add\", \"edit\", \"delete\", \"import\", \"export\"]}>\n          <Button type=\"primary\" icon={<DeleteOutlined />}>\n            删除\n          </Button>\n        </AuthButton>\n        <AuthButton authority={[\"add\", \"edit\", \"delete\", \"import\", \"export\"]}>\n          <Button type=\"primary\" icon={<VerticalAlignTopOutlined />}>\n            导入数据\n          </Button>\n        </AuthButton>\n        <AuthButton authority={[\"add\", \"edit\", \"delete\", \"import\", \"export\"]}>\n          <Button type=\"primary\" icon={<VerticalAlignBottomOutlined />}>\n            导出数据\n          </Button>\n        </AuthButton>\n      </Space>\n    </Card>\n  );\n};\n\nexport default AuthButtonPage;\n"],"names":["useAuthButton","authButtonList","useSelector","state","auth","meta","getMenuByPath","currentPageAuthButton","key","forEach","item","BUTTONS","AuthButton","authority","children","_a","isAuth","_b","jsx","React","AuthButton$1","AuthButtonPage","Card","Alert","Divider","Space","Button","PlusCircleOutlined","EditOutlined","DeleteOutlined","VerticalAlignTopOutlined","VerticalAlignBottomOutlined"],"mappings":"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"}