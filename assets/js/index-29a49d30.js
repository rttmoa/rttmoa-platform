import{r as h,cg as Z,j as u,a8 as ie,aP as ee,O as v,M,I as ue,J as ne,K as re,cF as de,t as Y,a as R,C as X,R as ce,ar as me}from"./index-6ab6cade.js";import{u as ae,b as le,a as ve}from"./index-cc70f193.js";import{i as fe}from"./index-8a0f6792.js";import{B as pe}from"./BaseForm-16c08f45.js";var he=function(e){if(e&&e!==!0)return e},Ce=function(e,c,n,s){return e?u.jsxs(u.Fragment,{children:[n.getMessage("tableForm.collapsed","展开"),s&&"(".concat(s,")"),u.jsx(ee,{style:{marginInlineStart:"0.5em",transition:"0.3s all",transform:"rotate(".concat(e?0:.5,"turn)")}})]}):u.jsxs(u.Fragment,{children:[n.getMessage("tableForm.expand","收起"),u.jsx(ee,{style:{marginInlineStart:"0.5em",transition:"0.3s all",transform:"rotate(".concat(e?0:.5,"turn)")}})]})},xe=function(e){var c=e.setCollapsed,n=e.collapsed,s=n===void 0?!1:n,a=e.submitter,i=e.style,F=e.hiddenNum,C=h.useContext(Z.ConfigContext),N=C.getPrefixCls,w=ae(),E=h.useContext(le),T=E.hashId,b=he(e.collapseRender)||Ce;return u.jsxs(ie,{style:i,size:16,children:[a,e.collapseRender!==!1&&u.jsx("a",{className:"".concat(N("pro-query-filter-collapse-button")," ").concat(T).trim(),onClick:function(){return c(!s)},children:b==null?void 0:b(s,e,w,F)})]})};const ge=xe;var be=function(e){return M({},e.componentCls,M(M(M(M({"&&":{padding:24}},"".concat(e.antCls,"-form-item"),{marginBlock:0}),"".concat(e.proComponentsCls,"-form-group-title"),{marginBlock:0}),"&-row",{rowGap:24,"&-split":M(M({},"".concat(e.proComponentsCls,"-form-group"),{display:"flex",alignItems:"center",gap:e.marginXS}),"&:last-child",{marginBlockEnd:12}),"&-split-line":{"&:after":{position:"absolute",width:"100%",content:'""',height:1,insetBlockEnd:-12,borderBlockEnd:"1px dashed ".concat(e.colorSplit)}}}),"&-collapse-button",{display:"flex",alignItems:"center",color:e.colorPrimary}))};function ye(t){return ve("QueryFilter",function(e){var c=v(v({},e),{},{componentCls:".".concat(t)});return[be(c)]})}var Se=["collapsed","layout","defaultCollapsed","defaultColsNumber","defaultFormItemsNumber","span","searchGutter","searchText","resetText","optionRender","collapseRender","onReset","onCollapse","labelWidth","style","split","preserve","ignoreRules","showHiddenNum","submitterColSpanProps"],j,Re={xs:513,sm:513,md:785,lg:992,xl:1057,xxl:1/0},te={vertical:[[513,1,"vertical"],[785,2,"vertical"],[1057,3,"vertical"],[1/0,4,"vertical"]],default:[[513,1,"vertical"],[701,2,"vertical"],[1062,3,"horizontal"],[1352,3,"horizontal"],[1/0,4,"horizontal"]]},Ne=function(e,c,n){if(n&&typeof n=="number")return{span:n,layout:e};var s=n?["xs","sm","md","lg","xl","xxl"].map(function(i){return[Re[i],24/n[i],"horizontal"]}):te[e||"default"],a=(s||te.default).find(function(i){return c<i[0]+16});return a?{span:24/a[1],layout:a==null?void 0:a[2]}:{span:8,layout:"horizontal"}},we=function(e,c){return e==null?void 0:e.flatMap(function(n){var s,a;if((n==null||(s=n.type)===null||s===void 0?void 0:s.displayName)==="ProForm-Group"&&!((a=n.props)!==null&&a!==void 0&&a.title))return n.props.children;if(c&&R.isValidElement(n)){var i;return R.cloneElement(n,v(v({},n.props),{},{formItemProps:v(v({},(i=n.props)===null||i===void 0?void 0:i.formItemProps),{},{rules:[]})}))}return n})},Pe=function(e){var c,n,s,a,i=ae(),F=h.useContext(le),C=F.hashId,N=e.resetText||i.getMessage("tableForm.reset","重置"),w=e.searchText||i.getMessage("tableForm.search","搜索"),E=ne(function(){return e.defaultCollapsed&&!!e.submitter},{value:e.collapsed,onChange:e.onCollapse}),T=re(E,2),b=T[0],$=T[1],f=e.optionRender,x=e.collapseRender,Q=e.split,W=e.items,y=e.spanSize,B=e.showLength,A=e.searchGutter,V=e.showHiddenNum,D=h.useMemo(function(){return!e.submitter||f===!1?null:R.cloneElement(e.submitter,v({searchConfig:{resetText:N,submitText:w},render:f&&function(r,o){return f(v(v({},e),{},{resetText:N,searchText:w}),e,o)}},e.submitter.props))},[e,N,w,f]),P=0,H=0,z=!1,_=0,p=0,k=we(W,e.ignoreRules).map(function(r,o){var d,m,l,S,O=R.isValidElement(r)&&(d=r==null||(m=r.props)===null||m===void 0?void 0:m.colSize)!==null&&d!==void 0?d:1,I=Math.min(y.span*(O||1),24);if(P+=I,_+=O,o===0){var U;z=I===24&&!(r!=null&&(U=r.props)!==null&&U!==void 0&&U.hidden)}var oe=(r==null||(l=r.props)===null||l===void 0?void 0:l.hidden)||b&&(z||_>B)&&!!o;H+=1;var se=R.isValidElement(r)&&(r.key||"".concat((S=r.props)===null||S===void 0?void 0:S.name))||o;return R.isValidElement(r)&&oe?e.preserve?{itemDom:R.cloneElement(r,{hidden:!0,key:se||o}),hidden:!0,colSpan:I}:{itemDom:null,colSpan:0,hidden:!0}:{itemDom:r,colSpan:I,hidden:!1}}),q=k.map(function(r,o){var d,m,l=r.itemDom,S=r.colSpan,O=l==null||(d=l.props)===null||d===void 0?void 0:d.hidden;if(O)return l;var I=R.isValidElement(l)&&(l.key||"".concat((m=l.props)===null||m===void 0?void 0:m.name))||o;return 24-p%24<S&&(P+=24-p%24,p+=24-p%24),p+=S,Q&&p%24===0&&o<H-1?u.jsx(X,{span:S,className:"".concat(e.baseClassName,"-row-split-line ").concat(e.baseClassName,"-row-split ").concat(C).trim(),children:l},I):u.jsx(X,{className:"".concat(e.baseClassName,"-row-split ").concat(C).trim(),span:S,children:l},I)}),K=V&&k.filter(function(r){return r.hidden}).length,G=h.useMemo(function(){return!(P<24||_<=B)},[_,B,P]),J=h.useMemo(function(){var r,o,d=p%24+((r=(o=e.submitterColSpanProps)===null||o===void 0?void 0:o.span)!==null&&r!==void 0?r:y.span);if(d>24){var m,l;return 24-((m=(l=e.submitterColSpanProps)===null||l===void 0?void 0:l.span)!==null&&m!==void 0?m:y.span)}return 24-d},[p,p%24+((c=(n=e.submitterColSpanProps)===null||n===void 0?void 0:n.span)!==null&&c!==void 0?c:y.span),(s=e.submitterColSpanProps)===null||s===void 0?void 0:s.span]),g=h.useContext(Z.ConfigContext),L=g.getPrefixCls("pro-query-filter");return u.jsxs(ce,{gutter:A,justify:"start",className:Y("".concat(L,"-row"),C),children:[q,D&&u.jsx(X,v(v({span:y.span,offset:J,className:Y((a=e.submitterColSpanProps)===null||a===void 0?void 0:a.className)},e.submitterColSpanProps),{},{style:{textAlign:"end"},children:u.jsx(me.Item,{label:" ",colon:!1,shouldUpdate:!1,className:"".concat(L,"-actions ").concat(C).trim(),children:u.jsx(ge,{hiddenNum:K,collapsed:b,collapseRender:G?x:!1,submitter:D,setCollapsed:$},"pro-form-query-filter-actions")})}),"submitter")]},"resize-observer-row")},_e=fe()?(j=document)===null||j===void 0||(j=j.body)===null||j===void 0?void 0:j.clientWidth:1024;function ze(t){var e=t.collapsed,c=t.layout,n=t.defaultCollapsed,s=n===void 0?!0:n,a=t.defaultColsNumber,i=t.defaultFormItemsNumber,F=t.span,C=t.searchGutter,N=C===void 0?24:C;t.searchText,t.resetText;var w=t.optionRender,E=t.collapseRender,T=t.onReset,b=t.onCollapse,$=t.labelWidth,f=$===void 0?"80":$,x=t.style,Q=t.split,W=t.preserve,y=W===void 0?!0:W,B=t.ignoreRules,A=t.showHiddenNum,V=A===void 0?!1:A,D=t.submitterColSpanProps,P=ue(t,Se),H=h.useContext(Z.ConfigContext),z=H.getPrefixCls("pro-query-filter"),_=ye(z),p=_.wrapSSR,k=_.hashId,q=ne(function(){return typeof(x==null?void 0:x.width)=="number"?x==null?void 0:x.width:_e}),K=re(q,2),G=K[0],J=K[1],g=h.useMemo(function(){return Ne(c,G+16,F)},[c,G,F]),L=h.useMemo(function(){if(i!==void 0)return i;if(a!==void 0){var o=24/g.span-1;return a>o?o:a}return Math.max(1,24/g.span-1)},[a,i,g.span]),r=h.useMemo(function(){if(f&&g.layout!=="vertical"&&f!=="auto")return{labelCol:{flex:"0 0 ".concat(f,"px")},wrapperCol:{style:{maxWidth:"calc(100% - ".concat(f,"px)")}},style:{flexWrap:"nowrap"}}},[g.layout,f]);return p(u.jsx(de,{onResize:function(d){G!==d.width&&d.width>17&&J(d.width)},children:u.jsx(pe,v(v({isKeyPressSubmit:!0,preserve:y},P),{},{className:Y(z,k,P.className),onReset:T,style:x,layout:g.layout,fieldProps:{style:{width:"100%"}},formItemProps:r,groupProps:{titleStyle:{display:"inline-block",marginInlineEnd:16}},contentRender:function(d,m,l){return u.jsx(Pe,{spanSize:g,collapsed:e,form:l,submitterColSpanProps:D,collapseRender:E,defaultCollapsed:s,onCollapse:b,optionRender:w,submitter:m,items:d,split:Q,baseClassName:z,resetText:t.resetText,searchText:t.searchText,searchGutter:N,preserve:y,ignoreRules:B,showLength:L,showHiddenNum:V})}}))},"resize-observer"))}export{ze as Q,he as o};
//# sourceMappingURL=index-29a49d30.js.map
