import{t as Kt,d as $e,u as Vt,K as le,h as ot}from"./rc-util-8976b5fa.js";import{d as K,g as j,c as ft,b as _t,e as U,h as vt,f as Mt}from"./@babel-c46ce09a.js";import{u as Nt,b as Ot,B as Pt}from"./rc-select-8e380119.js";import{r}from"./react-12b51ca5.js";import{a as qe,c as Rt,T as At}from"./rc-tree-898f7873.js";import"./classnames-3ded05b8.js";import"./rc-overflow-7fc9dc70.js";import"./react-dom-e71a48dd.js";import"./rc-resize-observer-5c9960e4.js";import"./rc-motion-25d44171.js";const Ht=function(e){var t=r.useRef({valueLabels:new Map});return r.useMemo(function(){var n=t.current.valueLabels,u=new Map,l=e.map(function(o){var a,c=o.value,i=(a=o.label)!==null&&a!==void 0?a:n.get(c);return u.set(c,i),K(K({},o),{},{label:i})});return t.current.valueLabels=u,[l]},[e])},$t=function(e,t,n,u){return r.useMemo(function(){var l=e.map(function(i){var f=i.value;return f}),o=t.map(function(i){var f=i.value;return f}),a=l.filter(function(i){return!u[i]});if(n){var c=qe(l,!0,u);l=c.checkedKeys,o=c.halfCheckedKeys}return[Array.from(new Set([].concat(j(a),j(l)))),o]},[e,t,n,u])};function Ft(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Wt(e){var t=e||{},n=t.label,u=t.value,l=t.children,o=u||"value";return{_title:n?[n]:["title","label"],value:o,key:o,children:l||"children"}}function ze(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function jt(e,t){var n=[];function u(l){l.forEach(function(o){var a=o[t.children];a&&(n.push(o[t.value]),u(a))})}return u(e),n}function ct(e){return e==null}const Ut=function(e,t){return r.useMemo(function(){var n=Rt(e,{fieldNames:t,initWrapper:function(l){return K(K({},l),{},{valueEntities:new Map})},processEntity:function(l,o){var a=l.node[t.value];o.valueEntities.set(a,l)}});return n},[e,t])};var ht=function(){return null},Bt=["children","value"];function pt(e){return Kt(e).map(function(t){if(!r.isValidElement(t)||!t.type)return null;var n=t,u=n.key,l=n.props,o=l.children,a=l.value,c=ft(l,Bt),i=K({key:u,value:a},c),f=pt(o);return f.length&&(i.children=f),i}).filter(function(t){return t})}function Qe(e){if(!e)return e;var t=K({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return $e(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function Gt(e,t,n,u,l,o){var a=null,c=null;function i(){function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return d.map(function(C,R){var x="".concat(I,"-").concat(R),V=C[o.value],A=n.includes(V),B=f(C[o.children]||[],x,A),H=r.createElement(ht,C,B.map(function(g){return g.node}));if(t===V&&(a=H),A){var Z={pos:x,node:H,children:B};return k||c.push(Z),Z}return null}).filter(function(C){return C})}c||(c=[],f(u),c.sort(function(d,I){var k=d.node.props.value,C=I.node.props.value,R=n.indexOf(k),x=n.indexOf(C);return R-x}))}Object.defineProperty(e,"triggerNode",{get:function(){return $e(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),i(),a}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return $e(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),i(),l?c:c.map(function(d){var I=d.node;return I})}})}const Jt=function(e,t,n){var u=n.treeNodeFilterProp,l=n.filterTreeNode,o=n.fieldNames,a=o.children;return r.useMemo(function(){if(!t||l===!1)return e;var c;if(typeof l=="function")c=l;else{var i=t.toUpperCase();c=function(I,k){var C=k[u];return String(C).toUpperCase().includes(i)}}function f(d){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d.reduce(function(k,C){var R=C[a],x=I||c(t,Qe(C)),V=f(R||[],x);return(x||V.length)&&k.push(K(K({},C),{},_t({isLeaf:void 0},a,V))),k},[])}return f(e)},[e,t,a,u,l])};function dt(e){var t=r.useRef();t.current=e;var n=r.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}function Yt(e,t){var n=t.id,u=t.pId,l=t.rootPId,o={},a=[],c=e.map(function(i){var f=K({},i),d=f[n];return o[d]=f,f.key=f.key||d,f});return c.forEach(function(i){var f=i[u],d=o[f];d&&(d.children=d.children||[],d.children.push(i)),(f===l||!d&&l===null)&&a.push(i)}),a}function qt(e,t,n){return r.useMemo(function(){return e?n?Yt(e,K({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:pt(t)},[t,n,e])}var mt=r.createContext(null),gt=r.createContext(null),zt={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Qt=function(t,n){var u=Nt(),l=u.prefixCls,o=u.multiple,a=u.searchValue,c=u.toggleOpen,i=u.open,f=u.notFoundContent,d=r.useContext(gt),I=d.virtual,k=d.listHeight,C=d.listItemHeight,R=d.listItemScrollOffset,x=d.treeData,V=d.fieldNames,A=d.onSelect,B=d.dropdownMatchSelectWidth,H=d.treeExpandAction,Z=d.treeTitleRender,g=r.useContext(mt),_=g.checkable,T=g.checkedKeys,ie=g.halfCheckedKeys,ue=g.treeExpandedKeys,We=g.treeDefaultExpandAll,je=g.treeDefaultExpandedKeys,oe=g.onTreeExpand,Ee=g.treeIcon,ke=g.showTreeIcon,xe=g.switcherIcon,De=g.treeLine,we=g.treeNodeFilterProp,Ie=g.loadData,ce=g.treeLoadedKeys,Te=g.treeMotion,Le=g.onTreeLoad,Ke=g.keyEntities,G=r.useRef(),de=Vt(function(){return x},[i,x],function(b,h){return h[0]&&b[1]!==h[1]}),Ve=r.useState(null),se=U(Ve,2),J=se[0],fe=se[1],M=Ke[J],_e=r.useMemo(function(){return _?{checked:T,halfChecked:ie}:null},[_,T,ie]);r.useEffect(function(){if(i&&!o&&T.length){var b;(b=G.current)===null||b===void 0||b.scrollTo({key:T[0]}),fe(T[0])}},[i]);var ve=String(a).toLowerCase(),Me=function(h){return ve?String(h[we]).toLowerCase().includes(ve):!1},Ne=r.useState(je),he=U(Ne,2),Y=he[0],Ue=he[1],Be=r.useState(null),q=U(Be,2),z=q[0],pe=q[1],N=r.useMemo(function(){return ue?j(ue):a?z:Y},[Y,z,ue,a]);r.useEffect(function(){a&&pe(jt(x,V))},[a]);var Ge=function(h){Ue(h),pe(h),oe&&oe(h)},me=function(h){h.preventDefault()},$=function(h,ee){var O=ee.node;_&&ze(O)||(A(O.key,{selected:!T.includes(O.key)}),o||c(!1))};if(r.useImperativeHandle(n,function(){var b;return{scrollTo:(b=G.current)===null||b===void 0?void 0:b.scrollTo,onKeyDown:function(ee){var O,Oe=ee.which;switch(Oe){case le.UP:case le.DOWN:case le.LEFT:case le.RIGHT:(O=G.current)===null||O===void 0||O.onKeyDown(ee);break;case le.ENTER:{if(M){var ye=(M==null?void 0:M.node)||{},Je=ye.selectable,te=ye.value;Je!==!1&&$(null,{node:{key:J},selected:!T.includes(te)})}break}case le.ESC:c(!1)}},onKeyUp:function(){}}}),de.length===0)return r.createElement("div",{role:"listbox",className:"".concat(l,"-empty"),onMouseDown:me},f);var ge={fieldNames:V};return ce&&(ge.loadedKeys=ce),N&&(ge.expandedKeys=N),r.createElement("div",{onMouseDown:me},M&&i&&r.createElement("span",{style:zt,"aria-live":"assertive"},M.node.value),r.createElement(At,vt({ref:G,focusable:!1,prefixCls:"".concat(l,"-tree"),treeData:de,height:k,itemHeight:C,itemScrollOffset:R,virtual:I!==!1&&B!==!1,multiple:o,icon:Ee,showIcon:ke,switcherIcon:xe,showLine:De,loadData:a?null:Ie,motion:Te,activeKey:J,checkable:_,checkStrictly:!0,checkedKeys:_e,selectedKeys:_?[]:T,defaultExpandAll:We,titleRender:Z},ge,{onActiveChange:fe,onSelect:$,onCheck:$,onExpand:Ge,onLoad:Le,filterTreeNode:Me,expandAction:H})))},Xt=r.forwardRef(Qt),yt="SHOW_ALL",St="SHOW_PARENT",Xe="SHOW_CHILD";function st(e,t,n,u){var l=new Set(e);return t===Xe?e.filter(function(o){var a=n[o];return!(a&&a.children&&a.children.some(function(c){var i=c.node;return l.has(i[u.value])})&&a.children.every(function(c){var i=c.node;return ze(i)||l.has(i[u.value])}))}):t===St?e.filter(function(o){var a=n[o],c=a?a.parent:null;return!(c&&!ze(c.node)&&l.has(c.key))}):e}var Zt=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender"];function er(e){return!e||Mt(e)!=="object"}var tr=r.forwardRef(function(e,t){var n=e.id,u=e.prefixCls,l=u===void 0?"rc-tree-select":u,o=e.value,a=e.defaultValue,c=e.onChange,i=e.onSelect,f=e.onDeselect,d=e.searchValue,I=e.inputValue,k=e.onSearch,C=e.autoClearSearchValue,R=C===void 0?!0:C,x=e.filterTreeNode,V=e.treeNodeFilterProp,A=V===void 0?"value":V,B=e.showCheckedStrategy,H=e.treeNodeLabelProp,Z=e.multiple,g=e.treeCheckable,_=e.treeCheckStrictly,T=e.labelInValue,ie=e.fieldNames,ue=e.treeDataSimpleMode,We=e.treeData,je=e.children,oe=e.loadData,Ee=e.treeLoadedKeys,ke=e.onTreeLoad,xe=e.treeDefaultExpandAll,De=e.treeExpandedKeys,we=e.treeDefaultExpandedKeys,Ie=e.onTreeExpand,ce=e.treeExpandAction,Te=e.virtual,Le=e.listHeight,Ke=Le===void 0?200:Le,G=e.listItemHeight,de=G===void 0?20:G,Ve=e.listItemScrollOffset,se=Ve===void 0?0:Ve,J=e.onDropdownVisibleChange,fe=e.dropdownMatchSelectWidth,M=fe===void 0?!0:fe,_e=e.treeLine,ve=e.treeIcon,Me=e.showTreeIcon,Ne=e.switcherIcon,he=e.treeMotion,Y=e.treeTitleRender,Ue=ft(e,Zt),Be=Ot(n),q=g&&!_,z=g||_,pe=_||T,N=z||Z,Ge=ot(a,{value:o}),me=U(Ge,2),$=me[0],ge=me[1],b=r.useMemo(function(){return g?B||Xe:yt},[B,g]),h=r.useMemo(function(){return Wt(ie)},[JSON.stringify(ie)]),ee=ot("",{value:d!==void 0?d:I,postState:function(s){return s||""}}),O=U(ee,2),Oe=O[0],ye=O[1],Je=function(s){ye(s),k==null||k(s)},te=qt(We,je,ue),Ze=Ut(te,h),L=Ze.keyEntities,Q=Ze.valueEntities,et=r.useCallback(function(v){var s=[],p=[];return v.forEach(function(y){Q.has(y)?p.push(y):s.push(y)}),{missingRawValues:s,existRawValues:p}},[Q]),tt=Jt(te,Oe,{fieldNames:h,treeNodeFilterProp:A,filterTreeNode:x}),rt=r.useCallback(function(v){if(v){if(H)return v[H];for(var s=h._title,p=0;p<s.length;p+=1){var y=v[s[p]];if(y!==void 0)return y}}},[h,H]),Se=r.useCallback(function(v){var s=Ft(v);return s.map(function(p){return er(p)?{value:p}:p})},[]),Pe=r.useCallback(function(v){var s=Se(v);return s.map(function(p){var y=p.label,D=p.value,E=p.halfChecked,S,m=Q.get(D);if(m){var w;y=(w=y)!==null&&w!==void 0?w:rt(m.node),S=m.node.disabled}else if(y===void 0){var F=Se($).find(function(Ce){return Ce.value===D});y=F.label}return{label:y,value:D,halfChecked:E,disabled:S}})},[Q,rt,Se,$]),nt=r.useMemo(function(){return Se($)},[Se,$]),Ct=r.useMemo(function(){var v=[],s=[];return nt.forEach(function(p){p.halfChecked?s.push(p):v.push(p)}),[v,s]},[nt]),at=U(Ct,2),re=at[0],lt=at[1],it=r.useMemo(function(){return re.map(function(v){return v.value})},[re]),bt=$t(re,lt,q,L),ut=U(bt,2),ne=ut[0],Re=ut[1],Et=r.useMemo(function(){var v=st(ne,b,L,h),s=v.map(function(E){var S,m;return(S=(m=L[E])===null||m===void 0||(m=m.node)===null||m===void 0?void 0:m[h.value])!==null&&S!==void 0?S:E}),p=s.map(function(E){var S=re.find(function(w){return w.value===E}),m;return T&&S.label!==void 0?m=S.label:!T&&Y&&(m=Y(S)),{value:E,label:m}}),y=Pe(p),D=y[0];return!N&&D&&ct(D.value)&&ct(D.label)?[]:y.map(function(E){var S;return K(K({},E),{},{label:(S=E.label)!==null&&S!==void 0?S:E.value})})},[h,N,ne,re,Pe,b,L]),kt=Ht(Et),xt=U(kt,1),Dt=xt[0],Ae=dt(function(v,s,p){var y=Pe(v);if(ge(y),R&&ye(""),c){var D=v;if(q){var E=st(v,b,L,h);D=E.map(function(P){var W=Q.get(P);return W?W.node[h.value]:P})}var S=s||{triggerValue:void 0,selected:void 0},m=S.triggerValue,w=S.selected,F=D;if(_){var Ce=lt.filter(function(P){return!D.includes(P.value)});F=[].concat(j(F),j(Ce))}var be=Pe(F),X={preValue:re,triggerValue:m},ae=!0;(_||p==="selection"&&!w)&&(ae=!1),Gt(X,m,v,te,ae,h),z?X.checked=w:X.selected=w;var He=pe?be:be.map(function(P){return P.value});c(N?He:He[0],pe?null:be.map(function(P){return P.label}),X)}}),Ye=r.useCallback(function(v,s){var p,y=s.selected,D=s.source,E=L[v],S=E==null?void 0:E.node,m=(p=S==null?void 0:S[h.value])!==null&&p!==void 0?p:v;if(!N)Ae([m],{selected:!0,triggerValue:m},"option");else{var w=y?[].concat(j(it),[m]):ne.filter(function(W){return W!==m});if(q){var F=et(w),Ce=F.missingRawValues,be=F.existRawValues,X=be.map(function(W){return Q.get(W).key}),ae;if(y){var He=qe(X,!0,L);ae=He.checkedKeys}else{var P=qe(X,{checked:!1,halfCheckedKeys:Re},L);ae=P.checkedKeys}w=[].concat(j(Ce),j(ae.map(function(W){return L[W].node[h.value]})))}Ae(w,{selected:y,triggerValue:m},D||"option")}y||!N?i==null||i(m,Qe(S)):f==null||f(m,Qe(S))},[et,Q,L,h,N,it,Ae,q,i,f,ne,Re]),wt=r.useCallback(function(v){if(J){var s={};Object.defineProperty(s,"documentClickClose",{get:function(){return $e(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),J(v,s)}},[J]),It=dt(function(v,s){var p=v.map(function(y){return y.value});if(s.type==="clear"){Ae(p,{},"selection");return}s.values.length&&Ye(s.values[0].value,{selected:!1,source:"selection"})}),Tt=r.useMemo(function(){return{virtual:Te,dropdownMatchSelectWidth:M,listHeight:Ke,listItemHeight:de,listItemScrollOffset:se,treeData:tt,fieldNames:h,onSelect:Ye,treeExpandAction:ce,treeTitleRender:Y}},[Te,M,Ke,de,se,tt,h,Ye,ce,Y]),Lt=r.useMemo(function(){return{checkable:z,loadData:oe,treeLoadedKeys:Ee,onTreeLoad:ke,checkedKeys:ne,halfCheckedKeys:Re,treeDefaultExpandAll:xe,treeExpandedKeys:De,treeDefaultExpandedKeys:we,onTreeExpand:Ie,treeIcon:ve,treeMotion:he,showTreeIcon:Me,switcherIcon:Ne,treeLine:_e,treeNodeFilterProp:A,keyEntities:L}},[z,oe,Ee,ke,ne,Re,xe,De,we,Ie,ve,he,Me,Ne,_e,A,L]);return r.createElement(gt.Provider,{value:Tt},r.createElement(mt.Provider,{value:Lt},r.createElement(Pt,vt({ref:t},Ue,{id:Be,prefixCls:l,mode:N?"multiple":void 0,displayValues:Dt,onDisplayValuesChange:It,searchValue:Oe,onSearch:Je,OptionList:Xt,emptyOptions:!te.length,onDropdownVisibleChange:wt,dropdownMatchSelectWidth:M}))))}),Fe=tr;Fe.TreeNode=ht;Fe.SHOW_ALL=yt;Fe.SHOW_PARENT=St;Fe.SHOW_CHILD=Xe;export{Fe as G,yt as S,ht as T,St as a,Xe as b};
