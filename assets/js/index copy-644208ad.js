import{r,j as t,U as $,m as p,B as m}from"./index-83fc08b5.js";import{r as z,u as n,w as g}from"./xlsx-964ea548.js";/* empty css              */import j from"./config-4044942f.js";import{F as k}from"./FileSaver.min-c9e61e96.js";import{S as _}from"./index-7d4ae6ef.js";import{T as K}from"./Table-6682999e.js";import"./Select-f081463e.js";import"./List-4fbd63eb.js";import"./useShowArrow-9f714a76.js";import"./useIcons-efffd204.js";import"./index-aeea166f.js";import"./styleChecker-b7cbd59f.js";import"./addEventListener-bcf58eda.js";import"./Tree-9c29a1c4.js";import"./conductUtil-56fe35d0.js";import"./useMultipleSelect-8beb10a7.js";import"./Pagination-e6a41b58.js";import"./zh_CN-f51ae7db.js";import"./index-17a3c129.js";import"./index-98ca97a3.js";import"./index-29642d9d.js";import"./useBubbleLock-f91bb637.js";import"./index-8964c188.js";import"./index-82881bad.js";import"./iconUtil-b5b117df.js";import"./useLazyKVMap-2ad078b2.js";const V=["序号","学科","项目名称","端","账号","密码"],we=()=>{const[d,q]=r.useState(j().dataSource),[T,u]=r.useState(!1),[E,v]=r.useState(""),[N,B]=r.useState([]),[x,f]=r.useState(""),[C,G]=r.useState(j().column),[b,D]=r.useState(),y=(e,s)=>{s||f(""),u(!0);const o=new FileReader;o.onload=l=>{const h=new Uint8Array(l.target.result),i=z(h,{type:"array"}),R=s?i.Sheets[s]:i.Sheets[i.SheetNames[0]],c=n.sheet_to_json(R,{header:1}),S=i.SheetNames.map(a=>({label:a,value:a})),H=c[0]||[],w=V.filter(a=>!H.includes(a));if(w.length>0)return p.error(`导入失败，缺少字段：${w.join("、")}`),!1;B(S),f(s||S[0].value),c.length>0?c.slice(1).forEach((a,J)=>{if(a.length===0)return!1;c[0].forEach((M,L)=>{a[L]})}):p.warning("表格无数据"),u(!1)},o.readAsArrayBuffer(e)},F=()=>{},U=e=>{b&&y(b,e)},A=()=>{const e=["序号","学科","项目名称","端","账号","密码"],s=n.aoa_to_sheet([e]),o=n.book_new();n.book_append_sheet(o,s,"Sheet1");const l=g(o,{bookType:"xlsx",type:"array"}),h=new Blob([l],{type:"application/octet-stream"});k.saveAs(h,"用户管理模板.xlsx")},I=()=>{if(!d.length)return p.warning("暂无数据可导出");const e=n.json_to_sheet(d),s=n.book_new();n.book_append_sheet(s,e,"Sheet1");const o=g(s,{bookType:"xlsx",type:"array"}),l=new Blob([o],{type:"application/octet-stream"});k.saveAs(l,"导出用户管理数据.xlsx")};return t.jsxs("div",{className:"TableDataImport bg-white p-[24px]",children:[t.jsxs("div",{className:"fileUpDiv mb-5",style:{marginTop:0,marginBottom:40},children:[t.jsx("span",{style:{marginRight:42},children:"文件名称"}),t.jsx("span",{className:"fileName",children:E}),t.jsx($,{beforeUpload:e=>/\.(xlsx|xls)$/.test(e.name.toLowerCase())?(v(e.name),D(e),y(e),!1):(p.error("请上传Excel文件（.xlsx 或 .xls）"),!1),children:t.jsx(m,{children:"上传Excel文件"})}),t.jsx("span",{style:{marginRight:26},children:"选择工作区"}),!x&&t.jsx(_,{disabled:!0,style:{width:120},options:[]}),x&&t.jsx(_,{defaultValue:x,style:{width:120},onChange:U,options:N}),t.jsx(m,{type:"primary",onClick:F,children:"导入表格数据"}),t.jsx(m,{type:"primary",onClick:A,children:"导出表格模板"}),t.jsx(m,{type:"primary",onClick:I,children:"导出表格数据"})]}),t.jsx(K,{scroll:{x:"100%",y:"calc( 100vh - 270px )"},rowKey:e=>e.key,bordered:!0,loading:T,size:"small",dataSource:d,columns:C})]})};export{we as default};
//# sourceMappingURL=index copy-644208ad.js.map
