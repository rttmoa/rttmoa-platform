{"version":3,"file":"Lane1【备份】-f57ddea8.js","sources":["../../../src/views/module/storage/components/Lane1【备份】.tsx"],"sourcesContent":["import React from 'react'\nimport { Space, Table, Tag, Tooltip } from 'antd'\nimport type { TableProps } from 'antd'\nimport './index.less'\n\n// ! http://localhost:9527/#/module/storage\n\ninterface DataType {\n\tkey?: string\n\tlane: number\n\trow: number\n\tlayer: number\n\tcolumn1: number\n\tcolumn2: number\n\tcolumn3: number\n\tcolumn4: number\n\tcolumn5: number\n\tcolumn6: number\n\tcolumn7: number\n\tcolumn8: number\n\tcolumn9: number\n\tcolumn10: number\n\tcolumn11: number\n}\n\n//* 表格提示框，鼠标悬停时显示的内容  ——  货位信息：货品名词、生产日期、在库整数总数\nfunction titleFN(data: string, record?: any, index?: number) {\n\t// console.log('titleFN', data, record, index)\n\tif (!data) return null\n\tconst lane = record?.lane ?? ''\n\tconst row = record?.row ?? ''\n\tconst layer = record?.layer ?? ''\n\tconst str = `${row}排 - ${layer}层 - ${data}列`\n\n\tlet color = data === '空闲' ? '#B4EEB4' : '#FF6A6A' // 绿色 / 红色\n\tcolor = '#FFF'\n\n\treturn (\n\t\t<Tooltip\n\t\t\tplacement=\"top\"\n\t\t\tcolor=\"#fff\"\n\t\t\ttitle={\n\t\t\t\t<table className=\"w-full border-collapse  text-slate-700 \">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th className=\"w-[250px] text-[12px] text-center\">货品名词</th>\n\t\t\t\t\t\t<th className=\"w-[150px] text-[12px] text-center\">生产日期</th>\n\t\t\t\t\t\t<th className=\"w-[350px] text-[12px] text-center\">在库整数总数</th>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td className=\"  text-[12px] text-center\">食品火腿肠</td>\n\t\t\t\t\t\t<td className=\"  text-[12px] text-center\">2020-11-19 12:32:00</td>\n\t\t\t\t\t\t<td className=\"w-[350px] text-[12px] text-center\">500箱0根</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t\t\t}>\n\t\t\t{/* {str} */}\n\t\t\t<div style={{ backgroundColor: color, padding: '4px 8px', textAlign: 'center' }}>{str}</div>\n\t\t</Tooltip>\n\t)\n}\n\nconst statuses = ['空闲', '占用']\nconst randomStatus = statuses[Math.floor(Math.random() * statuses.length)]\nconsole.log(randomStatus) // 随机输出：空闲 或 占用\nlet rawData: any[] = []\nfor (let w = 1; w < 2; w++) {\n\t// 巷道\n\tfor (let i = 1; i < 3; i++) {\n\t\t// 排\n\t\tfor (let j = 1; j < 7; j++) {\n\t\t\t// 列\n\t\t\tfor (let k = 1; k < 5; k++) {\n\t\t\t\t// 层\n\t\t\t\tconst res = `第${i}排 ${j}列 ${k}层`\n\t\t\t\tconsole.log(res)\n\t\t\t\tlet obj = {}\n\t\t\t\tif (j == 1) Object.assign(obj, { column1: j })\n\t\t\t\tif (j == 2) Object.assign(obj, { column2: j })\n\t\t\t\tif (j == 3) Object.assign(obj, { column3: j })\n\t\t\t\tif (j == 4) Object.assign(obj, { column4: j })\n\t\t\t\tif (j == 5) Object.assign(obj, { column5: j })\n\t\t\t\tif (j == 6) Object.assign(obj, { column6: j })\n\t\t\t\trawData.push({\n\t\t\t\t\tkey: res,\n\t\t\t\t\tlane: w, // 巷道\n\t\t\t\t\trow: i, // 排\n\t\t\t\t\tcolumn: j, // 列\n\t\t\t\t\tlayer: k, // 层\n\t\t\t\t\tstatus: randomStatus,\n\t\t\t\t\t...obj,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n}\n// console.log('货位 rawData：', rawData)\n// !  这个数组，lane相同合并行，row一样合并行，该如何处理这个数组？\n\n// 📌 1️⃣ 处理数据，把 column1 ~ columnN 结构整理好\nconst groupedData: any[] = []\n\nrawData.forEach(item => {\n\tconst { lane, row, layer, column } = item\n\tconst key = `第${lane}巷道 - ${row}排 - ${layer}层`\n\n\tlet existing = groupedData.find(d => d.key === key)\n\tif (!existing) {\n\t\texisting = {\n\t\t\tkey,\n\t\t\tlane,\n\t\t\trow,\n\t\t\tlayer,\n\t\t\tcolumn1: null,\n\t\t\tcolumn2: null,\n\t\t\tcolumn3: null,\n\t\t\tcolumn4: null,\n\t\t\tcolumn5: null,\n\t\t\tcolumn6: null,\n\t\t\t// ...item,\n\t\t}\n\t\tgroupedData.push(existing)\n\t}\n\n\t// 按列号填充 column1 ~ columnN\n\texisting[`column${column}`] = column\n})\n\nconsole.log('货位 rawData：', rawData) //* 总共24条\nconsole.log('初始 groupedData', groupedData) //* 总共8条\n\n// 📌 2️⃣ 处理 rowSpan，合并相同行\nconst rowSpanMap = new Map<string, number>()\ngroupedData.forEach((item, index) => {\n\tconst key = `${item.lane}-${item.row}-${item.layer}`\n\tif (!rowSpanMap.has(key)) {\n\t\trowSpanMap.set(key, groupedData.filter(d => d.lane === item.lane && d.row === item.row && d.layer === item.layer).length)\n\t}\n})\nconsole.log('处理后 groupedData', groupedData)\ngroupedData.sort((a, b) => {\n\tif (a.row != b.row) {\n\t\treturn a.row - b.row // 按 row 升序\n\t}\n\treturn b.layer - a.layer // 按 layer 降序\n})\nconsole.log('排序 groupedData', groupedData)\n\n// http://localhost:9527/#/module/storage\nconst columns: TableProps<DataType>['columns'] = [\n\t{\n\t\ttitle: 'RowHead',\n\t\tdataIndex: 'key',\n\t\t// rowScope: 'row', //* title  以身入局\n\t\twidth: 120,\n\t\tfixed: 'left',\n\t},\n\t// {\n\t// \ttitle: '巷道',\n\t// \tdataIndex: 'lane',\n\t// \tkey: 'lane',\n\t// \twidth: 50,\n\t// \trender: (value, row, index) => {\n\t// \t\t// 拿到当前行\n\t// \t\tconst currentLane = row.lane\n\t// \t\tconst currentRow = row.row\n\n\t// \t\t// 查找前面的行\n\t// \t\tconst prevRow = groupedData[index - 1]\n\t// \t\tif (prevRow && prevRow.lane === currentLane) {\n\t// \t\t\t// 如果上一行 lane、row 一样，说明应该被合并\n\t// \t\t\treturn {\n\t// \t\t\t\tchildren: null,\n\t// \t\t\t\tprops: { rowSpan: 0 },\n\t// \t\t\t}\n\t// \t\t}\n\n\t// \t\t// 计算有多少行是需要合并的\n\t// \t\tlet rowSpan = 1\n\t// \t\tfor (let i = index + 1; i < groupedData.length; i++) {\n\t// \t\t\tif (groupedData[i].lane === currentLane) {\n\t// \t\t\t\trowSpan++\n\t// \t\t\t} else {\n\t// \t\t\t\tbreak\n\t// \t\t\t}\n\t// \t\t}\n\t// \t\tconsole.log('rowSpan', rowSpan)\n\t// \t\treturn {\n\t// \t\t\tchildren: value,\n\t// \t\t\tprops: { rowSpan },\n\t// \t\t}\n\t// \t},\n\t// },\n\t{\n\t\ttitle: '排',\n\t\tdataIndex: 'row',\n\t\tkey: 'row',\n\t\twidth: 50,\n\t\trender: (value, row, index) => {\n\t\t\t// 拿到当前行\n\t\t\tconst currentLane = row.lane\n\t\t\tconst currentRow = row.row\n\n\t\t\t// 查找前面的行\n\t\t\tconst prevRow = groupedData[index - 1]\n\t\t\tif (prevRow && prevRow.row === currentRow) {\n\t\t\t\t// 如果上一行 lane、row 一样，说明应该被合并\n\t\t\t\treturn {\n\t\t\t\t\tchildren: null,\n\t\t\t\t\tprops: { rowSpan: 0 },\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 计算有多少行是需要合并的\n\t\t\tlet rowSpan = 1\n\t\t\tfor (let i = index + 1; i < groupedData.length; i++) {\n\t\t\t\tif (groupedData[i].row === currentRow) {\n\t\t\t\t\trowSpan++\n\t\t\t\t} else {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tchildren: value,\n\t\t\t\tprops: { rowSpan },\n\t\t\t}\n\t\t},\n\t},\n\t{\n\t\ttitle: '层',\n\t\tdataIndex: 'layer',\n\t\tkey: 'layer',\n\t\twidth: 50,\n\t},\n\t{\n\t\ttitle: '第1列',\n\t\tdataIndex: 'column1',\n\t\tkey: 'column1',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n\t{\n\t\ttitle: '第2列',\n\t\tdataIndex: 'column2',\n\t\tkey: 'column2',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n\t{\n\t\ttitle: '第3列',\n\t\tdataIndex: 'column3',\n\t\tkey: 'column3',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n\t{\n\t\ttitle: '第4列',\n\t\tdataIndex: 'column4',\n\t\tkey: 'column4',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n\t{\n\t\ttitle: '第5列',\n\t\tdataIndex: 'column5',\n\t\tkey: 'column5',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n\t{\n\t\ttitle: '第6列',\n\t\tdataIndex: 'column6',\n\t\tkey: 'column6',\n\t\trender: (value, record, index) => titleFN(value, record, index),\n\t},\n]\nconsole.log('columns length', columns.length)\n\nconst Lane: React.FC = () => {\n\tconsole.log('巷道一')\n\tlet Header = (\n\t\t<div className=\"flex\">\n\t\t\t<div className=\"w-[80px] px-[4px] py-[6px]  text-center text-[12px] bg-slate-100\">空库位</div>\n\t\t\t<div className=\"w-[80px] px-[4px] py-[6px]  text-center text-[12px] bg-pink-300\">预占用库位</div>\n\t\t\t<div className=\"w-[80px] px-[4px] py-[6px]  text-center text-[12px] bg-green-400\">有库存库位</div>\n\t\t\t<div className=\"w-[80px] px-[4px] py-[6px]  text-center text-[12px] bg-slate-100 text-red-500\">选中库位</div>\n\t\t</div>\n\t)\n\treturn (\n\t\t<Table<DataType>\n\t\t\tclassName=\"cusTable\"\n\t\t\ttitle={() => Header}\n\t\t\tcolumns={columns}\n\t\t\tdataSource={groupedData}\n\t\t\t// scroll={{ x: \"max-content\" }}\n\t\t\tscroll={{ x: columns.length * 150 }}\n\t\t\tpagination={false}\n\t\t/>\n\t)\n}\n\nexport default Lane\n"],"names":["titleFN","data","record","index","row","layer","str","color","jsx","Tooltip","jsxs","statuses","randomStatus","rawData","w","i","j","k","res","obj","groupedData","item","lane","column","key","existing","d","rowSpanMap","a","b","columns","value","currentRow","prevRow","rowSpan","Lane","Header","Table"],"mappings":"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"}